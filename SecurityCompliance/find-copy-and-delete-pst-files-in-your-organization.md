---
title: Utilizzare lo strumento di raccolta PST per trovare, copiare ed eliminare i file PST nell'organizzazione
ms.author: markjjo
author: markjjo
manager: laurawi
ms.audience: Admin
ms.topic: article
ms.service: O365-seccomp
localization_priority: Normal
ms.collection: ''
search.appverid: MOE150
ms.assetid: 7a150c84-049c-4a9c-8c91-22355b35f2a7
description: Utilizzare lo strumento di raccolta PST di Microsoft per cercare la rete dell'organizzazione per ottenere un inventario dei file PST sparsi nell'organizzazione. Dopo aver trovato i file PST, è possibile utilizzare lo strumento di raccolta PST per copiarli in una posizione centrale in modo da poterli importare in Office 365.
ms.openlocfilehash: 87e13ec8a4c58f848ac2ff7a430a7532942ece74
ms.sourcegitcommit: baf23be44f1ed5abbf84f140b5ffa64fce605478
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 02/26/2019
ms.locfileid: "30296959"
---
# <a name="use-the-pst-collection-tool-to-find-copy-and-delete-pst-files-in-your-organization"></a><span data-ttu-id="10c08-104">Utilizzare lo strumento di raccolta PST per trovare, copiare ed eliminare i file PST nell'organizzazione</span><span class="sxs-lookup"><span data-stu-id="10c08-104">Use the PST Collection tool to find, copy, and delete PST files in your organization</span></span>

> [!IMPORTANT]
> <span data-ttu-id="10c08-p102">Lo strumento di raccolta PST descritto in questo articolo non è supportato in alcun servizio o programma di supporto Microsoft standard. Lo strumento viene fornito come senza garanzie di alcun tipo. Microsoft nega inoltre tutte le garanzie implicite, incluse, senza limitazioni, le garanzie implicite di commerciabilità o di idoneità per uno scopo specifico. L'intero rischio derivante dall'utilizzo o dalle prestazioni dello strumento e della documentazione rimane invariato. In nessun caso Microsoft, i suoi autori o chiunque altro coinvolto nella creazione, la produzione o la consegna dello strumento saranno ritenuti responsabili per eventuali danni (compresi, senza limitazioni, danni per perdita degli utili aziendali, interruzioni aziendali, perdita di informazioni aziendali o altre perdite pecuniarie) derivanti dall'utilizzo o dall'impossibilità di utilizzare lo strumento o la documentazione, anche se Microsoft è stato informato della possibilità di tali danni.</span><span class="sxs-lookup"><span data-stu-id="10c08-p102">The PST Collection tool described in this article isn’t supported under any Microsoft standard support program or service. The tool is provided AS IS without warranty of any kind. Microsoft further disclaims all implied warranties including, without limitation, any implied warranties of merchantability or of fitness for a particular purpose. The entire risk arising out of the use or performance of the tool and documentation remains with you. In no event shall Microsoft, its authors, or anyone else involved in the creation, production, or delivery of the tool be liable for any damages whatsoever (including, without limitation, damages for loss of business profits, business interruption, loss of business information, or other pecuniary loss) arising out of the use of or inability to use the tool or documentation, even if Microsoft has been advised of the possibility of such damages.</span></span>

<span data-ttu-id="10c08-p103">È possibile utilizzare lo strumento di raccolta PST di Microsoft per cercare la rete dell'organizzazione per i file PST. Lo strumento consente di ottenere un inventario dei file PST sparsi nell'organizzazione. Dopo aver trovato i file PST, è possibile utilizzare lo strumento di raccolta PST per copiarli in una posizione centrale. L'utilizzo di PST in un'unica posizione consente di importarli nelle cassette postali di Exchange Online (o in una singola cassetta postale di Exchange Online), in cui è possibile applicare il set completo di funzionalità di conformità in Office 365. Ciò include l'importazione di PST per le cassette postali di archiviazione degli utenti, la ricerca di messaggi specifici nei file PST importati tramite gli strumenti di ricerca di eDiscovery, la conservazione dei messaggi tramite eDiscovery holds e i criteri di conservazione di Office 365 e la gestione della durata ciclo di questi messaggi utilizzando le funzionalità di gestione dei record di messaggistica in Exchange Online. Quando si è certi che i file PST raccolti siano stati importati correttamente in Office 365, è possibile utilizzare lo strumento per eliminarli dal percorso originale della rete.</span><span class="sxs-lookup"><span data-stu-id="10c08-p103">You can use the Microsoft PST Collection tool to search your organization's network for PST files. The tool helps you get an inventory of PST files that are scattered throughout your organization. After you find PST files, you can use the PST Collection tool to copy them in a central location. Having PSTs in a one place then allows you to import them to Exchange Online mailboxes (or a single Exchange Online mailbox), where you can then apply the rich set of compliance features in Office 365. This includes importing PSTs to users' archive mailboxes, searching for specific messages in the PST files that you imported by using eDiscovery search tools, retaining messages by using eDiscovery holds and Office 365 retention policies, and managing the life cycle of these messages using the messaging records management features in Exchange Online. After you're confident that the PST files that you collected have been successfully imported to Office 365, you can use the tool to delete them from their original location on your network.</span></span> 
  
<span data-ttu-id="10c08-p104">Un'altra operazione che è possibile eseguire con lo strumento di raccolta PST è impedire agli utenti di creare nuovi file PST e modificare i file PST esistenti che si trovano nella rete. Queste funzionalità "bloccate" consentono di trovare, raccogliere e importare un insieme noto di file PST in Office 365 e impedire la proliferazione futura dei file PST nell'organizzazione.</span><span class="sxs-lookup"><span data-stu-id="10c08-p104">Another thing you can do with the PST Collection tool is prevent users from creating new PST files and changing the existing PST files that you find on your network. These "block" capabilities let you find, collect, and import a known set of PST files to Office 365 and prevent the future proliferation of PST files in your organization.</span></span> 
  
## <a name="how-the-pst-collection-tool-works"></a><span data-ttu-id="10c08-118">Come funziona lo strumento di raccolta PST</span><span class="sxs-lookup"><span data-stu-id="10c08-118">How the PST Collection tool works</span></span>

<span data-ttu-id="10c08-119">Ecco una breve panoramica del processo di utilizzo dello strumento di raccolta PST per trovare, controllare, raccogliere ed eliminare i file PST nell'organizzazione.</span><span class="sxs-lookup"><span data-stu-id="10c08-119">Here's a quick overview of the process of using the PST Collection tool to find, control, collect, and delete PST files in your organization.</span></span>
  
![Panoramica del processo dello strumento di raccolta PST](media/67a29f27-f83c-4f0a-9df4-7ed92d3086fe.png)
  
1. <span data-ttu-id="10c08-p105">**[Passaggio 1: trovare i file PST sulla rete](#step-1-find-pst-files-on-your-network)** : quando si esegue lo strumento per trovare i file PST, è necessario specificare un percorso, ad esempio un'unità organizzativa che contiene oggetti di Active Directory per i computer client e server. È inoltre possibile cercare specifiche macchine o condivisioni file di rete. Quando si esegue lo strumento, un agente di raccolta "Lightweight" viene installato nei computer di destinazione. Questo agente Cerca nel computer di destinazione i file PST e quindi invia informazioni allo strumento di raccolta PST su qualsiasi file PST trovato. Lo strumento consente di creare file di registro che contengono informazioni sui file PST trovati nei percorsi specificati. Questi file vengono utilizzati quando si esegue lo strumento nei passaggi successivi.</span><span class="sxs-lookup"><span data-stu-id="10c08-p105">**[Step 1: Find PST files on your network](#step-1-find-pst-files-on-your-network)** - When you run the tool to find PST files, you specify a location, such as an organizational unit that contain Active Directory objects for client and server computers. You can also search specific machines or network file shares. When you run the tool, a "lightweight" Collection Agent is installed on the target computers. This agent searches the target computer for PST files and then sends information back to the PST Collection tool about any PST file it finds. The tool creates log files that contains information about the PST files that were found in the specified locations. These files are used when you run the tool in later steps.</span></span> 
    
2. <span data-ttu-id="10c08-p106">**[(Facoltativo) passaggio 2: controllare l'accesso ai file PST](#optional-step-2-control-access-to-pst-files)** -lo strumento crea un oggetto Criteri di gruppo con impostazioni che impediscono agli utenti di creare o modificare i file PST. Questo oggetto Criteri di gruppo viene applicato a tutti gli utenti del dominio. Questo passaggio facoltativo consente di "bloccare" i file PST che sono stati individuati nel passaggio 1, in modo da poterli raccogliere, importare ed eliminare senza che siano stati creati nuovi file PST o che siano stati modificati i file PST esistenti.</span><span class="sxs-lookup"><span data-stu-id="10c08-p106">**[(Optional) Step 2: Control access to PST files](#optional-step-2-control-access-to-pst-files)** - The tool creates a Group Policy Object (GPO) with settings that prevent users from creating or changing PST files. This GPO is applied to every user in your domain. This optional step helps you "lock down" the PST files that were found in Step 1, so that you can collect, import, and delete them without having new PST files created or the existing PST files changed.</span></span> 
    
3. <span data-ttu-id="10c08-p107">**[Passaggio 3: copiare i file PST in una posizione di raccolta](#step-3-copy-the-pst-files-to-a-collection-location)** -consente di raccogliere i file PST in una posizione tale da poterli importare nelle cassette postAli di Exchange Online utilizzando il servizio di importazione di Office 365 nel passaggio 4. Quando si esegue lo strumento nella modalità "raccolta", ogni agente di raccolta copia i file PST dal computer di destinazione in cui è installato l'agente nel percorso di raccolta.</span><span class="sxs-lookup"><span data-stu-id="10c08-p107">**[Step 3: Copy the PST files to a collection location](#step-3-copy-the-pst-files-to-a-collection-location)** - This lets you collect the PST files in one location so that you can import them to Exchange Online mailboxes by using the Office 365 Import service in Step 4. When you run the tool in the "collect" mode, each Collection Agent copies the PST files from the target machine the agent is installed on to the collection location.</span></span> 
    
4. <span data-ttu-id="10c08-132">**[Passaggio 4: importare i file PST in Office 365](#step-4-import-the-pst-files-to-office-365)** -dopo aver copiato i file PST in un'unica posizione, è possibile importarli nelle cassette postali di Exchange Online.</span><span class="sxs-lookup"><span data-stu-id="10c08-132">**[Step 4: Import the PST files to Office 365](#step-4-import-the-pst-files-to-office-365)** - After you've copied the PST files to one location, you're ready to import them to Exchange Online mailboxes.</span></span> 
    
5. <span data-ttu-id="10c08-133">**[Passaggio 5: eliminare i file PST trovati nella rete](#step-5-delete-the-pst-files-found-on-your-network)** -dopo che i file PST trovati e raccolti sono stati importati nelle cassette postali di Exchange online in Office 365, è possibile utilizzare lo strumento di raccolta PST per eliminare i file PST dai percorsi originali in cui sono stati rilevati nel passaggio 1.</span><span class="sxs-lookup"><span data-stu-id="10c08-133">**[Step 5: Delete the PST files found on your network](#step-5-delete-the-pst-files-found-on-your-network)** - After the PST files that you found and collected have been imported to Exchange Online mailboxes in Office 365, you can use the PST Collection tool to delete the PST files from the original locations where they were found in Step 1.</span></span> 

## <a name="before-you-begin"></a><span data-ttu-id="10c08-134">Informazioni preliminari</span><span class="sxs-lookup"><span data-stu-id="10c08-134">Before you begin</span></span>

- <span data-ttu-id="10c08-135">Eseguire la procedura seguente per scaricare lo strumento di raccolta PST nel computer locale.</span><span class="sxs-lookup"><span data-stu-id="10c08-135">Follow these steps to download the PST Collection tool to your local computer.</span></span> 
    
    1. <span data-ttu-id="10c08-136">[Scaricare lo strumento di raccolta PST](https://aka.ms/pstcollectiontool).</span><span class="sxs-lookup"><span data-stu-id="10c08-136">[Download the PST Collection tool](https://aka.ms/pstcollectiontool).</span></span>
    
    2. <span data-ttu-id="10c08-137">Nella finestra popup, fare clic su **Salva** \> con **nome** per salvare il file PSTCollectionTool. zip in una cartella del computer locale.</span><span class="sxs-lookup"><span data-stu-id="10c08-137">In the pop-up window, click **Save** \> **Save as** to save the PSTCollectionTool.zip file to a folder on your local computer.</span></span> 
    
    3. <span data-ttu-id="10c08-138">Estrarre il file PSTCollectionTool. zip in una cartella del computer locale. il nome predefinito della cartella è PSTCollectionTool.</span><span class="sxs-lookup"><span data-stu-id="10c08-138">Extract the PSTCollectionTool.zip file to a folder on your local computer; the default folder name is PSTCollectionTool.</span></span>
    
- <span data-ttu-id="10c08-139">Per eseguire lo strumento di raccolta PST in qualsiasi modalità (trova, blocca, copia o Elimina), è necessario essere membri del gruppo Domain Administrators nel dominio di Active Directory.</span><span class="sxs-lookup"><span data-stu-id="10c08-139">To run the PST Collection tool in any mode (Find, Block, Copy, or Delete), you have to be a member of the Domain Administrators group in your Active Directory domain.</span></span> 

## <a name="step-1-find-pst-files-on-your-network"></a><span data-ttu-id="10c08-140">Passaggio 1: trovare i file PST sulla rete</span><span class="sxs-lookup"><span data-stu-id="10c08-140">Step 1: Find PST files on your network</span></span>

<span data-ttu-id="10c08-p108">Il primo passaggio consiste nell'eseguire lo strumento di raccolta PST per trovare i file PST nell'organizzazione. È possibile utilizzare lo strumento per eseguire ricerche nei seguenti tipi di percorsi.</span><span class="sxs-lookup"><span data-stu-id="10c08-p108">The first step is to run the PST Collection tool to find PST files in your organization. You can use the tool to search the following types of locations.</span></span> 
  
- <span data-ttu-id="10c08-p109">Unità organizzative (OU) in un dominio di Active Directory locale. Lo strumento Cerca tutti i computer contenuti nell'unità organizzativa specificata.</span><span class="sxs-lookup"><span data-stu-id="10c08-p109">Organizational units (OUs) in an on-premises Active Directory domain. The tool searches all the machines that are contained in the specified OU.</span></span> 
    
- <span data-ttu-id="10c08-p110">Computer client e server. Lo strumento esegue la ricerca nei computer specificati.</span><span class="sxs-lookup"><span data-stu-id="10c08-p110">Client and server computers. The tool searches the specified machines.</span></span> 
    
- <span data-ttu-id="10c08-p111">Condivisioni file di rete. Lo strumento esegue la ricerca nelle condivisioni file di rete specificate.</span><span class="sxs-lookup"><span data-stu-id="10c08-p111">Network file shares. The tool searches the specified network file shares.</span></span> 
    
<span data-ttu-id="10c08-149">Per esempi di sintassi da `Locations` utilizzare per ognuno di questi tipi di percorso, vedere la descrizione del parametro nella tabella seguente.</span><span class="sxs-lookup"><span data-stu-id="10c08-149">See the description for the  `Locations` parameter in table in the following procedure for examples of the syntax to use for each of these location types.</span></span> 
  
> [!IMPORTANT]
> <span data-ttu-id="10c08-150">È necessario eseguire lo strumento di raccolta PST nella modalità trova prima di poter eseguire altre operazioni, ad esempio il blocco, la raccolta o l'eliminazione di file PST.</span><span class="sxs-lookup"><span data-stu-id="10c08-150">You have to the run the PST Collection tool in the Find mode before you can perform other actions such as blocking, collecting, or deleting PST files.</span></span> 
  
1. <span data-ttu-id="10c08-151">Aprire un prompt dei comandi (Esegui come amministratore) nel computer locale.</span><span class="sxs-lookup"><span data-stu-id="10c08-151">Open a Command Prompt (run as administrator) on your local computer.</span></span>
    
2. <span data-ttu-id="10c08-152">Passare alla cartella PSTCollectionTool (o alla cartella in cui è stato estratto il file PSTCollectionTool. zip).</span><span class="sxs-lookup"><span data-stu-id="10c08-152">Go to the PSTCollectionTool folder (or the folder that you extracted the PSTCollectionTool.zip file to).</span></span>
    
3. <span data-ttu-id="10c08-153">Passare alla directory DataCollectorMaster</span><span class="sxs-lookup"><span data-stu-id="10c08-153">Change to the DataCollectorMaster directory.</span></span>
    
4. <span data-ttu-id="10c08-154">Eseguire il seguente comando per trovare i file PST in un percorso specificato.</span><span class="sxs-lookup"><span data-stu-id="10c08-154">Run the following command to find PST files in a specified location.</span></span>
    
    ```
    DataCollectorMaster.exe -DataSource Pst -Mode Find -JobName <Name> -Locations <Locations to search for PSTs> -LogLocation <Location to store log files> -ConfigurationLocation <Location to store configuration files>
    ```

    <span data-ttu-id="10c08-155">Nella tabella seguente vengono descritti i parametri e i valori necessari quando si esegue il comando DataCollectorMaster. exe per trovare i file PST.</span><span class="sxs-lookup"><span data-stu-id="10c08-155">The following table describes the parameters and their required values when you run the DataCollectorMaster.exe command to find PST files.</span></span> 
    
    |<span data-ttu-id="10c08-156">Parametro \* \* \* \*</span><span class="sxs-lookup"><span data-stu-id="10c08-156">\*\*\*\*Parameter\*\*\*\*</span></span>|<span data-ttu-id="10c08-157">\*\*\*\*Description\*\*\*\*</span><span class="sxs-lookup"><span data-stu-id="10c08-157">\*\*\*\*Description\*\*\*\*</span></span>|<span data-ttu-id="10c08-158">Esempi \* \* \* \*</span><span class="sxs-lookup"><span data-stu-id="10c08-158">\*\*\*\*Examples\*\*\*\*</span></span>|
    |:-----|:-----|:-----|
    | `DataSource` <br/> |<span data-ttu-id="10c08-p112">Specifica il tipo di dati da cercare. Attualmente, è possibile utilizzare lo strumento di raccolta PST per cercare i file PST.</span><span class="sxs-lookup"><span data-stu-id="10c08-p112">Specifies the type of data to search for. Currently, you can use the PST Collection tool to search for PST files.</span></span>  <br/> | `-DataSource Pst` <br/> |
    | `Mode` <br/> |<span data-ttu-id="10c08-p113">Specifica il tipo di operazione che verrà eseguito dallo strumento. Utilizzare il valore `Find` per individuare i file pst nei percorsi specificati. Si noti che lo strumento può trovare e ottenere informazioni sui file PST che sono aperti nei file di Outlook e PST che sono connessi ai profili di Outlook.</span><span class="sxs-lookup"><span data-stu-id="10c08-p113">Specifies the type of operation that the tool will perform. Use the value  `Find` to locate PST files in the specified locations. Note that the tool can find and get information about PST files that are open in Outlook and PST files that are connected to Outlook profiles.  </span></span><br/> | `-Mode Find` <br/> |
    | `JobName` <br/> |<span data-ttu-id="10c08-p114">Specifica il nome del processo di raccolta PST. Si utilizzerà questo stesso nome del processo quando si esegue lo strumento di raccolta PST per bloccare, raccogliere ed eliminare i file PST che si trovano quando si esegue lo strumento per trovare i file PST. Il nome del processo verrà aggiunto anche ai nomi dei file di configurazione e di registro.</span><span class="sxs-lookup"><span data-stu-id="10c08-p114">Specifies the name of the PST Collection job. You will use this same job name when you run the PST Collection tool to block, collect, and delete the PST files that are found when you run the tool to find PST files. The job name will also be added to the log and configuration file names.</span></span>  <br/> | `-JobName PstSearch1` <br/> |
    | `Locations` <br/> | <span data-ttu-id="10c08-p115">Specifica una o più posizioni per la ricerca dei file PST. Se si specifica più di una posizione, utilizzare un punto e virgola (;) per separare singoli percorsi. Tenere presente che i singoli valori di questo parametro sono racchiusi tra virgolette doppie ("").</span><span class="sxs-lookup"><span data-stu-id="10c08-p115">Specifies one or more locations to search for PST files. If you specify more than one location, use a semi-colon (;) to separate individual locations. Be sure to surround the individual values of this parameter with double-quotation marks (" ").  </span></span><br/><br/>   <span data-ttu-id="10c08-170">Di seguito è indicato il formato del valore di identità necessario per i tipi di percorsi che è possibile cercare.</span><span class="sxs-lookup"><span data-stu-id="10c08-170">Here is the required identity value format for the types of locations that you can search.</span></span>  <br/><br/>        <span data-ttu-id="10c08-171">**Unità organizzative** : utilizzare il nome distinto (DN) per identificare le unità organizzative. Per esempio:`"OU=NorthAmerica,OU=NWRegion,OU=ITServices,DC=contoso,DC=com"`</span><span class="sxs-lookup"><span data-stu-id="10c08-171">**OUs** - Use the distinguished name (DN) to identify OUs; for example:  `"OU=NorthAmerica,OU=NWRegion,OU=ITServices,DC=contoso,DC=com"`</span></span> <br/> <span data-ttu-id="10c08-172">> [!IMPORTANT]> non è possibile specificare il contenitore dei computer incorporati (ad esempio, CN = Computers, DC = contoso, DC = com ") perché non è un'unità organizzativa.</span><span class="sxs-lookup"><span data-stu-id="10c08-172">> [!IMPORTANT]>  You can't specify the built-in Computers container (for example, CN=Computers,DC=contoso,DC=com") because it isn't an organizational unit.</span></span><br/> <br/> <span data-ttu-id="10c08-173">**Macchine** : utilizzare il DN o il nome di dominio completo (FQDN) per identificare i computer client e server della rete. Per esempio:</span><span class="sxs-lookup"><span data-stu-id="10c08-173">**Machines** - Use the DN or the fully qualified domain name (FQDN) to identify client and server machines on your network; for example:</span></span>  <br/>  <span data-ttu-id="10c08-174">DN`"CN=FILESERVER01,CN=Computers,DC=contoso,DC=com"`</span><span class="sxs-lookup"><span data-stu-id="10c08-174">DN:  `"CN=FILESERVER01,CN=Computers,DC=contoso,DC=com"`</span></span> <br/>  <span data-ttu-id="10c08-175">Oppure</span><span class="sxs-lookup"><span data-stu-id="10c08-175">Or</span></span>  <br/>  <span data-ttu-id="10c08-176">FQDN`"FILESERVER01.contoso.com"`</span><span class="sxs-lookup"><span data-stu-id="10c08-176">FQDN:  `"FILESERVER01.contoso.com"`</span></span> <br/><br/>  <span data-ttu-id="10c08-177">**Condivisioni file di rete** -utilizzare un nome UNC per identificare le condivisioni di file di rete; Per esempio`"\\FILESERVER02\Users"`</span><span class="sxs-lookup"><span data-stu-id="10c08-177">**Network file shares** - Use a UNC name to identify network file shares; for example,  `"\\FILESERVER02\Users"`</span></span> <br/> | `-Locations "CN=FILESERVER01,CN=Computers,DC=contoso,DC=com";"CN=FILESERVER02,CN=Computers,DC=contoso,DC=com"` <br/> |
    | `LogLocation` <br/> |<span data-ttu-id="10c08-p116">Specifica la cartella in cui verranno copiati i file di registro. Se la cartella non esiste, verrà creata durante l'esecuzione dello strumento.</span><span class="sxs-lookup"><span data-stu-id="10c08-p116">Specifies the folder that the log files will be copied to. If the folder doesn't exist, it will be created when you run the tool.</span></span>  <br/> | `-LogLocation "c:\users\admin\desktop\PSTCollection"` <br/> |
    | `ConfigurationLocation` <br/> |<span data-ttu-id="10c08-p117">Specifica la cartella in cui verrà copiato il file di configurazione. XML. Questo file contiene informazioni su ogni file PST individuato quando si esegue lo strumento. Questo file verrà utilizzato quando si esegue lo strumento nel passaggio 3 per copiare i file PST trovati.</span><span class="sxs-lookup"><span data-stu-id="10c08-p117">Specifies the folder that the .xml configuration file will be copied to. This file contains information about each PST file that is found when you run the tool. This file will be used when you run the tool in Step 3 to copy the PST files that are found.</span></span>  <br/> | `-ConfigurationLocation "c:\users\admin\desktop\PSTCollection\Configuration"` <br/> |
    | `ExcludedLocations` <br/> |<span data-ttu-id="10c08-p118">Questo parametro facoltativo consente di specificare le posizioni da ignorare durante un'operazione di ricerca. È possibile escludere specifiche unità organizzative, computer e condivisioni file di rete. Ad esempio, è possibile escludere i computer, come il computer configurato come SQL Server (o altri tipi di server applicazioni), a cui gli utenti non hanno accesso. Se si specifica più di una posizione da escludere, utilizzare un punto e virgola (;) per separare singoli percorsi. Tenere presente che i singoli valori di questo parametro sono racchiusi tra virgolette doppie ("").</span><span class="sxs-lookup"><span data-stu-id="10c08-p118">This optional parameter specifies locations to skip during a Find operation. You can exclude specific OUs, machines, and network file shares. For example, you could exclude machines, such as machine configured as a SQL server (or other kinds of application servers), that users don't have access to. If you specify more than one location to exclude, use a semi-colon (;) to separate individual locations. Be sure to surround the individual values of this parameter with double-quotation marks (" ").</span></span>  <br/> | `-ExcludedLocations "SQLSERVER01.contoso.com"` <br/> |
    | `ForceRestart` <br/> |<span data-ttu-id="10c08-p119">Questa opzione opzionale consente di eseguire lo strumento nella modalità di ricerca per un processo di raccolta PST esistente. Quando si utilizza l' `ForceRestart` opzione, i risultati dell'operazione di ricerca precedente per il processo verranno eliminati e lo strumento analizzerà di nuovo i percorsi specificati e creerà nuovi file di configurazione e di registro.</span><span class="sxs-lookup"><span data-stu-id="10c08-p119">This optional switch lets you run the tool in the Find mode for an existing PST Collection job. When you use the  `ForceRestart` switch, the results from the previous Find operation for the job will be discarded, and the tool will re-scan the specified locations and create new log and configuration files.  </span></span><br/> | `-ForceRestart` <br/> |
   
    <span data-ttu-id="10c08-190">Di seguito è riportato un esempio della sintassi per il comando DataCollectorMaster. exe che utilizza i valori effettivi per ogni parametro:</span><span class="sxs-lookup"><span data-stu-id="10c08-190">Here's an example of the syntax for the DataCollectorMaster.exe command using actual values for each parameter:</span></span>
    
    ```
    DataCollectorMaster.exe -DataSource Pst -Mode Find -JobName PstSearch1 -Locations "CN=FILESERVER01,CN=Computers,DC=contoso,DC=com";"CN=FILESERVER02,CN=Computers,DC=contoso,DC=com" -LogLocation "c:\users\admin\desktop\PSTCollection" -ConfigurationLocation "c:\users\admin\desktop\PSTCollection\Configuration"
    ```

    <span data-ttu-id="10c08-p120">Dopo aver eseguito il comando, vengono visualizzati messaggi di stato dettagliati che mostrano lo stato di avanzamento della ricerca dei file PST nei percorsi specificati. Dopo un po', un messaggio di stato finale Visualizza il numero totale di file PST che sono stati trovati, se il processo è stato completato e se sono stati riscontrati errori. Gli stessi messaggi di stato vengono copiati nel file. log.</span><span class="sxs-lookup"><span data-stu-id="10c08-p120">After you run the command, detailed status messages are displayed that show the progress of finding PST files in the specified locations. After a while, a final status message shows the total number of PST files that were found, whether the job has completed, and if there were any errors. The same status messages are copied to the .log file.</span></span>
    
### <a name="results-of-running-datacollectormasterexe-in-the-find-mode"></a><span data-ttu-id="10c08-194">Risultati dell'esecuzione di DataCollectorMaster. exe nella modalità di ricerca</span><span class="sxs-lookup"><span data-stu-id="10c08-194">Results of running DataCollectorMaster.exe in the Find mode</span></span>

<span data-ttu-id="10c08-195">Dopo aver eseguito correttamente lo strumento di raccolta PST la modalità di ricerca, i file seguenti vengono creati e archiviati nelle cartelle specificate dai `LogLocation` parametri `ConfigurationLocation` e.</span><span class="sxs-lookup"><span data-stu-id="10c08-195">After you successfully run the PST Collection tool the Find mode, the following files are created and stored in the folders specified by the  `LogLocation` and  `ConfigurationLocation` parameters.</span></span> 
  
- <span data-ttu-id="10c08-p121">**\<JobName\>__ Find\<DateTimeStamp\>. log** : il file di log contiene i messaggi di stato che sono stati visualizzati. Questo file viene creato nella cartella specificata dal `LogLocation` parametro.</span><span class="sxs-lookup"><span data-stu-id="10c08-p121">**\<JobName\>_Find_\<DateTimeStamp\>.log** - The log file contains the status messages that were displayed. This file is created in the folder specified by the  `LogLocation` parameter.</span></span> 
    
- <span data-ttu-id="10c08-p122">**\<JobName\>__ Find\<DateTimeStamp\>. csv** : il file CSV contiene una riga per ogni file PST trovato. Le informazioni per ogni PST includono il computer in cui è stato trovato il file PST, il percorso completo del file PST, il proprietario del file PST e la dimensione (in kilobyte, KB) del file PST. Questo file viene creato nella cartella specificata dal `LogLocation` parametro.</span><span class="sxs-lookup"><span data-stu-id="10c08-p122">**\<JobName\>_Find_\<DateTimeStamp\>.csv** - The CSV file contains a row for each PST file that was found. The information for each PST includes the computer where the PST file was found, the full file path location of the PST file, the owner of the PST file, and the size (in kilobytes, KBs) of the PST file. This file is created in the folder specified by the  `LogLocation` parameter.</span></span> 
    
    > [!TIP]
    > <span data-ttu-id="10c08-p123">Utilizzare lo strumento Somma automatica in Excel per calcolare la dimensione totale (in KB) di tutti i file PST elencati nel file CSV. È quindi possibile utilizzare un calcolatore di conversione per convertire le dimensioni totali in megabyte (MB) o gigabyte (GB).</span><span class="sxs-lookup"><span data-stu-id="10c08-p123">Use the AutoSum tool in Excel to calculate the total size (in KB) of all the PST files listed in the CSV file. Then you can use a conversion calculator to convert the total size to megabytes (MB) or gigabytes (GB).</span></span> 
  
- <span data-ttu-id="10c08-p124">**\<JobName\>__ Find\<DateTimeStamp\>. XML** -il file XML contiene informazioni sui valori dei parametri utilizzati per l'esecuzione dello strumento nella modalità di ricerca. Questo file contiene anche informazioni su ogni file PST trovato. I dati contenuti in questo file vengono utilizzati quando si esegue di nuovo lo strumento per bloccare, raccogliere o eliminare i file PST che sono stati trovati. Questo file viene creato nella cartella specificata dal `ConfigurationLocation` parametro.</span><span class="sxs-lookup"><span data-stu-id="10c08-p124">**\<JobName\>_Find_\<DateTimeStamp\>.xml** - The XML file contains information about the parameter values that where used when you ran the tool in the Find mode. This file also contains information about every PST file that was found. The data in this file is used when you run re-run the tool for the same job to block, collect, or delete the PST files that were found. This file is created in the folder specified by the  `ConfigurationLocation` parameter.</span></span> 
    
    > [!IMPORTANT]
    > <span data-ttu-id="10c08-p125">Non rinominare, modificare o spostare questo file. Viene utilizzato dallo strumento di raccolta PST quando si riesegue lo strumento nella modalità blocca, copia o Elimina per lo stesso processo.</span><span class="sxs-lookup"><span data-stu-id="10c08-p125">Don't rename, change, or move this file. It's used by the PST Collection tool when you re-run the tool in the Block, Copy, or Delete mode for the same job.</span></span> 

## <a name="optional-step-2-control-access-to-pst-files"></a><span data-ttu-id="10c08-209">Optional Passaggio 2: controllare l'accesso ai file PST</span><span class="sxs-lookup"><span data-stu-id="10c08-209">(Optional) Step 2: Control access to PST files</span></span>

<span data-ttu-id="10c08-p126">Questo passaggio facoltativo consente di "bloccare" i file PST che sono stati individuati nel passaggio 1 in modo da poter raccogliere e importare un insieme noto di file PST in Office 365. Quando si esegue lo strumento di raccolta PST nella modalità blocca, si verificano le operazioni seguenti:</span><span class="sxs-lookup"><span data-stu-id="10c08-p126">This optional step lets you "lock down" the PST files that were found in Step 1 so that you can collect and import a known set of PST files to Office 365. When you run the PST Collection tool in the Block mode, the following things happen:</span></span> 
  
- <span data-ttu-id="10c08-p127">Lo strumento crea un oggetto Criteri di gruppo (GPO) denominato *controlli di utilizzo PST* . Questo oggetto Criteri di gruppo è collegato al dominio e si applica a tutti gli utenti autenticati nell'organizzazione.</span><span class="sxs-lookup"><span data-stu-id="10c08-p127">The tool creates a Group Policy Object (GPO) named  *PST Usage Controls*  . This GPO is linked to your domain, and applies to all authenticated users in your organization.</span></span> 
    
- <span data-ttu-id="10c08-p128">L'oggetto Criteri di gruppo dei controlli di utilizzo PST crea le impostazioni del registro di sistema nei computer dell'organizzazione. A seconda del parametro utilizzato, è possibile creare un'impostazione del registro di sistema per impedire agli utenti di creare nuovi file PST e un'impostazione del registro di sistema che impedisca agli utenti di modificare i file PST esistenti.</span><span class="sxs-lookup"><span data-stu-id="10c08-p128">The PST Usage Controls GPO creates registry settings on machines in your organization. Depending on the parameter that you use, you can create a registry setting to prevent users from creating new PST files and a registry setting that prevents users from changing existing PST files.</span></span>
    
> [!NOTE]
> <span data-ttu-id="10c08-p129">Se il controllo dell'accesso ai file PST è troppo dirompente per l'organizzazione, è consigliabile ignorare questo passaggio ed eseguire il passaggio 3 per copiare i file PST in una posizione centrale. È quindi possibile ripetere il passaggio 1 per lo stesso processo (utilizzando il `ForceRestart` parametro) per trovare ulteriori file di PST creati dopo la copia dei file di PST nel percorso dell'insieme. Se vengono trovati nuovi file PST, è possibile copiarli nel percorso dell'insieme. Quando si utilizza il `ForceRestart` parametro quando si esegue di nuovo lo strumento nella modalità di ricerca, i risultati dell'operazione di ricerca precedente per un processo verranno eliminati e lo strumento analizzerà di nuovo i percorsi specificati.</span><span class="sxs-lookup"><span data-stu-id="10c08-p129">If controlling access to PST files is too disruptive for your organization, you might consider skipping this step, and performing Step 3 to copy PST files to a central location. Then you can repeat Step 1 for the same job (by using the  `ForceRestart` parameter) to find additional PSTs files that were created after you copied PSTs files to the collection location. If new PST files are found, you can copy them to the collection location. When you use the  `ForceRestart` parameter when you re-run the tool in the Find mode, the results from the previous Find operation for a job will be discarded, and the tool will re-scan the specified locations.</span></span> 

<span data-ttu-id="10c08-220">Per bloccare l'accesso ai file PST:</span><span class="sxs-lookup"><span data-stu-id="10c08-220">To block access to PST files:</span></span>

1. <span data-ttu-id="10c08-221">Aprire un prompt dei comandi (Esegui come amministratore) nel computer locale.</span><span class="sxs-lookup"><span data-stu-id="10c08-221">Open a Command Prompt (run as administrator) on your local computer.</span></span>
    
2. <span data-ttu-id="10c08-222">Passare alla directory in cui è stato scaricato lo strumento di raccolta PST.</span><span class="sxs-lookup"><span data-stu-id="10c08-222">Go to the directory where you downloaded the PST Collection tool to.</span></span>
    
3. <span data-ttu-id="10c08-223">Eseguire il seguente comando per bloccare l'accesso ai file PST trovati nel passaggio 1.</span><span class="sxs-lookup"><span data-stu-id="10c08-223">Run the following command to block access to the PST files found in Step 1.</span></span>

    ```
    DataCollectorMaster.exe -DataSource Pst -Mode Block -JobName <Name of job from Step 1> -ConfigurationLocation <Location of configuration files from Step 1> -BlockChangesToFiles -BlockNewFiles
    ```

    <span data-ttu-id="10c08-224">Nella tabella seguente vengono descritti i parametri e i valori necessari quando si esegue il comando DataCollectorMaster. exe per bloccare la creazione e la modifica dei file PST.</span><span class="sxs-lookup"><span data-stu-id="10c08-224">The following table describes the parameters and their required values when you run the DataCollectorMaster.exe command to block the creation and changing of PST files.</span></span> 
    
    |<span data-ttu-id="10c08-225">Parametro \* \* \* \*</span><span class="sxs-lookup"><span data-stu-id="10c08-225">\*\*\*\*Parameter\*\*\*\*</span></span>|<span data-ttu-id="10c08-226">\*\*\*\*Description\*\*\*\*</span><span class="sxs-lookup"><span data-stu-id="10c08-226">\*\*\*\*Description\*\*\*\*</span></span>|<span data-ttu-id="10c08-227">Esempi \* \* \* \*</span><span class="sxs-lookup"><span data-stu-id="10c08-227">\*\*\*\*Examples\*\*\*\*</span></span>|
    |:-----|:-----|:-----|
    | `DataSource` <br/> |<span data-ttu-id="10c08-p130">Specifica il tipo di dati da cercare. Attualmente, è possibile utilizzare lo strumento di raccolta PST per cercare i file PST.</span><span class="sxs-lookup"><span data-stu-id="10c08-p130">Specifies the type of data to search for. Currently, you can use the PST Collection tool to search for PST files.</span></span>  <br/> | `-DataSource Pst` <br/> |
    | `Mode` <br/> |<span data-ttu-id="10c08-p131">Specifica il tipo di operazione che verrà eseguito dallo strumento. Utilizzare il valore `Block` per impedire agli utenti di creare nuovi file PST e apportare modifiche ai file PST esistenti.</span><span class="sxs-lookup"><span data-stu-id="10c08-p131">Specifies the type of operation that the tool will perform. Use the value  `Block` to prevent users from creating new PST files and making changes to existing PST files.  </span></span><br/> | `-Mode Block` <br/> |
    | `JobName` <br/> |<span data-ttu-id="10c08-p132">Specifica il nome di un processo di raccolta PST esistente. È necessario utilizzare lo stesso nome del processo utilizzato per l'esecuzione dello strumento nella modalità di ricerca nel passaggio 1. Il nome del processo viene inoltre aggiunto al nome del file di registro creato quando si esegue lo strumento in modalità di blocco.</span><span class="sxs-lookup"><span data-stu-id="10c08-p132">Specifies the name of an existing PST Collection job. You have to use this same job name that you used when you ran the tool in the Find mode in Step 1. This job name is also added to the name of the log file that is created when you run the tool in the Block mode.</span></span>  <br/> | `-JobName PstSearch1` <br/> |
    | `ConfigurationLocation` <br/> |<span data-ttu-id="10c08-p133">Specifica che la cartella contiene il file di configurazione XML creato quando è stato eseguito lo strumento nella modalità di ricerca. Utilizzare lo stesso valore utilizzato per questo parametro nel passaggio 1.</span><span class="sxs-lookup"><span data-stu-id="10c08-p133">Specifies the folder contains the .xml configuration file that was created when you ran the tool in the Find mode. Use the same value that you used for this parameter in Step 1.</span></span>  <br/> | `-ConfigurationLocation "c:\users\admin\desktop\PSTCollection\Configuration"` <br/> |
    | `LogLocation` <br/> |<span data-ttu-id="10c08-p134">Specifica la cartella in cui verrà copiato il file di registro per l'operazione di blocco. Si tratta di un parametro facoltativo. Se non è incluso, il file di registro viene copiato nella cartella in cui è stato scaricato lo strumento di raccolta PST. È consigliabile utilizzare la stessa posizione del log utilizzata per l'esecuzione dello strumento nella modalità di ricerca nel passaggio 1, in modo che tutti i file di registro vengano salvati nella stessa cartella.</span><span class="sxs-lookup"><span data-stu-id="10c08-p134">Specifies the folder that the log file for the Block operation will be copied to. This is an optional parameter. If you don't include it, the log file is copied to the folder where you downloaded the PST Collection tool to. Consider using the same log location that you used when you ran the tool in the Find mode in Step 1 so that all the log files are saved in the same folder.</span></span>  <br/> | `-LogLocation "c:\users\admin\desktop\PSTCollection"` <br/> |
    | `BlockChangesToFiles` <br/> |<span data-ttu-id="10c08-p135">Utilizzare questa opzione per impedire agli utenti di modificare un file PST. Quando si utilizza questa opzione, viene creata la voce del registro di `HKEY_CURRENT_USER\Software\Policies\Microsoft\Office\<version>\Outlook\PST\PstDisableGrow` sistema seguente: e il valore dei dati è impostato su 1. Questa impostazione del registro di sistema viene creata nei computer dell'organizzazione dall'oggetto Criteri di gruppo creato quando si esegue lo strumento di raccolta PST in modalità di blocco.</span><span class="sxs-lookup"><span data-stu-id="10c08-p135">Use this switch to prevent users from changing a PST file. When you use this switch, the following registry entry is created:  `HKEY_CURRENT_USER\Software\Policies\Microsoft\Office\<version>\Outlook\PST\PstDisableGrow` and the data value is set to 1. This registry setting is created on the machines in your organization by the GPO that's created when you run the PST Collection tool in the Block mode.  </span></span><br/> | `-BlockChangesToFiles` <br/> |
    | `BlockNewFiles` <br/> |<span data-ttu-id="10c08-p136">Utilizzare questa opzione per impedire agli utenti di creare nuovi file PST, aprire e importare file PST in Outlook ed esportare i file PST da Outlook. Quando si utilizza questa opzione, viene creata la voce del registro di `HKEY_CURRENT_USER\Software\Policies\Microsoft\Office\<version>\Outlook\DisablePst` sistema seguente: e il valore dei dati è impostato su 1. Questa impostazione del registro di sistema viene creata nei computer dell'organizzazione dall'oggetto Criteri di gruppo creato quando si esegue lo strumento di raccolta PST in modalità di blocco.</span><span class="sxs-lookup"><span data-stu-id="10c08-p136">Use this switch to prevent users from creating new PST files, opening and importing PST files to Outlook, and exporting PST files from Outlook. When you use this switch, the following registry entry is created:  `HKEY_CURRENT_USER\Software\Policies\Microsoft\Office\<version>\Outlook\DisablePst` and the data value is set to 1. This registry setting is created on the machines in your organization by the GPO that's created when you run the PST Collection tool in the Block mode.  </span></span><br/> | `-BlockNewFiles` <br/> |
   
    <span data-ttu-id="10c08-247">Di seguito è riportato un esempio della sintassi per il comando DataCollectorMaster. exe che utilizza i valori effettivi per ogni parametro:</span><span class="sxs-lookup"><span data-stu-id="10c08-247">Here's an example of the syntax for the DataCollectorMaster.exe command using actual values for each parameter:</span></span>

    ```
    DataCollectorMaster.exe -DataSource Pst -Mode Block -JobName PstSearch1 -ConfigurationLocation "c:\users\admin\desktop\PSTCollection\Configuration" -LogLocation "c:\users\admin\desktop\PSTCollection" -BlockChangesToFiles -BlockNewFiles
    ```
    
    <span data-ttu-id="10c08-p137">Viene richiesto di confermare che si desidera bloccare nuovi file PST o modifiche ai file PST esistenti. Dopo aver verificato che si desidera continuare e che il comando venga eseguito correttamente, viene visualizzato un messaggio in cui viene indicato che è stato creato un nuovo oggetto Criteri di gruppo denominato "PST Usage Controls".</span><span class="sxs-lookup"><span data-stu-id="10c08-p137">You are prompted to confirm that you want to block new PST files or changes to existing PST files. After you confirm that you want to continue and the command successfully runs, a message is displayed saying that a new GPO, named "PST Usage Controls", has been created.</span></span>
    
## <a name="step-3-copy-the-pst-files-to-a-collection-location"></a><span data-ttu-id="10c08-250">Passaggio 3: copiare i file PST in una posizione di raccolta</span><span class="sxs-lookup"><span data-stu-id="10c08-250">Step 3: Copy the PST files to a collection location</span></span>

<span data-ttu-id="10c08-p138">Il passaggio successivo consiste nel copiare i file PST che sono stati trovati quando è stato eseguito lo strumento di raccolta PST nella modalità trova. In questo modo è possibile raccogliere i file PST in un'unica posizione per poterli importare in un secondo momento in Office 365. Prima di copiare i file PST in una posizione di raccolta, valutare la possibilità di determinare la quantità totale di spazio di archiviazione necessario. È possibile eseguire questa operazione utilizzando il file CSV creato nel passaggio 1 per calcolare la dimensione totale di tutti i file PST.</span><span class="sxs-lookup"><span data-stu-id="10c08-p138">The next step is to copy the PST files that where found when you ran the PST Collection tool in the Find mode. This lets you collect the PST files in one location so that you can later import them to Office 365. Before you copy the PST files to collection location, consider determining the total amount of storage space that is required. You can do this using the CSV file that was created in Step 1 to calculate the total size of all PST files.</span></span>
  
> [!NOTE]
> <span data-ttu-id="10c08-255">Dopo aver importato i file PST in Office 365 e averli eliminati dal percorso originale, è possibile eliminarli dalla posizione dell'insieme in cui sono stati copiati in questo passaggio.</span><span class="sxs-lookup"><span data-stu-id="10c08-255">After you've imported the PST files to Office 365 and deleted them from their original location, you might want to delete them from the collection location that you copied them to in this step.</span></span> 
  
1. <span data-ttu-id="10c08-256">Aprire un prompt dei comandi (Esegui come amministratore) nel computer locale.</span><span class="sxs-lookup"><span data-stu-id="10c08-256">Open a Command Prompt (run as administrator) on your local computer.</span></span>
    
2. <span data-ttu-id="10c08-257">Passare alla directory in cui è stato scaricato lo strumento di raccolta PST.</span><span class="sxs-lookup"><span data-stu-id="10c08-257">Go to the directory where you downloaded the PST Collection tool to.</span></span>
    
3. <span data-ttu-id="10c08-258">Eseguire il seguente comando per copiare i file PST in un percorso specificato.</span><span class="sxs-lookup"><span data-stu-id="10c08-258">Run the following command to copy the PST files to a specified location.</span></span>
    
    ```
    DataCollectorMaster.exe -DataSource Pst -Mode Collect -JobName <Name of job from Step 1> -Locations <same locations from Step 1> -ConfigurationLocation <Location of configuration files from Step 1> -CopyLocation <Location to copy PST files to>
    ```

    <span data-ttu-id="10c08-259">Nella tabella seguente vengono descritti i parametri e i valori necessari quando si esegue il comando DataCollectorMaster. exe per copiare i file PST.</span><span class="sxs-lookup"><span data-stu-id="10c08-259">The following table describes the parameters and their required values when you run the DataCollectorMaster.exe command to copy PST files.</span></span> 
    
    |<span data-ttu-id="10c08-260">Parametro \* \* \* \*</span><span class="sxs-lookup"><span data-stu-id="10c08-260">\*\*\*\*Parameter\*\*\*\*</span></span>|<span data-ttu-id="10c08-261">\*\*\*\*Description\*\*\*\*</span><span class="sxs-lookup"><span data-stu-id="10c08-261">\*\*\*\*Description\*\*\*\*</span></span>|<span data-ttu-id="10c08-262">Esempi \* \* \* \*</span><span class="sxs-lookup"><span data-stu-id="10c08-262">\*\*\*\*Examples\*\*\*\*</span></span>|
    |:-----|:-----|:-----|
    | `DataSource` <br/> |<span data-ttu-id="10c08-p139">Specifica il tipo di dati da cercare. Attualmente, è possibile utilizzare lo strumento di raccolta PST per cercare i file PST.</span><span class="sxs-lookup"><span data-stu-id="10c08-p139">Specifies the type of data to search for. Currently, you can use the PST Collection tool to search for PST files.</span></span>  <br/> | `-DataSource Pst` <br/> |
    | `Mode` <br/> |<span data-ttu-id="10c08-p140">Specifica il tipo di operazione che verrà eseguito dallo strumento. Utilizzare il valore `Collect` per copiare i file PST che sono stati trovati quando è stato eseguito lo strumento nella modalità di ricerca. Si noti che lo strumento è in grado di copiare i file PST che sono aperti in Outlook e copiare i file PST che sono connessi ai profili di Outlook.</span><span class="sxs-lookup"><span data-stu-id="10c08-p140">Specifies the type of operation that the tool will perform. Use the value  `Collect` to copy that PST files that were found when you ran to the tool in the Find mode. Note that the tool is able copy PST files that are open in Outlook and copy PST files that are connected to Outlook profiles.  </span></span><br/> | `-Mode Collect` <br/> |
    | `JobName` <br/> |<span data-ttu-id="10c08-p141">Specifica il nome di un processo di raccolta PST esistente. È necessario utilizzare lo stesso nome del processo utilizzato per l'esecuzione dello strumento nella modalità di ricerca nel passaggio 1. Il nome del processo viene inoltre aggiunto al nome del file di registro creato quando si esegue lo strumento nella modalità raccolta.</span><span class="sxs-lookup"><span data-stu-id="10c08-p141">Specifies the name of an existing PST Collection job. You have to use this same job name that you used when you ran the tool in the Find mode in Step 1. This job name is also added to the name of the log file that is created when you run the tool in the Collect mode.</span></span>  <br/> | `-JobName PstSearch1` <br/> |
    | `Locations` <br/> |<span data-ttu-id="10c08-p142">Utilizzare lo stesso valore utilizzato per il `Locations` parametro nel passaggio 1. Se si desidera rieseguire lo strumento per eliminare i file PST dal percorso di origine nel passaggio 5, è necessario includere questo parametro quando si esegue lo strumento nella modalità raccolta.</span><span class="sxs-lookup"><span data-stu-id="10c08-p142">Use the same value that you used for the  `Locations` parameter in Step 1. You have include this parameter when you run the tool in the Collect mode if you want to re-run the tool to delete the PST files from their source location in Step 5.  </span></span><br/> | `-Locations "CN=FILESERVER01,CN=Computers,DC=contoso,DC=com"; "CN=FILESERVER02,CN=Computers,DC=contoso,DC=com"` <br/> |
    | `ConfigurationLocation` <br/> |<span data-ttu-id="10c08-p143">Specifica la cartella che contiene il file di configurazione XML che è stato creato quando è stato eseguito lo strumento nella modalità di ricerca. Utilizzare lo stesso valore utilizzato per questo parametro nel passaggio 1.</span><span class="sxs-lookup"><span data-stu-id="10c08-p143">Specifies the folder that contains the .xml configuration file that was created when you ran the tool in the Find mode. Use the same value that you used for this parameter in Step 1.</span></span>  <br/> | `-ConfigurationLocation "c:\users\admin\desktop \PSTCollection\Configuration"` <br/> |
    | `CopyLocation` <br/> |<span data-ttu-id="10c08-p144">Specifica la posizione dell'insieme in cui si desidera copiare i file PST. È possibile copiare i file in un file server, in una condivisione file di rete o in un'unità disco rigido. La posizione deve esistere prima di eseguire lo strumento nella modalità raccolta. Lo strumento non crea la posizione e restituirà un messaggio di errore che indica che non esiste.</span><span class="sxs-lookup"><span data-stu-id="10c08-p144">Specifies the collection location where you want to copy the PST files to. You can copy files to a file server, a network file share, or a hard drive. The location must exist before you run the tool in the Collect mode. The tool doesn't create the location, and will return an error saying that it doesn't exist.</span></span>  <br/> <span data-ttu-id="10c08-279">Inoltre, è necessario scrivere le autorizzazioni per la posizione dell'insieme specificata da questo parametro.</span><span class="sxs-lookup"><span data-stu-id="10c08-279">Also, you have to write permissions to the collection location specified by this parameter.</span></span>  <br/> | `-CopyLocation "\\FILESERVER03\PSTs"` <br/> |
    | `LogLocation` <br/> |<span data-ttu-id="10c08-p145">Specifica la cartella in cui verrà copiato il file di registro per la modalità di raccolta. Si tratta di un parametro facoltativo. Se non è incluso, il file di registro viene copiato nella cartella in cui è stato scaricato lo strumento di raccolta PST. È consigliabile utilizzare la stessa posizione del log utilizzata per l'esecuzione dello strumento nella modalità di ricerca nel passaggio 1, in modo che tutti i file di registro vengano salvati nella stessa cartella.</span><span class="sxs-lookup"><span data-stu-id="10c08-p145">Specifies the folder that the log file for the Collect mode will be copied to. This is an optional parameter. If you don't include it, the log file is copied to the folder where you downloaded the PST Collection tool to. Consider using the same log location that you used when you ran the tool in the Find mode in Step 1 so that all the log files are saved in the same folder.</span></span>  <br/> | `-LogLocation "c:\users\admin\desktop\PSTCollection"` <br/> |
    | `ForceRestart` <br/> |<span data-ttu-id="10c08-p146">Questa opzione opzionale consente di rieseguire lo strumento nella modalità raccolta per un processo di raccolta PST esistente. Se in precedenza è stato eseguito lo strumento nella modalità raccolta, ma è stato eseguito di nuovo lo strumento nella modalità di `ForceRestart` ricerca con l'opzione per eseguire una nuova analisi delle posizioni per i file PST, è possibile utilizzare questa opzione per rieseguire lo strumento in modalità insieme e ricopiare i file PST trovati quando il rieseguire la scansione delle posizioni. Quando si utilizza `ForceRestart` l'opzione in modalità raccolta, lo strumento ignora tutte le operazioni di raccolta precedenti e tenta di copiare i file PST da zero.</span><span class="sxs-lookup"><span data-stu-id="10c08-p146">This optional switch lets you re-run the tool in the Collection mode for an existing PST Collection job. If you previously ran the tool in the Collect mode, but then ran the tool again in the Find mode with the  `ForceRestart` switch to re-scan locations for PST files, you can use this switch to re-run the tool in Collection mode and re-copy the PST files there were found when your re-scanned the locations. When using the  `ForceRestart` switch in Collection mode, the tool ignores any previous Collection operations and attempts to copy the PST files from scratch.  </span></span><br/> | `-ForceRestart` <br/> |
   
    <span data-ttu-id="10c08-287">Di seguito è riportato un esempio della sintassi dello strumento DataCollectorMaster. exe che utilizza i valori effettivi di ogni parametro:</span><span class="sxs-lookup"><span data-stu-id="10c08-287">Here's an example of the syntax for the DataCollectorMaster.exe tool using actual values for each parameter:</span></span>
    
    ```
    DataCollectorMaster.exe -DataSource Pst -Mode Collect -JobName PstSearch1 -Locations "CN=FILESERVER01,CN=Computers,DC=contoso,DC=com";"CN=FILESERVER02,CN=Computers,DC=contoso,DC=com" -ConfigurationLocation "c:\users\admin\desktop\PSTCollection\Configuration" -CopyLocation "\\FILESERVER03\PSTs" -LogLocation "c:\users\admin\desktop\PSTCollection"
    ```

    <span data-ttu-id="10c08-p147">Dopo aver eseguito il comando, vengono visualizzati messaggi di stato dettagliati che mostrano lo stato di avanzamento della raccolta dei file PST che sono stati individuati nel passaggio 1. Dopo un po', un messaggio di stato finale indica se si sono verificati errori e la posizione in cui viene copiato il log. Gli stessi messaggi di stato vengono copiati nel file. log.</span><span class="sxs-lookup"><span data-stu-id="10c08-p147">After you run the command, detailed status messages are displayed that show the progress of collecting the PST files that were found in Step 1. After a while, a final status message shows if there were any errors and the location that the log is copied to. The same status messages are copied to the .log file.</span></span>
    
### <a name="results-of-running-datacollectormasterexe-in-the-collect-mode"></a><span data-ttu-id="10c08-291">Risultati dell'esecuzione di DataCollectorMaster. exe nella modalità raccolta</span><span class="sxs-lookup"><span data-stu-id="10c08-291">Results of running DataCollectorMaster.exe in the Collect mode</span></span>

<span data-ttu-id="10c08-292">Dopo aver eseguito correttamente DataCollectorMaster. exe nella modalità Collect, i file seguenti vengono creati e archiviati nelle cartelle specificate dai parametri `LogLocation` e. `ConfigurationLocation`</span><span class="sxs-lookup"><span data-stu-id="10c08-292">After you successfully run DataCollectorMaster.exe in the Collect mode, the following files are created and stored in the folders specified by the  `LogLocation` and  `ConfigurationLocation` parameters.</span></span> 
  
- <span data-ttu-id="10c08-p148">**\<JobName\>__ collect\<DateTimeStamp\>. log** : il file di log contiene i messaggi di stato che sono stati visualizzati. Questo file viene creato nella cartella specificata dal `LogLocation` parametro.</span><span class="sxs-lookup"><span data-stu-id="10c08-p148">**\<JobName\>_Collect_\<DateTimeStamp\>.log** - The log file contains the status messages that were displayed. This file is created in the folder specified by the  `LogLocation` parameter.</span></span> 
    
- <span data-ttu-id="10c08-p149">**\<JobName\>__ collect\<DateTimeStamp\>. XML** -il file XML contiene solo informazioni sui valori dei parametri utilizzati dallo strumento in modalità raccolta. I dati contenuti in questo file vengono utilizzati quando si esegue nuovamente lo strumento DataCollectorMaster. exe per eliminare i file PST; vedere il [passaggio 5](#step-5-delete-the-pst-files-found-on-your-network).</span><span class="sxs-lookup"><span data-stu-id="10c08-p149">**\<JobName\>_Collect_\<DateTimeStamp\>.xml** - The XML file only contains information about the parameter values that where used by the tool was run in the Collect mode. The data in this file is used when you run re-run the DataCollectorMaster.exe tool to delete PST files; see [Step 5](#step-5-delete-the-pst-files-found-on-your-network).</span></span>
    

## <a name="step-4-import-the-pst-files-to-office-365"></a><span data-ttu-id="10c08-297">Passaggio 4: importare i file PST in Office 365</span><span class="sxs-lookup"><span data-stu-id="10c08-297">Step 4: Import the PST files to Office 365</span></span>

<span data-ttu-id="10c08-p150">Dopo aver raccolto i file PST trovati nel passaggio 1, il passaggio successivo consiste nell'importarli in cassette postali in Office 365. Come parte o il processo di importazione, è necessario creare un file di mapping CSV che contiene una riga di ogni file PST che si desidera importare. Informazioni in ogni riga specifica il nome del file PST, l'indirizzo di posta elettronica dell'utente e se si desidera importare il file PST nella cassetta postale principale o di archiviazione dell'utente. Utilizzare le informazioni contenute nel **file\>DateTimeStamp. CSV di JobName_Find_\<** (creato nel passaggio) 1 per semplificare la creazione del file di mapping CSV.</span><span class="sxs-lookup"><span data-stu-id="10c08-p150">After you've collected the PST files found in Step 1, the next step is to import them to mailboxes in Office 365. As part or the import process, you'll have to create a CSV mapping file that contains a row of each PST file that you want import. Information in each row specifies the name of the PST file, the user's email address, and whether you want to import the PST file to the user's primary or archive mailbox. Use the information in the **JobName\>_Find_\<DateTimeStamp.csv** file (created in Step) 1 to help you create the CSV mapping file.</span></span> 
  
<span data-ttu-id="10c08-302">Per istruzioni dettagliate sull'importazione di file PST in Office 365, vedere uno dei seguenti argomenti:</span><span class="sxs-lookup"><span data-stu-id="10c08-302">For step-by-step instructions to import PST files to Office 365, see one of the following topics:</span></span>
  
- [<span data-ttu-id="10c08-303">Utilizzare il caricamento di rete per importare i file PST su Office 365</span><span class="sxs-lookup"><span data-stu-id="10c08-303">Use network upload to import PST files to Office 365</span></span>](use-network-upload-to-import-pst-files.md)
    
- [<span data-ttu-id="10c08-304">Utilizzare la spedizione dell'unità per importare file PST in Office 365</span><span class="sxs-lookup"><span data-stu-id="10c08-304">Use drive shipping to import PST files to Office 365</span></span>](use-drive-shipping-to-import-pst-files-to-office-365.md)
    

## <a name="step-5-delete-the-pst-files-found-on-your-network"></a><span data-ttu-id="10c08-305">Passaggio 5: eliminare i file PST trovati sulla rete</span><span class="sxs-lookup"><span data-stu-id="10c08-305">Step 5: Delete the PST files found on your network</span></span>

<span data-ttu-id="10c08-306">Dopo che i file PST trovati e raccolti sono stati importati nelle cassette postali di Exchange online in Office 365, è possibile utilizzare lo strumento di raccolta PST per eliminare i file PST dai percorsi di origine originali in cui sono stati rilevati nel passaggio 1.</span><span class="sxs-lookup"><span data-stu-id="10c08-306">After the PST files that you found and collected have been imported to Exchange Online mailboxes in Office 365, you can use the PST Collection tool to delete the PST files from the original source locations where they were found in Step 1.</span></span> 
  
1. <span data-ttu-id="10c08-307">Aprire un prompt dei comandi (Esegui come amministratore) nel computer locale.</span><span class="sxs-lookup"><span data-stu-id="10c08-307">Open a Command Prompt (run as administrator) on your local computer.</span></span>
    
2. <span data-ttu-id="10c08-308">Passare alla directory in cui è stato scaricato lo strumento di raccolta PST.</span><span class="sxs-lookup"><span data-stu-id="10c08-308">Go to the directory where you downloaded the PST Collection tool to.</span></span>
    
3. <span data-ttu-id="10c08-309">Eseguire il seguente comando per eliminare i file PST.</span><span class="sxs-lookup"><span data-stu-id="10c08-309">Run the following command to delete the PST files.</span></span>

    ```
    DataCollectorMaster.exe -DataSource Pst -Mode Delete -JobName <Name of job from Step 1> -ConfigurationLocation <Location of configuration files from Step 1> -CopyLocation <Location to copy PST files to>
    ```

    <span data-ttu-id="10c08-310">Nella tabella seguente vengono descritti i parametri e i valori necessari quando si esegue il comando DataCollectorMaster. exe per eliminare i file PST.</span><span class="sxs-lookup"><span data-stu-id="10c08-310">The following table describes the parameters and their required values when you run the DataCollectorMaster.exe command to delete PST files.</span></span> 
    
    |<span data-ttu-id="10c08-311">Parametro \* \* \* \*</span><span class="sxs-lookup"><span data-stu-id="10c08-311">\*\*\*\*Parameter\*\*\*\*</span></span>|<span data-ttu-id="10c08-312">\*\*\*\*Description\*\*\*\*</span><span class="sxs-lookup"><span data-stu-id="10c08-312">\*\*\*\*Description\*\*\*\*</span></span>|<span data-ttu-id="10c08-313">Esempi \* \* \* \*</span><span class="sxs-lookup"><span data-stu-id="10c08-313">\*\*\*\*Examples\*\*\*\*</span></span>|
    |:-----|:-----|:-----|
    | `DataSource` <br/> |<span data-ttu-id="10c08-p151">Specifica il tipo di dati da cercare. Attualmente, è possibile utilizzare lo strumento di raccolta PST per cercare i file PST.</span><span class="sxs-lookup"><span data-stu-id="10c08-p151">Specifies the type of data to search for. Currently, you can use the PST Collection tool to search for PST files.</span></span> ![spaziatore](media/b078d05c-3aee-4b9f-8805-6a8a9d8970ee.png)           <br/> | `-DataSource Pst` <br/> |
    | `Mode` <br/> |<span data-ttu-id="10c08-p152">Specifica il tipo di operazione che verrà eseguito dallo strumento. Utilizzare il valore `Delete` per eliminare i file PST che sono stati trovati quando è stato eseguito lo strumento nella modalità di ricerca.</span><span class="sxs-lookup"><span data-stu-id="10c08-p152">Specifies the type of operation that the tool will perform. Use the value  `Delete` to delete that PST files that were found when you ran to the tool in the Find mode.  </span></span><br/> | `-Mode Delete` <br/> |
    | `JobName` <br/> |<span data-ttu-id="10c08-p153">Specifica il nome di un processo di raccolta PST esistente. È necessario utilizzare lo stesso nome del processo utilizzato per l'esecuzione dello strumento nella modalità di ricerca e nella modalità raccolta del passaggio 1 e del passaggio 3. Il nome del processo viene inoltre aggiunto al nome del file di registro creato quando si esegue lo strumento in modalità di eliminazione.</span><span class="sxs-lookup"><span data-stu-id="10c08-p153">Specifies the name of an existing PST Collection job. You have to use this same job name that you used when you ran the tool in the Find mode and the Collect mode in Step 1 and Step 3. This job name is also added to the name of the log file that is created when you run the tool in the Delete mode.</span></span>  <br/> | `-JobName PstSearch1` <br/> |
    | `ConfigurationLocation` <br/> |<span data-ttu-id="10c08-p154">Specifica la cartella che contiene il file di configurazione XML che è stato creato quando è stato eseguito lo strumento nella modalità raccolta. Utilizzare lo stesso valore utilizzato per questo parametro nel passaggio 3.</span><span class="sxs-lookup"><span data-stu-id="10c08-p154">Specifies the folder that contains the .xml configuration file that was created when you ran the tool in the Collect mode. Use the same value that you used for this parameter in Step 3.</span></span>  <br/> | `-ConfigurationLocation "c:\users\admin\ desktop\PSTCollection\Configuration"` <br/> |
    | `LogLocation` <br/> |<span data-ttu-id="10c08-p155">Specifica la cartella in cui verrà copiato il file di registro per la modalità di eliminazione. Si tratta di un parametro facoltativo. Se non è incluso, il file di registro viene copiato nella cartella in cui è stato scaricato lo strumento di raccolta PST. È consigliabile utilizzare la stessa posizione del log utilizzata per l'esecuzione dello strumento nelle modalità di ricerca e raccolta del passaggio 1 e del passaggio 3, in modo che tutti i file di registro vengano salvati nella stessa cartella.</span><span class="sxs-lookup"><span data-stu-id="10c08-p155">Specifies the folder that the log file for the Delete mode will be copied to. This is an optional parameter. If you don't include it, the log file is copied to the folder where you downloaded the PST Collection tool to. Consider using the same log location that you used when you ran the tool in the Find and Collect modes in Step 1 and Step 3 so that all the log files are saved in the same folder.</span></span>  <br/> | `-LogLocation "c:\users\admin\desktop\PSTCollection"` <br/> |
    | `ForceRestart` <br/> |<span data-ttu-id="10c08-p156">Questa opzione opzionale consente di rieseguire lo strumento in modalità di eliminazione per un processo di raccolta PST esistente. Se in precedenza è stato eseguito lo strumento in modalità di eliminazione, ma è stato eseguito di nuovo lo strumento nella modalità `ForceRestart` di ricerca con l'opzione per rieseguire l'analisi delle posizioni per i file PST, è possibile utilizzare questa opzione per ripetere l'esecuzione dello strumento in modalità di eliminazione ed eliminare i file PST trovati quando il nuovo SCA nned le posizioni. Quando si utilizza `ForceRestart` l'opzione in modalità di eliminazione, lo strumento ignora le operazioni di eliminazione precedenti e tenta di eliminare di nuovo i file PST.</span><span class="sxs-lookup"><span data-stu-id="10c08-p156">This optional switch lets you re-run the tool in the Delete mode for an existing PST Collection job. If you previously ran the tool in the Delete mode, but then ran the tool again in the Find mode with the  `ForceRestart` switch to re-scan locations for PST files, you can use this switch to re-run the tool in Delete mode and delete the PST files there were found when your re-scanned the locations. When using the  `ForceRestart` switch in Delete mode, the tool ignores any previous Delete operations and attempts to delete the PST files again.  </span></span><br/> | `-ForceRestart` <br/> 

    <span data-ttu-id="10c08-331">Di seguito è riportato un esempio della sintassi dello strumento DataCollectorMaster. exe che utilizza i valori effettivi di ogni parametro:</span><span class="sxs-lookup"><span data-stu-id="10c08-331">Here's an example of the syntax for the DataCollectorMaster.exe tool using actual values for each parameter:</span></span>
    
    ```
    DataCollectorMaster.exe -DataSource Pst -Mode Delete -JobName PstSearch1 -ConfigurationLocation "c:\users\admin\desktop\PSTCollection\Configuration" -LogLocation "c:\users\admin\desktop\PSTCollection"
    ```
   
    <span data-ttu-id="10c08-p157">Dopo aver eseguito il comando, vengono visualizzati messaggi di stato dettagliati che mostrano lo stato di avanzamento dell'eliminazione dei file PST che sono stati rilevati nel passaggio 1 e raccolti nel passaggio 3. Dopo un po', un messaggio di stato finale indica se si sono verificati errori e la posizione in cui viene copiato il log. Gli stessi messaggi di stato vengono copiati nel file. log.</span><span class="sxs-lookup"><span data-stu-id="10c08-p157">After you run the command, detailed status messages are displayed that show the progress of deleting the PST files that were found in Step 1 and collected in Step 3. After a while, a final status message shows if there were any errors and the location that the log is copied to. The same status messages are copied to the .log file.</span></span>
    
### <a name="results-of-running-datacollectormasterexe-in-the-delete-mode"></a><span data-ttu-id="10c08-335">Risultati dell'esecuzione di DataCollectorMaster. exe in modalità di eliminazione</span><span class="sxs-lookup"><span data-stu-id="10c08-335">Results of running DataCollectorMaster.exe in the Delete mode</span></span>

<span data-ttu-id="10c08-336">Dopo aver eseguito correttamente DataCollectorMaster. exe in modalità di eliminazione, i file seguenti vengono creati e archiviati nella cartella specificata dai parametri `LogLocation` e. `ConfigurationLocation`</span><span class="sxs-lookup"><span data-stu-id="10c08-336">After you successfully run DataCollectorMaster.exe in the Delete mode, the following files are created and stored in the folder specified by the  `LogLocation` and  `ConfigurationLocation` parameters.</span></span> 
  
- <span data-ttu-id="10c08-p158">**\<JobName\>__ Delete\<DateTimeStamp\>. log** : il file di log contiene i messaggi di stato che sono stati visualizzati. Questo file viene creato nella cartella specificata dal `LogLocation` parametro.</span><span class="sxs-lookup"><span data-stu-id="10c08-p158">**\<JobName\>_Delete_\<DateTimeStamp\>.log** - The log file contains the status messages that were displayed. This file is created in the folder specified by the  `LogLocation` parameter.</span></span> 
    
- <span data-ttu-id="10c08-p159">**\<JobName\>__ Delete\<DateTimeStamp\>. XML** -il file XML contiene solo informazioni sui valori dei parametri utilizzati dallo strumento in modalità di eliminazione. Vengono inoltre elencati il nome e il percorso del file di ogni file PST che è stato eliminato. Questo file viene creato nella cartella specificata dal `ConfigurationLocation` parametro.</span><span class="sxs-lookup"><span data-stu-id="10c08-p159">**\<JobName\>_Delete_\<DateTimeStamp\>.xml** - The XML file only contains information about the parameter values that where used by the tool was run in the Delete mode. It also lists the name and file path of each PST file that was deleted. This file is created in the folder specified by the  `ConfigurationLocation` parameter.</span></span> 
