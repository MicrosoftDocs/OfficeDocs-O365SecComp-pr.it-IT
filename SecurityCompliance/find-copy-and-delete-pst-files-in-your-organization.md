---
title: Utilizzare lo strumento PST raccolta per trovare, copiare ed eliminare i file PST all'interno dell'organizzazione
ms.author: markjjo
author: markjjo
manager: laurawi
ms.date: ''
ms.audience: Admin
ms.topic: article
ms.service: o365-administration
localization_priority: Normal
ms.collection: Strat_O365_IP
search.appverid: MOE150
ms.assetid: 7a150c84-049c-4a9c-8c91-22355b35f2a7
description: Utilizzare lo strumento di raccolta PST Microsoft per la ricerca della rete dell'organizzazione per ottenere un inventario dei file PST sparsi in tutta l'organizzazione. Dopo aver individuato file PST, è possibile utilizzare lo strumento di raccolta di file PST da copiare in una posizione centrale in modo che è possibile importarli a Office 365.
ms.openlocfilehash: 34395eee7776d8bff1ddccb7fed5b683e97c02c7
ms.sourcegitcommit: c59a082dca6593d0e35e58124ee6ba240547bfa5
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 12/05/2018
ms.locfileid: "27154212"
---
# <a name="use-the-pst-collection-tool-to-find-copy-and-delete-pst-files-in-your-organization"></a><span data-ttu-id="fd0d5-104">Utilizzare lo strumento PST raccolta per trovare, copiare ed eliminare i file PST all'interno dell'organizzazione</span><span class="sxs-lookup"><span data-stu-id="fd0d5-104">Use the PST Collection tool to find, copy, and delete PST files in your organization</span></span>

> [!IMPORTANT]
> <span data-ttu-id="fd0d5-p102">Lo strumento PST insieme descritto in questo articolo non è supportato in qualsiasi programma Microsoft supporto standard o del servizio. Lo strumento viene fornito così com'è senza garanzie di alcun tipo. Microsoft ha non riconosce tutte le garanzie implicite, in via esemplificativa, una garanzia di commerciabilità o idoneità per uno scopo specifico. Tutti i rischi derivanti dall'utilizzo o delle prestazioni degli strumenti e documentazione rimangono con l'utente. In alcun caso Microsoft, relativi autori o altre posizioni necessarie per la creazione, produzione o lo strumento di tutti gli utenti saranno responsabili per danni (incluso, in via esemplificativa, danni per mancato guadagno, interruzione delle attività, la perdita di perdita le informazioni aziendali o altre perdite economiche) derivanti dall'utilizzo di o impossibilità di utilizzare lo strumento o documentazione, anche se Microsoft è stati informati della possibilità di tali danni.</span><span class="sxs-lookup"><span data-stu-id="fd0d5-p102">The PST Collection tool described in this article isn’t supported under any Microsoft standard support program or service. The tool is provided AS IS without warranty of any kind. Microsoft further disclaims all implied warranties including, without limitation, any implied warranties of merchantability or of fitness for a particular purpose. The entire risk arising out of the use or performance of the tool and documentation remains with you. In no event shall Microsoft, its authors, or anyone else involved in the creation, production, or delivery of the tool be liable for any damages whatsoever (including, without limitation, damages for loss of business profits, business interruption, loss of business information, or other pecuniary loss) arising out of the use of or inability to use the tool or documentation, even if Microsoft has been advised of the possibility of such damages.</span></span>

<span data-ttu-id="fd0d5-p103">È possibile utilizzare lo strumento Microsoft PST raccolta per la ricerca della rete dell'organizzazione per i file PST. Lo strumento consente di ottenere un inventario dei file PST sparsi in tutta l'organizzazione. Dopo aver individuato file PST, è possibile utilizzare lo strumento PST insieme a copiarli in una posizione centrale. La presenza di file pst in un'unica posizione quindi consente di importare loro di cassette postali Exchange Online (o una singola cassetta postale di Exchange Online), dove è quindi possibile applicare l'ampia gamma di funzionalità di conformità in Office 365. Include l'importazione di file pst in archivio contiene le cassette postali, la ricerca dei messaggi specifici nei file PST che è stato importato utilizzando gli strumenti di ricerca di eDiscovery, conservazione dei messaggi tramite eDiscovery degli utenti e i criteri di conservazione Office 365 e la gestione di tutta la durata ciclo di questi messaggi tramite la messaggistica consente di registrare le funzionalità di gestione di Exchange Online. Se si è certi che i file PST che raccolti aver importato correttamente a Office 365, è possibile utilizzare lo strumento di eliminarli dai rispettivi percorsi originali nella rete.</span><span class="sxs-lookup"><span data-stu-id="fd0d5-p103">You can use the Microsoft PST Collection tool to search your organization's network for PST files. The tool helps you get an inventory of PST files that are scattered throughout your organization. After you find PST files, you can use the PST Collection tool to copy them in a central location. Having PSTs in a one place then allows you to import them to Exchange Online mailboxes (or a single Exchange Online mailbox), where you can then apply the rich set of compliance features in Office 365. This includes importing PSTs to users' archive mailboxes, searching for specific messages in the PST files that you imported by using eDiscovery search tools, retaining messages by using eDiscovery holds and Office 365 retention policies, and managing the life cycle of these messages using the messaging records management features in Exchange Online. After you're confident that the PST files that you collected have been successfully imported to Office 365, you can use the tool to delete them from their original location on your network.</span></span> 
  
<span data-ttu-id="fd0d5-p104">In alternativa che è possibile eseguire con lo strumento PST raccolta è impedire agli utenti di creare nuovi file PST e la modifica dei file PST esistenti che trova nella rete. Tali funzionalità "bloccare" consentono di trovare, raccogliere e importare un set di file PST noto a Office 365 e impedire la proliferazione futura dei file PST all'interno dell'organizzazione.</span><span class="sxs-lookup"><span data-stu-id="fd0d5-p104">Another thing you can do with the PST Collection tool is prevent users from creating new PST files and changing the existing PST files that you find on your network. These "block" capabilities let you find, collect, and import a known set of PST files to Office 365 and prevent the future proliferation of PST files in your organization.</span></span> 
  
## <a name="how-the-pst-collection-tool-works"></a><span data-ttu-id="fd0d5-118">Come funziona lo strumento PST raccolta</span><span class="sxs-lookup"><span data-stu-id="fd0d5-118">How the PST Collection tool works</span></span>

<span data-ttu-id="fd0d5-119">Ecco una rapida panoramica del processo di utilizzando lo strumento PST insieme trovare, controllare, raccogliere ed eliminare i file PST all'interno dell'organizzazione.</span><span class="sxs-lookup"><span data-stu-id="fd0d5-119">Here's a quick overview of the process of using the PST Collection tool to find, control, collect, and delete PST files in your organization.</span></span>
  
![Panoramica del processo di strumento PST insieme](media/67a29f27-f83c-4f0a-9df4-7ed92d3086fe.png)
  
1. <span data-ttu-id="fd0d5-p105">**[Passaggio 1: individuazione dei file PST nella rete](#step-1-find-pst-files-on-your-network)** - quando si esegue lo strumento per trovare i file PST, si specifica un percorso, ad esempio un'unità organizzativa che contiene gli oggetti di Active Directory per i computer client e server. È inoltre possibile cercare computer specifici o condivisioni di file di rete. Quando si esegue lo strumento, una "leggero" insieme che viene installato nei computer di destinazione. L'agente Cerca computer di destinazione per i file PST e quindi invia informazioni allo strumento PST raccolta su qualsiasi file PST individuato. Lo strumento crea i file di registro che contiene informazioni sui file PST rilevati nei percorsi specificati. Questi file vengono utilizzati quando si esegue lo strumento nei passaggi successivi.</span><span class="sxs-lookup"><span data-stu-id="fd0d5-p105">**[Step 1: Find PST files on your network](#step-1-find-pst-files-on-your-network)** - When you run the tool to find PST files, you specify a location, such as an organizational unit that contain Active Directory objects for client and server computers. You can also search specific machines or network file shares. When you run the tool, a "lightweight" Collection Agent is installed on the target computers. This agent searches the target computer for PST files and then sends information back to the PST Collection tool about any PST file it finds. The tool creates log files that contains information about the PST files that were found in the specified locations. These files are used when you run the tool in later steps.</span></span> 
    
2. <span data-ttu-id="fd0d5-p106">**[(Facoltativo) passaggio 2: controllare l'accesso ai file PST](#optional-step-2-control-access-to-pst-files)** -lo strumento crea un oggetto Criteri di gruppo (GPO) con le impostazioni che impedisce agli utenti di creare o modificare i file PST. Questo oggetto Criteri di gruppo viene applicato a tutti gli utenti nel dominio. Questo passaggio facoltativo consente di "bloccare" i file PST che sono state trovate nel passaggio 1 in modo che è possibile raccogliere, importare ed eliminarli senza la necessità di nuovi file PST creati o modificati i file PST esistenti.</span><span class="sxs-lookup"><span data-stu-id="fd0d5-p106">**[(Optional) Step 2: Control access to PST files](#optional-step-2-control-access-to-pst-files)** - The tool creates a Group Policy Object (GPO) with settings that prevent users from creating or changing PST files. This GPO is applied to every user in your domain. This optional step helps you "lock down" the PST files that were found in Step 1, so that you can collect, import, and delete them without having new PST files created or the existing PST files changed.</span></span> 
    
3. <span data-ttu-id="fd0d5-p107">**[Passaggio 3: copiare i file PST in un percorso raccolta](#step-3-copy-the-pst-files-to-a-collection-location)** -consente di raccogliere i file PST in un'unica posizione, in modo che è possibile importarli alle cassette postali di Exchange Online tramite il servizio Office 365 importare nel passaggio 4. Quando si esegue lo strumento in modalità "raccogliere", ogni agente insieme copia i file PST dal computer di destinazione che è installato l'agente al percorso raccolta.</span><span class="sxs-lookup"><span data-stu-id="fd0d5-p107">**[Step 3: Copy the PST files to a collection location](#step-3-copy-the-pst-files-to-a-collection-location)** - This lets you collect the PST files in one location so that you can import them to Exchange Online mailboxes by using the Office 365 Import service in Step 4. When you run the tool in the "collect" mode, each Collection Agent copies the PST files from the target machine the agent is installed on to the collection location.</span></span> 
    
4. <span data-ttu-id="fd0d5-132">**[Passaggio 4: importare i file PST in Office 365](#step-4-import-the-pst-files-to-office-365)** -dopo aver copiato i file PST in un percorso, si è pronti per importarli alle cassette postali di Exchange Online.</span><span class="sxs-lookup"><span data-stu-id="fd0d5-132">**[Step 4: Import the PST files to Office 365](#step-4-import-the-pst-files-to-office-365)** - After you've copied the PST files to one location, you're ready to import them to Exchange Online mailboxes.</span></span> 
    
5. <span data-ttu-id="fd0d5-133">**[Passaggio 5: Elimina i file PST trovati nella rete](#step-5-delete-the-pst-files-found-on-your-network)** - dopo che i file PST di file che è stato individuato e raccolti sono stati importati alle cassette postali di Exchange Online in Office 365, è possibile utilizzare lo strumento PST raccolta per eliminare i file PST da posizioni originale in cui sono state trovate nel passaggio 1.</span><span class="sxs-lookup"><span data-stu-id="fd0d5-133">**[Step 5: Delete the PST files found on your network](#step-5-delete-the-pst-files-found-on-your-network)** - After the PST files that you found and collected have been imported to Exchange Online mailboxes in Office 365, you can use the PST Collection tool to delete the PST files from the original locations where they were found in Step 1.</span></span> 

## <a name="before-you-begin"></a><span data-ttu-id="fd0d5-134">Prima di iniziare</span><span class="sxs-lookup"><span data-stu-id="fd0d5-134">Before you begin</span></span>

- <span data-ttu-id="fd0d5-135">Eseguire la procedura seguente per scaricare lo strumento PST raccolta nel computer locale.</span><span class="sxs-lookup"><span data-stu-id="fd0d5-135">Follow these steps to download the PST Collection tool to your local computer.</span></span> 
    
    1. <span data-ttu-id="fd0d5-136">[Scaricare lo strumento PST insieme](https://aka.ms/pstcollectiontool).</span><span class="sxs-lookup"><span data-stu-id="fd0d5-136">[Download the PST Collection tool](https://aka.ms/pstcollectiontool).</span></span>
    
    2. <span data-ttu-id="fd0d5-137">Nella finestra popup, fare clic su **Salva** \> **Salva** per salvare il file PSTCollectionTool.zip in una cartella nel computer locale.</span><span class="sxs-lookup"><span data-stu-id="fd0d5-137">In the pop-up window, click **Save** \> **Save as** to save the PSTCollectionTool.zip file to a folder on your local computer.</span></span> 
    
    3. <span data-ttu-id="fd0d5-138">Estrarre il file PSTCollectionTool.zip in una cartella nel computer locale. il nome della cartella predefinita è PSTCollectionTool.</span><span class="sxs-lookup"><span data-stu-id="fd0d5-138">Extract the PSTCollectionTool.zip file to a folder on your local computer; the default folder name is PSTCollectionTool.</span></span>
    
- <span data-ttu-id="fd0d5-139">Per eseguire lo strumento PST raccolta in qualsiasi modalità (Find, blocca, copia o eliminazione), è necessario essere membri del gruppo Domain Admins nel dominio di Active Directory.</span><span class="sxs-lookup"><span data-stu-id="fd0d5-139">To run the PST Collection tool in any mode (Find, Block, Copy, or Delete), you have to be a member of the Domain Administrators group in your Active Directory domain.</span></span> 

## <a name="step-1-find-pst-files-on-your-network"></a><span data-ttu-id="fd0d5-140">Passaggio 1: Individuazione dei file PST nella rete</span><span class="sxs-lookup"><span data-stu-id="fd0d5-140">Step 1: Find PST files on your network</span></span>

<span data-ttu-id="fd0d5-p108">Il primo passaggio consiste nell'eseguire lo strumento PST raccolta per trovare i file PST all'interno dell'organizzazione. È possibile utilizzare lo strumento ricerca i seguenti tipi di percorsi.</span><span class="sxs-lookup"><span data-stu-id="fd0d5-p108">The first step is to run the PST Collection tool to find PST files in your organization. You can use the tool to search the following types of locations.</span></span> 
  
- <span data-ttu-id="fd0d5-p109">Unità organizzative (OU) in un dominio di Active Directory locale. Lo strumento Cerca in tutti i computer contenuti dell'unità Organizzativa specificata.</span><span class="sxs-lookup"><span data-stu-id="fd0d5-p109">Organizational units (OUs) in an on-premises Active Directory domain. The tool searches all the machines that are contained in the specified OU.</span></span> 
    
- <span data-ttu-id="fd0d5-p110">Computer client e server. Lo strumento ricerca i computer specificati.</span><span class="sxs-lookup"><span data-stu-id="fd0d5-p110">Client and server computers. The tool searches the specified machines.</span></span> 
    
- <span data-ttu-id="fd0d5-p111">Condivisioni di rete. Lo strumento ricerca le condivisioni di file di rete specificata.</span><span class="sxs-lookup"><span data-stu-id="fd0d5-p111">Network file shares. The tool searches the specified network file shares.</span></span> 
    
<span data-ttu-id="fd0d5-149">Vedere la descrizione per il `Locations` parametro nella tabella nella procedura seguente per alcuni esempi di sintassi da utilizzare per ognuno di questi tipi di posizione.</span><span class="sxs-lookup"><span data-stu-id="fd0d5-149">See the description for the  `Locations` parameter in table in the following procedure for examples of the syntax to use for each of these location types.</span></span> 
  
> [!IMPORTANT]
> <span data-ttu-id="fd0d5-150">È necessario Esegui lo strumento PST raccolta in modalità trova prima di poter eseguire altre operazioni, ad esempio il blocco, la raccolta o eliminare i file PST.</span><span class="sxs-lookup"><span data-stu-id="fd0d5-150">You have to the run the PST Collection tool in the Find mode before you can perform other actions such as blocking, collecting, or deleting PST files.</span></span> 
  
1. <span data-ttu-id="fd0d5-151">Aprire un prompt dei comandi (Esegui come amministratore) nel computer locale.</span><span class="sxs-lookup"><span data-stu-id="fd0d5-151">Open a Command Prompt (run as administrator) on your local computer.</span></span>
    
2. <span data-ttu-id="fd0d5-152">Passare alla cartella PSTCollectionTool (o la cartella in cui sono stati estratti i file PSTCollectionTool.zip).</span><span class="sxs-lookup"><span data-stu-id="fd0d5-152">Go to the PSTCollectionTool folder (or the folder that you extracted the PSTCollectionTool.zip file to).</span></span>
    
3. <span data-ttu-id="fd0d5-153">Passare alla directory DataCollectorMaster.</span><span class="sxs-lookup"><span data-stu-id="fd0d5-153">Change to the DataCollectorMaster directory.</span></span>
    
4. <span data-ttu-id="fd0d5-154">Eseguire il comando seguente per trovare i file PST in una posizione specificata.</span><span class="sxs-lookup"><span data-stu-id="fd0d5-154">Run the following command to find PST files in a specified location.</span></span>
    
    ```
    DataCollectorMaster.exe -DataSource Pst -Mode Find -JobName <Name> -Locations <Locations to search for PSTs> -LogLocation <Location to store log files> -ConfigurationLocation <Location to store configuration files>
    ```

    <span data-ttu-id="fd0d5-155">Nella tabella seguente vengono descritti i parametri e i relativi valori necessari quando si esegue il comando DataCollectorMaster.exe per trovare i file PST.</span><span class="sxs-lookup"><span data-stu-id="fd0d5-155">The following table describes the parameters and their required values when you run the DataCollectorMaster.exe command to find PST files.</span></span> 
    
    |<span data-ttu-id="fd0d5-156">Parametro \* \* \*</span><span class="sxs-lookup"><span data-stu-id="fd0d5-156">\*\*\*\*Parameter\*\*\*\*</span></span>|<span data-ttu-id="fd0d5-157">\*\*\*\*Description\*\*\*\*</span><span class="sxs-lookup"><span data-stu-id="fd0d5-157">\*\*\*\*Description\*\*\*\*</span></span>|<span data-ttu-id="fd0d5-158">Esempi \* \* \*</span><span class="sxs-lookup"><span data-stu-id="fd0d5-158">\*\*\*\*Examples\*\*\*\*</span></span>|
    |:-----|:-----|:-----|
    | `DataSource` <br/> |<span data-ttu-id="fd0d5-p112">Specifica il tipo di dati da cercare. Attualmente, è possibile utilizzare lo strumento PST raccolta per cercare i file PST.</span><span class="sxs-lookup"><span data-stu-id="fd0d5-p112">Specifies the type of data to search for. Currently, you can use the PST Collection tool to search for PST files.</span></span>  <br/> | `-DataSource Pst` <br/> |
    | `Mode` <br/> |<span data-ttu-id="fd0d5-p113">Specifica il tipo di operazione verrà eseguita. Utilizzare il valore `Find` per individuare i file PST nei percorsi specificati. Si noti che lo strumento può individuare e ottenere informazioni sui file PST che sono aperte in file PST e Outlook connessi a profili di Outlook.</span><span class="sxs-lookup"><span data-stu-id="fd0d5-p113">Specifies the type of operation that the tool will perform. Use the value  `Find` to locate PST files in the specified locations. Note that the tool can find and get information about PST files that are open in Outlook and PST files that are connected to Outlook profiles.  </span></span><br/> | `-Mode Find` <br/> |
    | `JobName` <br/> |<span data-ttu-id="fd0d5-p114">Specifica il nome del processo di raccolta di file PST. Quando si esegue lo strumento PST insieme bloccare, raccogliere ed eliminare i file PST disponibili quando si esegue lo strumento per trovare i file PST, si utilizzeranno questo stesso nome del processo. Il nome del processo verrà aggiunto anche ai nomi di file registro e la configurazione.</span><span class="sxs-lookup"><span data-stu-id="fd0d5-p114">Specifies the name of the PST Collection job. You will use this same job name when you run the PST Collection tool to block, collect, and delete the PST files that are found when you run the tool to find PST files. The job name will also be added to the log and configuration file names.</span></span>  <br/> | `-JobName PstSearch1` <br/> |
    | `Locations` <br/> | <span data-ttu-id="fd0d5-p115">Specifica uno o più percorsi per cercare i file PST. Se si specifica più di una posizione, utilizzare un punto e virgola (;) per separare i singoli percorsi. È necessario racchiudere i singoli valori di questo parametro con virgolette doppie ("").</span><span class="sxs-lookup"><span data-stu-id="fd0d5-p115">Specifies one or more locations to search for PST files. If you specify more than one location, use a semi-colon (;) to separate individual locations. Be sure to surround the individual values of this parameter with double-quotation marks (" ").  </span></span><br/><br/>   <span data-ttu-id="fd0d5-170">Di seguito è riportato il formato di valore identity necessari per i tipi di percorsi che è possibile eseguire la ricerca.</span><span class="sxs-lookup"><span data-stu-id="fd0d5-170">Here is the required identity value format for the types of locations that you can search.</span></span>  <br/><br/>        <span data-ttu-id="fd0d5-171">**Unità organizzative** - utilizzare il nome distinto (DN) per identificare le unità organizzative; Per esempio:`"OU=NorthAmerica,OU=NWRegion,OU=ITServices,DC=contoso,DC=com"`</span><span class="sxs-lookup"><span data-stu-id="fd0d5-171">**OUs** - Use the distinguished name (DN) to identify OUs; for example:  `"OU=NorthAmerica,OU=NWRegion,OU=ITServices,DC=contoso,DC=com"`</span></span> <br/> <span data-ttu-id="fd0d5-172">> [!IMPORTANT]> Non è possibile specificare il contenitore computer incorporato (ad esempio, CN = Computers, DC = contoso, DC = com ") dal momento che non è un'unità organizzativa.</span><span class="sxs-lookup"><span data-stu-id="fd0d5-172">> [!IMPORTANT]>  You can't specify the built-in Computers container (for example, CN=Computers,DC=contoso,DC=com") because it isn't an organizational unit.</span></span><br/> <br/> <span data-ttu-id="fd0d5-173">**Macchine** - utilizzare il nome distinto o il nome di dominio completo (FQDN) per identificare i computer client e server nella rete. Per esempio:</span><span class="sxs-lookup"><span data-stu-id="fd0d5-173">**Machines** - Use the DN or the fully qualified domain name (FQDN) to identify client and server machines on your network; for example:</span></span>  <br/>  <span data-ttu-id="fd0d5-174">NOME DISTINTO:`"CN=FILESERVER01,CN=Computers,DC=contoso,DC=com"`</span><span class="sxs-lookup"><span data-stu-id="fd0d5-174">DN:  `"CN=FILESERVER01,CN=Computers,DC=contoso,DC=com"`</span></span> <br/>  <span data-ttu-id="fd0d5-175">Oppure</span><span class="sxs-lookup"><span data-stu-id="fd0d5-175">Or</span></span>  <br/>  <span data-ttu-id="fd0d5-176">FQDN:`"FILESERVER01.contoso.com"`</span><span class="sxs-lookup"><span data-stu-id="fd0d5-176">FQDN:  `"FILESERVER01.contoso.com"`</span></span> <br/><br/>  <span data-ttu-id="fd0d5-177">**Condivisioni di file di rete** - utilizzare un nome UNC per identificare le condivisioni di file di rete; Per esempio`"\\FILESERVER02\Users"`</span><span class="sxs-lookup"><span data-stu-id="fd0d5-177">**Network file shares** - Use a UNC name to identify network file shares; for example,  `"\\FILESERVER02\Users"`</span></span> <br/> | `-Locations "CN=FILESERVER01,CN=Computers,DC=contoso,DC=com";"CN=FILESERVER02,CN=Computers,DC=contoso,DC=com"` <br/> |
    | `LogLocation` <br/> |<span data-ttu-id="fd0d5-p116">Specifica la cartella in cui verranno copiati i file di registro. Se la cartella non esiste, verrà creato quando si esegue lo strumento.</span><span class="sxs-lookup"><span data-stu-id="fd0d5-p116">Specifies the folder that the log files will be copied to. If the folder doesn't exist, it will be created when you run the tool.</span></span>  <br/> | `-LogLocation "c:\users\admin\desktop\PSTCollection"` <br/> |
    | `ConfigurationLocation` <br/> |<span data-ttu-id="fd0d5-p117">Specifica la cartella in cui verrà copiato il file configuration. Xml. Questo file contiene informazioni su ogni file PST che si trova quando si esegue lo strumento. Questo file sarà utilizzato quando si esegue lo strumento nel passaggio 3 per copiare i file PST disponibili.</span><span class="sxs-lookup"><span data-stu-id="fd0d5-p117">Specifies the folder that the .xml configuration file will be copied to. This file contains information about each PST file that is found when you run the tool. This file will be used when you run the tool in Step 3 to copy the PST files that are found.</span></span>  <br/> | `-ConfigurationLocation "c:\users\admin\desktop\PSTCollection\Configuration"` <br/> |
    | `ExcludedLocations` <br/> |<span data-ttu-id="fd0d5-p118">Questo parametro opzionale specifica percorsi per ignorare la durante un'operazione di ricerca. È possibile escludere le unità organizzative specifiche, computer e condivisioni di file di rete. Ad esempio, è possibile escludere macchine, ad esempio computer configurato come un server SQL server (o altri tipi di server applicazioni), che gli utenti non dispongono dell'accesso a. Se si specifica più di una stessa posizione da escludere, utilizzare un punto e virgola (;) per separare i singoli percorsi. È necessario racchiudere i singoli valori di questo parametro con virgolette doppie ("").</span><span class="sxs-lookup"><span data-stu-id="fd0d5-p118">This optional parameter specifies locations to skip during a Find operation. You can exclude specific OUs, machines, and network file shares. For example, you could exclude machines, such as machine configured as a SQL server (or other kinds of application servers), that users don't have access to. If you specify more than one location to exclude, use a semi-colon (;) to separate individual locations. Be sure to surround the individual values of this parameter with double-quotation marks (" ").</span></span>  <br/> | `-ExcludedLocations "SQLSERVER01.contoso.com"` <br/> |
    | `ForceRestart` <br/> |<span data-ttu-id="fd0d5-p119">Questo parametro opzionale consente di eseguire lo strumento in modalità di ricerca per un processo di raccolta PST esistente. Quando si utilizza il `ForceRestart` passare, i risultati dell'operazione di ricerca precedente per il processo verrà eliminato e lo strumento analizzerà nuovamente i percorsi specificati e creano nuovi file di registro e la configurazione.</span><span class="sxs-lookup"><span data-stu-id="fd0d5-p119">This optional switch lets you run the tool in the Find mode for an existing PST Collection job. When you use the  `ForceRestart` switch, the results from the previous Find operation for the job will be discarded, and the tool will re-scan the specified locations and create new log and configuration files.  </span></span><br/> | `-ForceRestart` <br/> |
   
    <span data-ttu-id="fd0d5-190">Ecco un esempio di sintassi per il comando DataCollectorMaster.exe utilizzando i valori effettivi per ogni parametro:</span><span class="sxs-lookup"><span data-stu-id="fd0d5-190">Here's an example of the syntax for the DataCollectorMaster.exe command using actual values for each parameter:</span></span>
    
    ```
    DataCollectorMaster.exe -DataSource Pst -Mode Find -JobName PstSearch1 -Locations "CN=FILESERVER01,CN=Computers,DC=contoso,DC=com";"CN=FILESERVER02,CN=Computers,DC=contoso,DC=com" -LogLocation "c:\users\admin\desktop\PSTCollection" -ConfigurationLocation "c:\users\admin\desktop\PSTCollection\Configuration"
    ```

    <span data-ttu-id="fd0d5-p120">Dopo aver eseguito il comando, vengono visualizzati messaggi di stato dettagliato che mostrano lo stato di avanzamento di individuazione file PST nei percorsi specificati. Dopo un po' di tempo, verrà visualizzato un messaggio di stato finale il numero totale di file PST che sono state trovate, se il processo è stato completato e se si sono verificati errori di. Il file di log vengono copiati gli stessi messaggi di stato.</span><span class="sxs-lookup"><span data-stu-id="fd0d5-p120">After you run the command, detailed status messages are displayed that show the progress of finding PST files in the specified locations. After a while, a final status message shows the total number of PST files that were found, whether the job has completed, and if there were any errors. The same status messages are copied to the .log file.</span></span>
    
### <a name="results-of-running-datacollectormasterexe-in-the-find-mode"></a><span data-ttu-id="fd0d5-194">Risultati dell'esecuzione DataCollectorMaster.exe nella modalità di ricerca</span><span class="sxs-lookup"><span data-stu-id="fd0d5-194">Results of running DataCollectorMaster.exe in the Find mode</span></span>

<span data-ttu-id="fd0d5-195">Dopo aver eseguito lo strumento PST raccolta la modalità di ricerca, i file seguenti vengono creati e memorizzati nelle cartelle specificate per il `LogLocation` e `ConfigurationLocation` parametri.</span><span class="sxs-lookup"><span data-stu-id="fd0d5-195">After you successfully run the PST Collection tool the Find mode, the following files are created and stored in the folders specified by the  `LogLocation` and  `ConfigurationLocation` parameters.</span></span> 
  
- <span data-ttu-id="fd0d5-p121">**\<Specificare nome di processo\>_trovare_\<DateTimeStamp\>. log** -il file di registro contiene i messaggi di stato che sono stati visualizzati. Questo file viene creato nella cartella specificata per il `LogLocation` parametro.</span><span class="sxs-lookup"><span data-stu-id="fd0d5-p121">**\<JobName\>_Find_\<DateTimeStamp\>.log** - The log file contains the status messages that were displayed. This file is created in the folder specified by the  `LogLocation` parameter.</span></span> 
    
- <span data-ttu-id="fd0d5-p122">**\<Specificare nome di processo\>_trovare_\<DateTimeStamp\>. csv** -file CSV The contiene una riga per ogni file PST che è stato trovato. Le informazioni per ogni file PST includono i computer in cui è stato trovato il file PST, il percorso completo del file del file PST, il proprietario del file PST e la dimensione del file PST (in kilobyte, KB). Questo file viene creato nella cartella specificata per il `LogLocation` parametro.</span><span class="sxs-lookup"><span data-stu-id="fd0d5-p122">**\<JobName\>_Find_\<DateTimeStamp\>.csv** - The CSV file contains a row for each PST file that was found. The information for each PST includes the computer where the PST file was found, the full file path location of the PST file, the owner of the PST file, and the size (in kilobytes, KBs) of the PST file. This file is created in the folder specified by the  `LogLocation` parameter.</span></span> 
    
    > [!TIP]
    > <span data-ttu-id="fd0d5-p123">Utilizzare lo strumento AutoSum in Excel per calcolare la dimensione totale (in KB) dei file PST elencati nel file CSV. Quindi è possibile utilizzare un calcolo di conversione per convertire le dimensioni totali in megabyte (MB) o gigabyte (GB).</span><span class="sxs-lookup"><span data-stu-id="fd0d5-p123">Use the AutoSum tool in Excel to calculate the total size (in KB) of all the PST files listed in the CSV file. Then you can use a conversion calculator to convert the total size to megabytes (MB) or gigabytes (GB).</span></span> 
  
- <span data-ttu-id="fd0d5-p124">**\<Specificare nome di processo\>_trovare_\<DateTimeStamp\>. XML** -il file XML contiene informazioni sui valori dei parametri del che dove utilizzato durante l'esecuzione dello strumento in modalità di ricerca. Questo file contiene inoltre informazioni su tutti i file PST che è stato trovato. I dati in questo file viene utilizzati quando si esegue eseguire di nuovo lo strumento per lo stesso processo di blocco, raccogliere o Elimina i file PST i file che sono stati rilevati. Questo file viene creato nella cartella specificata per il `ConfigurationLocation` parametro.</span><span class="sxs-lookup"><span data-stu-id="fd0d5-p124">**\<JobName\>_Find_\<DateTimeStamp\>.xml** - The XML file contains information about the parameter values that where used when you ran the tool in the Find mode. This file also contains information about every PST file that was found. The data in this file is used when you run re-run the tool for the same job to block, collect, or delete the PST files that were found. This file is created in the folder specified by the  `ConfigurationLocation` parameter.</span></span> 
    
    > [!IMPORTANT]
    > <span data-ttu-id="fd0d5-p125">Non rinominare, modificare o spostare il file. Viene utilizzato per lo strumento PST raccolta quando eseguire di nuovo lo strumento in blocco, copia, o eliminare la modalità per lo stesso processo.</span><span class="sxs-lookup"><span data-stu-id="fd0d5-p125">Don't rename, change, or move this file. It's used by the PST Collection tool when you re-run the tool in the Block, Copy, or Delete mode for the same job.</span></span> 

## <a name="optional-step-2-control-access-to-pst-files"></a><span data-ttu-id="fd0d5-209">(Facoltativo) Passaggio 2: Controllare l'accesso ai file PST</span><span class="sxs-lookup"><span data-stu-id="fd0d5-209">(Optional) Step 2: Control access to PST files</span></span>

<span data-ttu-id="fd0d5-p126">Consente di passaggio facoltativo è "bloccare" i file PST che sono state trovate nel passaggio 1 in modo che sia possibile raccogliere e importare un set di file PST noto a Office 365. Quando si esegue lo strumento PST raccolta nella modalità di blocco, eseguire le operazioni seguenti:</span><span class="sxs-lookup"><span data-stu-id="fd0d5-p126">This optional step lets you "lock down" the PST files that were found in Step 1 so that you can collect and import a known set of PST files to Office 365. When you run the PST Collection tool in the Block mode, the following things happen:</span></span> 
  
- <span data-ttu-id="fd0d5-p127">Lo strumento crea un oggetto di criteri di gruppo (GPO) denominata *Controlli relativi all'utilizzo PST* . Questo oggetto Criteri di gruppo è collegato al dominio e si applica a tutti gli utenti autenticati nell'organizzazione.</span><span class="sxs-lookup"><span data-stu-id="fd0d5-p127">The tool creates a Group Policy Object (GPO) named  *PST Usage Controls*  . This GPO is linked to your domain, and applies to all authenticated users in your organization.</span></span> 
    
- <span data-ttu-id="fd0d5-p128">L'oggetto Criteri di gruppo controlli utilizzo PST crea le impostazioni del Registro di sistema sui computer all'interno dell'organizzazione. In base al parametro utilizzabile, è possibile creare un'impostazione del Registro di sistema per impedire agli utenti di creare nuovi file PST e un'impostazione del Registro di sistema che impedisce agli utenti di modificare i file PST esistenti.</span><span class="sxs-lookup"><span data-stu-id="fd0d5-p128">The PST Usage Controls GPO creates registry settings on machines in your organization. Depending on the parameter that you use, you can create a registry setting to prevent users from creating new PST files and a registry setting that prevents users from changing existing PST files.</span></span>
    
> [!NOTE]
> <span data-ttu-id="fd0d5-p129">Se il controllo dell'accesso ai file PST è troppo eccesso per l'organizzazione, è possibile ignorare questo passaggio ed eseguire il passaggio 3 per copiare i file PST in una posizione centrale. Quindi è possibile ripetere il passaggio 1 del processo stesso (utilizzando il `ForceRestart` parametro) per individuare i file del file pst aggiuntivi che sono stati creati dopo aver copiato i file pst nella posizione di raccolta. Se vengono rilevati nuovi file PST, è possibile copiare nel percorso della raccolta. Quando si utilizza il `ForceRestart` parametro quando si eseguita di nuovo lo strumento in modalità di ricerca, verranno eliminati i risultati da precedente operazione di ricerca di un processo e lo strumento analizza nuovamente i percorsi specificati.</span><span class="sxs-lookup"><span data-stu-id="fd0d5-p129">If controlling access to PST files is too disruptive for your organization, you might consider skipping this step, and performing Step 3 to copy PST files to a central location. Then you can repeat Step 1 for the same job (by using the  `ForceRestart` parameter) to find additional PSTs files that were created after you copied PSTs files to the collection location. If new PST files are found, you can copy them to the collection location. When you use the  `ForceRestart` parameter when you re-run the tool in the Find mode, the results from the previous Find operation for a job will be discarded, and the tool will re-scan the specified locations.</span></span> 

<span data-ttu-id="fd0d5-220">Per bloccare l'accesso ai file PST:</span><span class="sxs-lookup"><span data-stu-id="fd0d5-220">To block access to PST files:</span></span>

1. <span data-ttu-id="fd0d5-221">Aprire un prompt dei comandi (Esegui come amministratore) nel computer locale.</span><span class="sxs-lookup"><span data-stu-id="fd0d5-221">Open a Command Prompt (run as administrator) on your local computer.</span></span>
    
2. <span data-ttu-id="fd0d5-222">Passare alla directory in cui è stato scaricato lo strumento PST insieme a.</span><span class="sxs-lookup"><span data-stu-id="fd0d5-222">Go to the directory where you downloaded the PST Collection tool to.</span></span>
    
3. <span data-ttu-id="fd0d5-223">Eseguire il comando seguente per bloccare l'accesso ai file PST trovato nel passaggio 1.</span><span class="sxs-lookup"><span data-stu-id="fd0d5-223">Run the following command to block access to the PST files found in Step 1.</span></span>

    ```
    DataCollectorMaster.exe -DataSource Pst -Mode Block -JobName <Name of job from Step 1> -ConfigurationLocation <Location of configuration files from Step 1> -BlockChangesToFiles -BlockNewFiles
    ```

    <span data-ttu-id="fd0d5-224">Nella tabella seguente vengono descritti i parametri e i relativi valori necessari quando si esegue il comando DataCollectorMaster.exe per bloccare la creazione e modifica dei file PST.</span><span class="sxs-lookup"><span data-stu-id="fd0d5-224">The following table describes the parameters and their required values when you run the DataCollectorMaster.exe command to block the creation and changing of PST files.</span></span> 
    
    |<span data-ttu-id="fd0d5-225">Parametro \* \* \*</span><span class="sxs-lookup"><span data-stu-id="fd0d5-225">\*\*\*\*Parameter\*\*\*\*</span></span>|<span data-ttu-id="fd0d5-226">\*\*\*\*Description\*\*\*\*</span><span class="sxs-lookup"><span data-stu-id="fd0d5-226">\*\*\*\*Description\*\*\*\*</span></span>|<span data-ttu-id="fd0d5-227">Esempi \* \* \*</span><span class="sxs-lookup"><span data-stu-id="fd0d5-227">\*\*\*\*Examples\*\*\*\*</span></span>|
    |:-----|:-----|:-----|
    | `DataSource` <br/> |<span data-ttu-id="fd0d5-p130">Specifica il tipo di dati da cercare. Attualmente, è possibile utilizzare lo strumento PST raccolta per cercare i file PST.</span><span class="sxs-lookup"><span data-stu-id="fd0d5-p130">Specifies the type of data to search for. Currently, you can use the PST Collection tool to search for PST files.</span></span>  <br/> | `-DataSource Pst` <br/> |
    | `Mode` <br/> |<span data-ttu-id="fd0d5-p131">Specifica il tipo di operazione verrà eseguita. Utilizzare il valore `Block` per impedire agli utenti di creare nuovi file PST e apportare modifiche ai file PST esistenti.</span><span class="sxs-lookup"><span data-stu-id="fd0d5-p131">Specifies the type of operation that the tool will perform. Use the value  `Block` to prevent users from creating new PST files and making changes to existing PST files.  </span></span><br/> | `-Mode Block` <br/> |
    | `JobName` <br/> |<span data-ttu-id="fd0d5-p132">Specifica il nome di un processo di raccolta PST esistente. È necessario utilizzare questo stesso nome di processo utilizzato durante l'esecuzione dello strumento in modalità di ricerca nel passaggio 1. Il nome del processo viene anche aggiunto il nome del file di registro creato quando si esegue lo strumento in modalità di blocco.</span><span class="sxs-lookup"><span data-stu-id="fd0d5-p132">Specifies the name of an existing PST Collection job. You have to use this same job name that you used when you ran the tool in the Find mode in Step 1. This job name is also added to the name of the log file that is created when you run the tool in the Block mode.</span></span>  <br/> | `-JobName PstSearch1` <br/> |
    | `ConfigurationLocation` <br/> |<span data-ttu-id="fd0d5-p133">Specifica che la cartella contenente il file configuration. XML è stato creato durante l'esecuzione dello strumento in modalità di ricerca. Utilizzare lo stesso valore utilizzato per questo parametro nel passaggio 1.</span><span class="sxs-lookup"><span data-stu-id="fd0d5-p133">Specifies the folder contains the .xml configuration file that was created when you ran the tool in the Find mode. Use the same value that you used for this parameter in Step 1.</span></span>  <br/> | `-ConfigurationLocation "c:\users\admin\desktop\PSTCollection\Configuration"` <br/> |
    | `LogLocation` <br/> |<span data-ttu-id="fd0d5-p134">Specifica la cartella in cui verrà copiato il file di registro per l'operazione di blocco. Si tratta di un parametro facoltativo. Se non viene incluso, il file di registro viene copiato nella cartella in cui è stato scaricato lo strumento PST insieme a. È consigliabile utilizzare lo stesso percorso registro utilizzato durante l'esecuzione dello strumento in modalità di ricerca nel passaggio 1 in modo che tutti i file di registro vengono salvati nella stessa cartella.</span><span class="sxs-lookup"><span data-stu-id="fd0d5-p134">Specifies the folder that the log file for the Block operation will be copied to. This is an optional parameter. If you don't include it, the log file is copied to the folder where you downloaded the PST Collection tool to. Consider using the same log location that you used when you ran the tool in the Find mode in Step 1 so that all the log files are saved in the same folder.</span></span>  <br/> | `-LogLocation "c:\users\admin\desktop\PSTCollection"` <br/> |
    | `BlockChangesToFiles` <br/> |<span data-ttu-id="fd0d5-p135">Utilizzare questa opzione per impedire agli utenti di modificare un file PST. Quando si utilizza questa opzione, viene creata la voce del Registro di sistema seguente: `HKEY_CURRENT_USER\Software\Policies\Microsoft\Office\<version>\Outlook\PST\PstDisableGrow` e il valore dei dati è impostato su 1. Questa impostazione del Registro di sistema viene creata in computer all'interno dell'organizzazione per l'oggetto Criteri di gruppo che viene creato quando si esegue lo strumento PST raccolta nella modalità di blocco.</span><span class="sxs-lookup"><span data-stu-id="fd0d5-p135">Use this switch to prevent users from changing a PST file. When you use this switch, the following registry entry is created:  `HKEY_CURRENT_USER\Software\Policies\Microsoft\Office\<version>\Outlook\PST\PstDisableGrow` and the data value is set to 1. This registry setting is created on the machines in your organization by the GPO that's created when you run the PST Collection tool in the Block mode.  </span></span><br/> | `-BlockChangesToFiles` <br/> |
    | `BlockNewFiles` <br/> |<span data-ttu-id="fd0d5-p136">Utilizzare questa opzione per impedire agli utenti di creazione di nuovi file PST, apertura e l'importazione di file PST in Outlook e l'esportazione file PST di Outlook. Quando si utilizza questa opzione, viene creata la voce del Registro di sistema seguente: `HKEY_CURRENT_USER\Software\Policies\Microsoft\Office\<version>\Outlook\DisablePst` e il valore dei dati è impostato su 1. Questa impostazione del Registro di sistema viene creata in computer all'interno dell'organizzazione per l'oggetto Criteri di gruppo che viene creato quando si esegue lo strumento PST raccolta nella modalità di blocco.</span><span class="sxs-lookup"><span data-stu-id="fd0d5-p136">Use this switch to prevent users from creating new PST files, opening and importing PST files to Outlook, and exporting PST files from Outlook. When you use this switch, the following registry entry is created:  `HKEY_CURRENT_USER\Software\Policies\Microsoft\Office\<version>\Outlook\DisablePst` and the data value is set to 1. This registry setting is created on the machines in your organization by the GPO that's created when you run the PST Collection tool in the Block mode.  </span></span><br/> | `-BlockNewFiles` <br/> |
   
    <span data-ttu-id="fd0d5-247">Ecco un esempio di sintassi per il comando DataCollectorMaster.exe utilizzando i valori effettivi per ogni parametro:</span><span class="sxs-lookup"><span data-stu-id="fd0d5-247">Here's an example of the syntax for the DataCollectorMaster.exe command using actual values for each parameter:</span></span>

    ```
    DataCollectorMaster.exe -DataSource Pst -Mode Block -JobName PstSearch1 -ConfigurationLocation "c:\users\admin\desktop\PSTCollection\Configuration" -LogLocation "c:\users\admin\desktop\PSTCollection" -BlockChangesToFiles -BlockNewFiles
    ```
    
    <span data-ttu-id="fd0d5-p137">Viene chiesto di confermare che si desidera bloccare nuovi file PST o le modifiche apportate al file PST esistenti. Dopo avere verificato che si desidera continuare e il comando viene eseguito correttamente, verrà visualizzato un messaggio che informa che è stato creato un nuovo oggetto Criteri di gruppo, denominato "PST sull'utilizzo di controlli".</span><span class="sxs-lookup"><span data-stu-id="fd0d5-p137">You are prompted to confirm that you want to block new PST files or changes to existing PST files. After you confirm that you want to continue and the command successfully runs, a message is displayed saying that a new GPO, named "PST Usage Controls", has been created.</span></span>
    
## <a name="step-3-copy-the-pst-files-to-a-collection-location"></a><span data-ttu-id="fd0d5-250">Passaggio 3: Copiare i file PST in un percorso raccolta</span><span class="sxs-lookup"><span data-stu-id="fd0d5-250">Step 3: Copy the PST files to a collection location</span></span>

<span data-ttu-id="fd0d5-p138">Il passaggio successivo consiste nel copiare i file PST di file che dove trovare quando è stato eseguito lo strumento PST raccolta nella modalità di ricerca. Consente di raccogliere i file PST in un'unica posizione, in modo che è possibile importare in seguito a Office 365. Prima di copiare i file PST in percorso raccolta, prendere in considerazione per determinare la quantità totale di spazio di archiviazione è obbligatorio. È possibile ottenere questo risultato utilizzando il file CSV creato nel passaggio 1 per calcolare la dimensione totale di tutti i file PST.</span><span class="sxs-lookup"><span data-stu-id="fd0d5-p138">The next step is to copy the PST files that where found when you ran the PST Collection tool in the Find mode. This lets you collect the PST files in one location so that you can later import them to Office 365. Before you copy the PST files to collection location, consider determining the total amount of storage space that is required. You can do this using the CSV file that was created in Step 1 to calculate the total size of all PST files.</span></span>
  
> [!NOTE]
> <span data-ttu-id="fd0d5-255">Dopo aver importato i file PST in Office 365 e sono stati eliminati dal percorso originale, è possibile eliminarli dalla posizione insieme sono stati copiati per questo passaggio.</span><span class="sxs-lookup"><span data-stu-id="fd0d5-255">After you've imported the PST files to Office 365 and deleted them from their original location, you might want to delete them from the collection location that you copied them to in this step.</span></span> 
  
1. <span data-ttu-id="fd0d5-256">Aprire un prompt dei comandi (Esegui come amministratore) nel computer locale.</span><span class="sxs-lookup"><span data-stu-id="fd0d5-256">Open a Command Prompt (run as administrator) on your local computer.</span></span>
    
2. <span data-ttu-id="fd0d5-257">Passare alla directory in cui è stato scaricato lo strumento PST insieme a.</span><span class="sxs-lookup"><span data-stu-id="fd0d5-257">Go to the directory where you downloaded the PST Collection tool to.</span></span>
    
3. <span data-ttu-id="fd0d5-258">Eseguire il comando seguente per copiare i file PST in un percorso specificato.</span><span class="sxs-lookup"><span data-stu-id="fd0d5-258">Run the following command to copy the PST files to a specified location.</span></span>
    
    ```
    DataCollectorMaster.exe -DataSource Pst -Mode Collect -JobName <Name of job from Step 1> -Locations <same locations from Step 1> -ConfigurationLocation <Location of configuration files from Step 1> -CopyLocation <Location to copy PST files to>
    ```

    <span data-ttu-id="fd0d5-259">Nella tabella seguente vengono descritti i parametri e i relativi valori necessari quando si esegue il comando DataCollectorMaster.exe per copiare i file PST.</span><span class="sxs-lookup"><span data-stu-id="fd0d5-259">The following table describes the parameters and their required values when you run the DataCollectorMaster.exe command to copy PST files.</span></span> 
    
    |<span data-ttu-id="fd0d5-260">Parametro \* \* \*</span><span class="sxs-lookup"><span data-stu-id="fd0d5-260">\*\*\*\*Parameter\*\*\*\*</span></span>|<span data-ttu-id="fd0d5-261">\*\*\*\*Description\*\*\*\*</span><span class="sxs-lookup"><span data-stu-id="fd0d5-261">\*\*\*\*Description\*\*\*\*</span></span>|<span data-ttu-id="fd0d5-262">Esempi \* \* \*</span><span class="sxs-lookup"><span data-stu-id="fd0d5-262">\*\*\*\*Examples\*\*\*\*</span></span>|
    |:-----|:-----|:-----|
    | `DataSource` <br/> |<span data-ttu-id="fd0d5-p139">Specifica il tipo di dati da cercare. Attualmente, è possibile utilizzare lo strumento PST raccolta per cercare i file PST.</span><span class="sxs-lookup"><span data-stu-id="fd0d5-p139">Specifies the type of data to search for. Currently, you can use the PST Collection tool to search for PST files.</span></span>  <br/> | `-DataSource Pst` <br/> |
    | `Mode` <br/> |<span data-ttu-id="fd0d5-p140">Specifica il tipo di operazione verrà eseguita. Utilizzare il valore `Collect` per copiare che i file PST che sono state trovate al momento dell'esecuzione per lo strumento in modalità di ricerca. Si noti che lo strumento è in grado di copiare i file di file PST aperti in Outlook e copiare i file PST connessi ai profili di Outlook.</span><span class="sxs-lookup"><span data-stu-id="fd0d5-p140">Specifies the type of operation that the tool will perform. Use the value  `Collect` to copy that PST files that were found when you ran to the tool in the Find mode. Note that the tool is able copy PST files that are open in Outlook and copy PST files that are connected to Outlook profiles.  </span></span><br/> | `-Mode Collect` <br/> |
    | `JobName` <br/> |<span data-ttu-id="fd0d5-p141">Specifica il nome di un processo di raccolta PST esistente. È necessario utilizzare questo stesso nome di processo utilizzato durante l'esecuzione dello strumento in modalità di ricerca nel passaggio 1. Il nome del processo viene anche aggiunto il nome del file di registro creato quando si esegue lo strumento in modalità di raccolta.</span><span class="sxs-lookup"><span data-stu-id="fd0d5-p141">Specifies the name of an existing PST Collection job. You have to use this same job name that you used when you ran the tool in the Find mode in Step 1. This job name is also added to the name of the log file that is created when you run the tool in the Collect mode.</span></span>  <br/> | `-JobName PstSearch1` <br/> |
    | `Locations` <br/> |<span data-ttu-id="fd0d5-p142">Utilizzare lo stesso valore utilizzato per il `Locations` parametro nel passaggio 1. Si dispone include questo parametro quando si esegue lo strumento in modalità Collect se si desidera eseguire di nuovo lo strumento per eliminare i file PST dal percorso di origine nel passaggio 5.</span><span class="sxs-lookup"><span data-stu-id="fd0d5-p142">Use the same value that you used for the  `Locations` parameter in Step 1. You have include this parameter when you run the tool in the Collect mode if you want to re-run the tool to delete the PST files from their source location in Step 5.  </span></span><br/> | `-Locations "CN=FILESERVER01,CN=Computers,DC=contoso,DC=com"; "CN=FILESERVER02,CN=Computers,DC=contoso,DC=com"` <br/> |
    | `ConfigurationLocation` <br/> |<span data-ttu-id="fd0d5-p143">Specifica la cartella che contiene il file di configurazione XML che è stato creato durante l'esecuzione dello strumento in modalità di ricerca. Utilizzare lo stesso valore utilizzato per questo parametro nel passaggio 1.</span><span class="sxs-lookup"><span data-stu-id="fd0d5-p143">Specifies the folder that contains the .xml configuration file that was created when you ran the tool in the Find mode. Use the same value that you used for this parameter in Step 1.</span></span>  <br/> | `-ConfigurationLocation "c:\users\admin\desktop \PSTCollection\Configuration"` <br/> |
    | `CopyLocation` <br/> |<span data-ttu-id="fd0d5-p144">Specifica il percorso raccolta in cui si desidera copiare i file PST. È possibile copiare i file per un file server, una condivisione di file di rete o un disco rigido. Il percorso deve esistere prima di eseguire lo strumento in modalità di raccolta. Lo strumento non crea il percorso e restituirà un errore indicante che non esiste.</span><span class="sxs-lookup"><span data-stu-id="fd0d5-p144">Specifies the collection location where you want to copy the PST files to. You can copy files to a file server, a network file share, or a hard drive. The location must exist before you run the tool in the Collect mode. The tool doesn't create the location, and will return an error saying that it doesn't exist.</span></span>  <br/> <span data-ttu-id="fd0d5-279">Inoltre, è necessario scrivere le autorizzazioni nel percorso di insieme specificato da questo parametro.</span><span class="sxs-lookup"><span data-stu-id="fd0d5-279">Also, you have to write permissions to the collection location specified by this parameter.</span></span>  <br/> | `-CopyLocation "\\FILESERVER03\PSTs"` <br/> |
    | `LogLocation` <br/> |<span data-ttu-id="fd0d5-p145">Specifica la cartella in cui verrà copiato il file di registro per la modalità di raccolta. Si tratta di un parametro facoltativo. Se non viene incluso, il file di registro viene copiato nella cartella in cui è stato scaricato lo strumento PST insieme a. È consigliabile utilizzare lo stesso percorso registro utilizzato durante l'esecuzione dello strumento in modalità di ricerca nel passaggio 1 in modo che tutti i file di registro vengono salvati nella stessa cartella.</span><span class="sxs-lookup"><span data-stu-id="fd0d5-p145">Specifies the folder that the log file for the Collect mode will be copied to. This is an optional parameter. If you don't include it, the log file is copied to the folder where you downloaded the PST Collection tool to. Consider using the same log location that you used when you ran the tool in the Find mode in Step 1 so that all the log files are saved in the same folder.</span></span>  <br/> | `-LogLocation "c:\users\admin\desktop\PSTCollection"` <br/> |
    | `ForceRestart` <br/> |<span data-ttu-id="fd0d5-p146">Questo parametro opzionale consente di eseguire di nuovo lo strumento in modalità di raccolta per un processo di raccolta PST esistente. Se già stato eseguito lo strumento in modalità di raccolta, ma quindi eseguito nuovamente lo strumento in modalità di ricerca con il `ForceRestart` opzione per eseguire nuovamente l'analisi percorsi per i file PST, è possibile utilizzare questa opzione per eseguire di nuovo lo strumento in modalità di raccolta e nuovamente copiare i file PST non vi sono stati trovati quando il ripetizione dell'analisi le posizioni. Quando si utilizza il `ForceRestart` opzione in modalità di raccolta, lo strumento di ignorare eventuali operazioni insieme precedente e tenta di copiare i file PST da zero.</span><span class="sxs-lookup"><span data-stu-id="fd0d5-p146">This optional switch lets you re-run the tool in the Collection mode for an existing PST Collection job. If you previously ran the tool in the Collect mode, but then ran the tool again in the Find mode with the  `ForceRestart` switch to re-scan locations for PST files, you can use this switch to re-run the tool in Collection mode and re-copy the PST files there were found when your re-scanned the locations. When using the  `ForceRestart` switch in Collection mode, the tool ignores any previous Collection operations and attempts to copy the PST files from scratch.  </span></span><br/> | `-ForceRestart` <br/> |
   
    <span data-ttu-id="fd0d5-287">Ecco un esempio di sintassi per lo strumento DataCollectorMaster.exe utilizzando i valori effettivi per ogni parametro:</span><span class="sxs-lookup"><span data-stu-id="fd0d5-287">Here's an example of the syntax for the DataCollectorMaster.exe tool using actual values for each parameter:</span></span>
    
    ```
    DataCollectorMaster.exe -DataSource Pst -Mode Collect -JobName PstSearch1 -Locations "CN=FILESERVER01,CN=Computers,DC=contoso,DC=com";"CN=FILESERVER02,CN=Computers,DC=contoso,DC=com" -ConfigurationLocation "c:\users\admin\desktop\PSTCollection\Configuration" -CopyLocation "\\FILESERVER03\PSTs" -LogLocation "c:\users\admin\desktop\PSTCollection"
    ```

    <span data-ttu-id="fd0d5-p147">Dopo aver eseguito il comando, vengono visualizzati messaggi di stato dettagliato che mostrano lo stato di avanzamento di raggruppare i file PST che sono stati trovati nel passaggio 1. Dopo un po' di tempo, verrà visualizzato un messaggio di stato finale se si sono gli eventuali errori e percorso in cui viene copiato nel registro. Il file di log vengono copiati gli stessi messaggi di stato.</span><span class="sxs-lookup"><span data-stu-id="fd0d5-p147">After you run the command, detailed status messages are displayed that show the progress of collecting the PST files that were found in Step 1. After a while, a final status message shows if there were any errors and the location that the log is copied to. The same status messages are copied to the .log file.</span></span>
    
### <a name="results-of-running-datacollectormasterexe-in-the-collect-mode"></a><span data-ttu-id="fd0d5-291">Risultati dell'esecuzione DataCollectorMaster.exe nella modalità di raccolta</span><span class="sxs-lookup"><span data-stu-id="fd0d5-291">Results of running DataCollectorMaster.exe in the Collect mode</span></span>

<span data-ttu-id="fd0d5-292">Dopo aver eseguito DataCollectorMaster.exe nella modalità di raccolta, i file seguenti vengono creati e memorizzati nelle cartelle specificate per il `LogLocation` e `ConfigurationLocation` parametri.</span><span class="sxs-lookup"><span data-stu-id="fd0d5-292">After you successfully run DataCollectorMaster.exe in the Collect mode, the following files are created and stored in the folders specified by the  `LogLocation` and  `ConfigurationLocation` parameters.</span></span> 
  
- <span data-ttu-id="fd0d5-p148">**\<Specificare nome di processo\>_raccogliere_\<DateTimeStamp\>. log** -il file di registro contiene i messaggi di stato che sono stati visualizzati. Questo file viene creato nella cartella specificata per il `LogLocation` parametro.</span><span class="sxs-lookup"><span data-stu-id="fd0d5-p148">**\<JobName\>_Collect_\<DateTimeStamp\>.log** - The log file contains the status messages that were displayed. This file is created in the folder specified by the  `LogLocation` parameter.</span></span> 
    
- <span data-ttu-id="fd0d5-p149">**\<Specificare nome di processo\>_raccogliere_\<DateTimeStamp\>. XML** -il file XML contiene solo le informazioni sui valori dei parametri dove usato per lo strumento è stato eseguito nella modalità di raccolta. I dati in questo file viene utilizzati quando si esegue lo strumento DataCollectorMaster.exe per eliminare i file PST, eseguire di nuovo vedere [il passaggio 5](#step-5-delete-the-pst-files-found-on-your-network).</span><span class="sxs-lookup"><span data-stu-id="fd0d5-p149">**\<JobName\>_Collect_\<DateTimeStamp\>.xml** - The XML file only contains information about the parameter values that where used by the tool was run in the Collect mode. The data in this file is used when you run re-run the DataCollectorMaster.exe tool to delete PST files; see [Step 5](#step-5-delete-the-pst-files-found-on-your-network).</span></span>
    

## <a name="step-4-import-the-pst-files-to-office-365"></a><span data-ttu-id="fd0d5-297">Passaggio 4: Importare i file PST in Office 365</span><span class="sxs-lookup"><span data-stu-id="fd0d5-297">Step 4: Import the PST files to Office 365</span></span>

<span data-ttu-id="fd0d5-p150">Dopo aver raccolto i file PST trovati nel passaggio 1, il passaggio successivo consiste nel importarli alle cassette postali in Office 365. Come parte o il processo di importazione, sarà necessario creare un file di mapping CSV che contiene una riga di ogni file PST che si desidera importare. Informazioni di ogni riga specifica il nome del file PST, indirizzo di posta elettronica dell'utente e se si desidera importare il file PST all'utente principale o archiviazione delle cassette postali. Utilizzare le informazioni contenute nel **specificare nome di processo\>_trovare_\<DateTimeStamp.csv** file (creati al passaggio) 1 che consentono di creare il file di mapping CSV.</span><span class="sxs-lookup"><span data-stu-id="fd0d5-p150">After you've collected the PST files found in Step 1, the next step is to import them to mailboxes in Office 365. As part or the import process, you'll have to create a CSV mapping file that contains a row of each PST file that you want import. Information in each row specifies the name of the PST file, the user's email address, and whether you want to import the PST file to the user's primary or archive mailbox. Use the information in the **JobName\>_Find_\<DateTimeStamp.csv** file (created in Step) 1 to help you create the CSV mapping file.</span></span> 
  
<span data-ttu-id="fd0d5-302">Per istruzioni dettagliate importare i file PST a Office 365, vedere uno degli argomenti seguenti:</span><span class="sxs-lookup"><span data-stu-id="fd0d5-302">For step-by-step instructions to import PST files to Office 365, see one of the following topics:</span></span>
  
- [<span data-ttu-id="fd0d5-303">Utilizzare il caricamento di rete per importare i file PST su Office 365</span><span class="sxs-lookup"><span data-stu-id="fd0d5-303">Use network upload to import PST files to Office 365</span></span>](use-network-upload-to-import-pst-files.md)
    
- [<span data-ttu-id="fd0d5-304">Utilizzare la spedizione dell'unità per importare file PST in Office 365</span><span class="sxs-lookup"><span data-stu-id="fd0d5-304">Use drive shipping to import PST files to Office 365</span></span>](use-drive-shipping-to-import-pst-files-to-office-365.md)
    

## <a name="step-5-delete-the-pst-files-found-on-your-network"></a><span data-ttu-id="fd0d5-305">Passaggio 5: Eliminare i file PST trovati nella rete</span><span class="sxs-lookup"><span data-stu-id="fd0d5-305">Step 5: Delete the PST files found on your network</span></span>

<span data-ttu-id="fd0d5-306">Dopo aver importati i file PST che è stato individuato e raccolti alle cassette postali di Exchange Online in Office 365, è possibile utilizzare lo strumento PST raccolta per eliminare i file PST dai percorsi di origine originale dove sono state trovate nel passaggio 1.</span><span class="sxs-lookup"><span data-stu-id="fd0d5-306">After the PST files that you found and collected have been imported to Exchange Online mailboxes in Office 365, you can use the PST Collection tool to delete the PST files from the original source locations where they were found in Step 1.</span></span> 
  
1. <span data-ttu-id="fd0d5-307">Aprire un prompt dei comandi (Esegui come amministratore) nel computer locale.</span><span class="sxs-lookup"><span data-stu-id="fd0d5-307">Open a Command Prompt (run as administrator) on your local computer.</span></span>
    
2. <span data-ttu-id="fd0d5-308">Passare alla directory in cui è stato scaricato lo strumento PST insieme a.</span><span class="sxs-lookup"><span data-stu-id="fd0d5-308">Go to the directory where you downloaded the PST Collection tool to.</span></span>
    
3. <span data-ttu-id="fd0d5-309">Eseguire il comando seguente per eliminare i file PST.</span><span class="sxs-lookup"><span data-stu-id="fd0d5-309">Run the following command to delete the PST files.</span></span>

    ```
    DataCollectorMaster.exe -DataSource Pst -Mode Delete -JobName <Name of job from Step 1> -ConfigurationLocation <Location of configuration files from Step 1> -CopyLocation <Location to copy PST files to>
    ```

    <span data-ttu-id="fd0d5-310">Nella tabella seguente vengono descritti i parametri e i relativi valori necessari quando si esegue il comando DataCollectorMaster.exe per eliminare i file PST.</span><span class="sxs-lookup"><span data-stu-id="fd0d5-310">The following table describes the parameters and their required values when you run the DataCollectorMaster.exe command to delete PST files.</span></span> 
    
    |<span data-ttu-id="fd0d5-311">Parametro \* \* \*</span><span class="sxs-lookup"><span data-stu-id="fd0d5-311">\*\*\*\*Parameter\*\*\*\*</span></span>|<span data-ttu-id="fd0d5-312">\*\*\*\*Description\*\*\*\*</span><span class="sxs-lookup"><span data-stu-id="fd0d5-312">\*\*\*\*Description\*\*\*\*</span></span>|<span data-ttu-id="fd0d5-313">Esempi \* \* \*</span><span class="sxs-lookup"><span data-stu-id="fd0d5-313">\*\*\*\*Examples\*\*\*\*</span></span>|
    |:-----|:-----|:-----|
    | `DataSource` <br/> |<span data-ttu-id="fd0d5-p151">Specifica il tipo di dati da cercare. Attualmente, è possibile utilizzare lo strumento PST raccolta per cercare i file PST.</span><span class="sxs-lookup"><span data-stu-id="fd0d5-p151">Specifies the type of data to search for. Currently, you can use the PST Collection tool to search for PST files.</span></span> ![spaziatore](media/b078d05c-3aee-4b9f-8805-6a8a9d8970ee.png)           <br/> | `-DataSource Pst` <br/> |
    | `Mode` <br/> |<span data-ttu-id="fd0d5-p152">Specifica il tipo di operazione verrà eseguita. Utilizzare il valore `Delete` da eliminare che i file PST che sono state trovate al momento dell'esecuzione per lo strumento in modalità di ricerca.</span><span class="sxs-lookup"><span data-stu-id="fd0d5-p152">Specifies the type of operation that the tool will perform. Use the value  `Delete` to delete that PST files that were found when you ran to the tool in the Find mode.  </span></span><br/> | `-Mode Delete` <br/> |
    | `JobName` <br/> |<span data-ttu-id="fd0d5-p153">Specifica il nome di un processo di raccolta PST esistente. È necessario utilizzare questo stesso nome di processo utilizzato durante l'esecuzione dello strumento in modalità Trova e la raccolta nel passaggio 1 e passaggio 3. Il nome del processo viene anche aggiunto il nome del file di registro creato quando si esegue lo strumento in modalità di eliminazione.</span><span class="sxs-lookup"><span data-stu-id="fd0d5-p153">Specifies the name of an existing PST Collection job. You have to use this same job name that you used when you ran the tool in the Find mode and the Collect mode in Step 1 and Step 3. This job name is also added to the name of the log file that is created when you run the tool in the Delete mode.</span></span>  <br/> | `-JobName PstSearch1` <br/> |
    | `ConfigurationLocation` <br/> |<span data-ttu-id="fd0d5-p154">Specifica la cartella che contiene il file di configurazione XML che è stato creato durante l'esecuzione dello strumento in modalità di raccolta. Utilizzare lo stesso valore utilizzato per questo parametro nel passaggio 3.</span><span class="sxs-lookup"><span data-stu-id="fd0d5-p154">Specifies the folder that contains the .xml configuration file that was created when you ran the tool in the Collect mode. Use the same value that you used for this parameter in Step 3.</span></span>  <br/> | `-ConfigurationLocation "c:\users\admin\ desktop\PSTCollection\Configuration"` <br/> |
    | `LogLocation` <br/> |<span data-ttu-id="fd0d5-p155">Specifica la cartella in cui verrà copiato il file di registro per la modalità di eliminazione. Si tratta di un parametro facoltativo. Se non viene incluso, il file di registro viene copiato nella cartella in cui è stato scaricato lo strumento PST insieme a. È consigliabile utilizzare lo stesso percorso registro utilizzato durante l'esecuzione dello strumento Trova e modalità di raccogliere in passaggio 1 e passaggio 3 in modo che tutti i file di registro vengono salvati nella stessa cartella.</span><span class="sxs-lookup"><span data-stu-id="fd0d5-p155">Specifies the folder that the log file for the Delete mode will be copied to. This is an optional parameter. If you don't include it, the log file is copied to the folder where you downloaded the PST Collection tool to. Consider using the same log location that you used when you ran the tool in the Find and Collect modes in Step 1 and Step 3 so that all the log files are saved in the same folder.</span></span>  <br/> | `-LogLocation "c:\users\admin\desktop\PSTCollection"` <br/> |
    | `ForceRestart` <br/> |<span data-ttu-id="fd0d5-p156">Questo parametro opzionale consente di eseguire di nuovo lo strumento in modalità di eliminazione per un processo di raccolta PST esistente. Se già stato eseguito lo strumento in modalità di eliminazione, ma quindi eseguito nuovamente lo strumento in modalità di ricerca con il `ForceRestart` opzione per eseguire nuovamente l'analisi percorsi per i file PST, è possibile utilizzare questa opzione per eseguire di nuovo lo strumento in modalità di eliminazione ed eliminare i file PST non vi sono stati trovati quando il sca r nned le posizioni. Quando si utilizza il `ForceRestart` opzione in modalità di eliminazione, lo strumento di ignorare eventuali operazioni di eliminazione precedente e tenta di eliminare i file PST nuovamente.</span><span class="sxs-lookup"><span data-stu-id="fd0d5-p156">This optional switch lets you re-run the tool in the Delete mode for an existing PST Collection job. If you previously ran the tool in the Delete mode, but then ran the tool again in the Find mode with the  `ForceRestart` switch to re-scan locations for PST files, you can use this switch to re-run the tool in Delete mode and delete the PST files there were found when your re-scanned the locations. When using the  `ForceRestart` switch in Delete mode, the tool ignores any previous Delete operations and attempts to delete the PST files again.  </span></span><br/> | `-ForceRestart` <br/> 

    <span data-ttu-id="fd0d5-331">Ecco un esempio di sintassi per lo strumento DataCollectorMaster.exe utilizzando i valori effettivi per ogni parametro:</span><span class="sxs-lookup"><span data-stu-id="fd0d5-331">Here's an example of the syntax for the DataCollectorMaster.exe tool using actual values for each parameter:</span></span>
    
    ```
    DataCollectorMaster.exe -DataSource Pst -Mode Delete -JobName PstSearch1 -ConfigurationLocation "c:\users\admin\desktop\PSTCollection\Configuration" -LogLocation "c:\users\admin\desktop\PSTCollection"
    ```
   
    <span data-ttu-id="fd0d5-p157">Dopo aver eseguito il comando, vengono visualizzati messaggi di stato dettagliato che mostrano lo stato di eliminazione dei file PST che sono stati trovati nel passaggio 1 e raccolte nel passaggio 3. Dopo un po' di tempo, verrà visualizzato un messaggio di stato finale se si sono gli eventuali errori e percorso in cui viene copiato nel registro. Il file di log vengono copiati gli stessi messaggi di stato.</span><span class="sxs-lookup"><span data-stu-id="fd0d5-p157">After you run the command, detailed status messages are displayed that show the progress of deleting the PST files that were found in Step 1 and collected in Step 3. After a while, a final status message shows if there were any errors and the location that the log is copied to. The same status messages are copied to the .log file.</span></span>
    
### <a name="results-of-running-datacollectormasterexe-in-the-delete-mode"></a><span data-ttu-id="fd0d5-335">Risultati dell'esecuzione DataCollectorMaster.exe in modalità di eliminazione</span><span class="sxs-lookup"><span data-stu-id="fd0d5-335">Results of running DataCollectorMaster.exe in the Delete mode</span></span>

<span data-ttu-id="fd0d5-336">Dopo aver eseguito DataCollectorMaster.exe in modalità di eliminazione, i file seguenti vengono creati e archiviati nella cartella specificata per il `LogLocation` e `ConfigurationLocation` parametri.</span><span class="sxs-lookup"><span data-stu-id="fd0d5-336">After you successfully run DataCollectorMaster.exe in the Delete mode, the following files are created and stored in the folder specified by the  `LogLocation` and  `ConfigurationLocation` parameters.</span></span> 
  
- <span data-ttu-id="fd0d5-p158">**\<Specificare nome di processo\>_eliminare_\<DateTimeStamp\>. log** -il file di registro contiene i messaggi di stato che sono stati visualizzati. Questo file viene creato nella cartella specificata per il `LogLocation` parametro.</span><span class="sxs-lookup"><span data-stu-id="fd0d5-p158">**\<JobName\>_Delete_\<DateTimeStamp\>.log** - The log file contains the status messages that were displayed. This file is created in the folder specified by the  `LogLocation` parameter.</span></span> 
    
- <span data-ttu-id="fd0d5-p159">**\<Specificare nome di processo\>_eliminare_\<DateTimeStamp\>. XML** -il file XML contiene solo le informazioni sui valori dei parametri dove usato per lo strumento è stato eseguito in modalità di eliminazione. Vengono inoltre elencati il nome e il percorso di ogni file PST che è stato eliminato. Questo file viene creato nella cartella specificata per il `ConfigurationLocation` parametro.</span><span class="sxs-lookup"><span data-stu-id="fd0d5-p159">**\<JobName\>_Delete_\<DateTimeStamp\>.xml** - The XML file only contains information about the parameter values that where used by the tool was run in the Delete mode. It also lists the name and file path of each PST file that was deleted. This file is created in the folder specified by the  `ConfigurationLocation` parameter.</span></span> 
