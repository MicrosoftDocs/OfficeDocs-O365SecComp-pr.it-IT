---
title: Controllare la condivisione per identificare risorse condivise con utenti esterni
ms.author: markjjo
author: markjjo
manager: laurawi
ms.date: ''
audience: Admin
ms.topic: article
ms.service: O365-seccomp
localization_priority: Normal
search.appverid:
- SPO160
- MOE150
- BCS160
- MET150
ms.collection: M365-security-compliance
ms.assetid: 50bbf89f-7870-4c2a-ae14-42635e0cfc01
description: "La condivisione è un'attività chiave in SharePoint Online e OneDrive for business. Gli amministratori possono ora utilizzare il controllo di condivisione nel log di controllo di Office 365 per identificare le risorse condivise con gli utenti esterni all'organizzazione. "
ms.openlocfilehash: 48fc1a67f501c807e76ba2333170df83a1248428
ms.sourcegitcommit: 60c701e9808d505cf96990d0643be10b8fbc0180
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 08/16/2019
ms.locfileid: "36447363"
---
# <a name="use-sharing-auditing-in-the-office-365-audit-log"></a><span data-ttu-id="b19a0-104">Controllare la condivisione per identificare risorse condivise con utenti esterni</span><span class="sxs-lookup"><span data-stu-id="b19a0-104">Use sharing auditing in the Office 365 audit log</span></span>

<span data-ttu-id="b19a0-105">La condivisione è un'attività chiave in SharePoint Online e OneDrive for business ed è ampiamente utilizzata nelle organizzazioni di Office 365.</span><span class="sxs-lookup"><span data-stu-id="b19a0-105">Sharing is a key activity in SharePoint Online and OneDrive for Business, and it's widely used in Office 365 organizations.</span></span> <span data-ttu-id="b19a0-106">Gli amministratori possono utilizzare il controllo di condivisione nel log di controllo di Office 365 per determinare in che modo viene utilizzata la condivisione nell'organizzazione.</span><span class="sxs-lookup"><span data-stu-id="b19a0-106">Administrators can use sharing auditing in the Office 365 audit log to determine how sharing is used in their organization.</span></span> 
  
## <a name="the-sharepoint-sharing-schema"></a><span data-ttu-id="b19a0-107">Lo schema di condivisione di SharePoint</span><span class="sxs-lookup"><span data-stu-id="b19a0-107">The SharePoint Sharing schema</span></span>

<span data-ttu-id="b19a0-108">La condivisione di eventi (esclusi gli eventi relativi al criterio di condivisione e ai collegamenti di condivisione) è diversa dagli eventi relativi a file e cartelle in un unico modo principale: un utente sta eseguendo un'azione che ha effetto su un altro utente.</span><span class="sxs-lookup"><span data-stu-id="b19a0-108">Sharing events (not including events related to sharing policy and sharing links) are different from file- and folder-related events in one primary way: one user is performing an action that has an effect on another user.</span></span> <span data-ttu-id="b19a0-109">Ad esempio, quando un utente di risorse A fornisce all'utente B l'accesso a un file.</span><span class="sxs-lookup"><span data-stu-id="b19a0-109">For example, when a resource User A gives User B access to a file.</span></span> <span data-ttu-id="b19a0-110">In questo esempio, l'utente A rappresenta l'utente che *agisce* e l'utente B è l' *utente di destinazione*.</span><span class="sxs-lookup"><span data-stu-id="b19a0-110">In this example, User A is the  *acting user*  and User B is the  *target user*.</span></span> <span data-ttu-id="b19a0-111">Nello schema dei file di SharePoint, l'azione dell'utente che agisce ha effetto solo sul file stesso.</span><span class="sxs-lookup"><span data-stu-id="b19a0-111">In the SharePoint File schema, the acting user's action only affects the file itself.</span></span> <span data-ttu-id="b19a0-112">Quando un utente apre un file, le uniche informazioni necessarie per l' \*\*\*\* evento fileaccessed sono gli utenti che agiscono.</span><span class="sxs-lookup"><span data-stu-id="b19a0-112">When User A opens a file, the only information needed in the **FileAccessed** event is the acting user.</span></span> <span data-ttu-id="b19a0-113">Per risolvere questa differenza, è disponibile uno schema distinto, denominato *schema di condivisione di SharePoint*, che acquisisce ulteriori informazioni sulla condivisione degli eventi.</span><span class="sxs-lookup"><span data-stu-id="b19a0-113">To address this difference, there is a separate schema, called the  *SharePoint Sharing schema*, that captures more information about sharing events.</span></span> <span data-ttu-id="b19a0-114">In questo modo gli amministratori avranno la visibilità su chi ha condiviso una risorsa e l'utente con cui è stata condivisa la risorsa.</span><span class="sxs-lookup"><span data-stu-id="b19a0-114">This ensures that administrators have visibility into who shared a resource and the user the resource was shared with.</span></span> 
  
<span data-ttu-id="b19a0-115">Nello schema di condivisione sono disponibili due campi aggiuntivi in un record di controllo relativo agli eventi di condivisione:</span><span class="sxs-lookup"><span data-stu-id="b19a0-115">The Sharing schema provides two additional fields in an audit record related to sharing events:</span></span> 
  
- <span data-ttu-id="b19a0-116">**TargetUserOrGroupType:** Identifica se l'utente o il gruppo di destinazione è membro, Guest, SharePointGroup, SecurityGroup o partner.</span><span class="sxs-lookup"><span data-stu-id="b19a0-116">**TargetUserOrGroupType:** Identifies whether the target user or group is a Member, Guest, SharePointGroup, SecurityGroup, or Partner.</span></span>

- <span data-ttu-id="b19a0-117">**TargetUserOrGroupName:** Archivia l'UPN o il nome dell'utente o del gruppo di destinazione a cui è stata condivisa una risorsa (utente B nell'esempio precedente).</span><span class="sxs-lookup"><span data-stu-id="b19a0-117">**TargetUserOrGroupName:** Stores the UPN or name of the target user or group that a resource was shared with (User B in the previous example).</span></span> 

<span data-ttu-id="b19a0-118">Questi due campi, oltre ad altre proprietà dallo schema del registro di controllo di Office 365, ad esempio l'utente, l'operazione e la data, possono \*\* raccontare la storia \*\* completa dell'utente che ha condiviso la risorsa con *chi* e *quando*.</span><span class="sxs-lookup"><span data-stu-id="b19a0-118">These two fields, in addition to other properties from the Office 365 audit log schema such as User, Operation, and Date can tell the full story about  *which*  user shared  *what*  resource with  *whom*  and  *when*.</span></span> 
  
<span data-ttu-id="b19a0-119">È presente un'altra proprietà dello schema che è importante per la storia della condivisione.</span><span class="sxs-lookup"><span data-stu-id="b19a0-119">There's another schema property that's important to the sharing story.</span></span> <span data-ttu-id="b19a0-120">Quando si esportano i risultati della ricerca dei log di controllo, la colonna **AuditData** nel file CSV esportato Archivia le informazioni sugli eventi di condivisione.</span><span class="sxs-lookup"><span data-stu-id="b19a0-120">When you export audit log search results, the **AuditData** column in the exported CSV file stores information about sharing events.</span></span> <span data-ttu-id="b19a0-121">Ad esempio, quando un utente condivide un sito con un altro utente, questo viene ottenuto aggiungendo l'utente di destinazione a un gruppo di SharePoint.</span><span class="sxs-lookup"><span data-stu-id="b19a0-121">For example, when a user shares a site with another user, this is accomplished by adding the target user to a SharePoint group.</span></span> <span data-ttu-id="b19a0-122">La colonna **AuditData** acquisisce queste informazioni per fornire il contesto per gli amministratori.</span><span class="sxs-lookup"><span data-stu-id="b19a0-122">The **AuditData** column captures this information to provide context for administrators.</span></span> <span data-ttu-id="b19a0-123">Per istruzioni su come analizzare le informazioni nella colonna **AuditData** , vedere il [passaggio 2](#step-2-use-the-powerquery-editor-to-format-the-exported-audit-log) .</span><span class="sxs-lookup"><span data-stu-id="b19a0-123">See [Step 2](#step-2-use-the-powerquery-editor-to-format-the-exported-audit-log) for instructions on how to parse the information in the **AuditData** column.</span></span>

## <a name="sharepoint-sharing-events"></a><span data-ttu-id="b19a0-124">Eventi di condivisione di SharePoint</span><span class="sxs-lookup"><span data-stu-id="b19a0-124">SharePoint sharing events</span></span>

<span data-ttu-id="b19a0-125">La condivisione è definita da quando un utente (l'utente che *agisce* ) desidera condividere una risorsa con un altro utente (l'utente di *destinazione* ).</span><span class="sxs-lookup"><span data-stu-id="b19a0-125">Sharing is defined by when a user (the *acting* user) wants to share a resource with another user (the *target* user).</span></span> <span data-ttu-id="b19a0-126">I record di controllo relativi alla condivisione di una risorsa con un utente esterno (un utente esterno all'organizzazione e non dispongono di un account Guest nell'Azure Active Directory dell'organizzazione) sono identificati dagli eventi seguenti, che vengono registrati in Office 365 Registro di controllo:</span><span class="sxs-lookup"><span data-stu-id="b19a0-126">Audit records related to sharing a resource with an external user (a user who is outside of your organization and doesn't have a guest account in your organization's Azure Active Directory) are identified by the following events, which are logged in the Office 365 audit log:</span></span>

- <span data-ttu-id="b19a0-127">**SharingInvitationCreated:** Un utente dell'organizzazione ha provato a condividere una risorsa (probabilmente un sito) con un utente esterno.</span><span class="sxs-lookup"><span data-stu-id="b19a0-127">**SharingInvitationCreated:** A user in your organization tried to share a resource (likely a site) with an external user.</span></span> <span data-ttu-id="b19a0-128">Questo comporta l'invio di un invito di condivisione esterna all'utente di destinazione.</span><span class="sxs-lookup"><span data-stu-id="b19a0-128">This results in an external sharing invitation sent to the target user.</span></span> <span data-ttu-id="b19a0-129">A questo punto non viene concesso l'accesso alla risorsa.</span><span class="sxs-lookup"><span data-stu-id="b19a0-129">No access to the resource is granted at this point.</span></span>

- <span data-ttu-id="b19a0-130">**SharingInvitationAccepted:** L'utente esterno ha accettato l'invito di condivisione inviato dall'utente che agisce e ora ha accesso alla risorsa.</span><span class="sxs-lookup"><span data-stu-id="b19a0-130">**SharingInvitationAccepted:** The external user has accepted the sharing invitation sent by the acting user and now has access to the resource.</span></span>

- <span data-ttu-id="b19a0-131">**AnonymousLinkCreated:** Per una risorsa viene creato un collegamento Anonimo (denominato anche collegamento "chiunque").</span><span class="sxs-lookup"><span data-stu-id="b19a0-131">**AnonymousLinkCreated:** An anonymous link (also called an "Anyone" link) is created for a resource.</span></span> <span data-ttu-id="b19a0-132">Poiché è possibile creare un collegamento anonimo e quindi copiarlo, è ragionevole presumere che tutti i documenti che dispongono di un collegamento anonimo siano stati condivisi con un utente di destinazione.</span><span class="sxs-lookup"><span data-stu-id="b19a0-132">Because an anonymous link can be created and then copied, it's reasonable to assume that any document that has an anonymous link has been shared with a target user.</span></span>

- <span data-ttu-id="b19a0-133">**AnonymousLinkUsed:** Come suggerisce il nome, questo evento viene registrato quando si utilizza un collegamento anonimo per accedere a una risorsa.</span><span class="sxs-lookup"><span data-stu-id="b19a0-133">**AnonymousLinkUsed:** As the name implies, this event is logged when an anonymous link is used to access a resource.</span></span> 

- <span data-ttu-id="b19a0-134">**SecureLinkCreated:** Un utente ha creato un "collegamento utenti specifici" per condividere una risorsa con una persona specifica.</span><span class="sxs-lookup"><span data-stu-id="b19a0-134">**SecureLinkCreated:** A user has created a "specific people link" to share a resource with a specific person.</span></span> <span data-ttu-id="b19a0-135">Questo utente di destinazione potrebbe essere una persona esterna all'organizzazione.</span><span class="sxs-lookup"><span data-stu-id="b19a0-135">This target user may be someone who is external to your organization.</span></span> <span data-ttu-id="b19a0-136">La persona a cui è condivisa la risorsa viene identificata nel record di controllo per l'evento **AddedToSecureLink** .</span><span class="sxs-lookup"><span data-stu-id="b19a0-136">The person that the resource is shared with is identified in the audit record for the **AddedToSecureLink** event.</span></span> <span data-ttu-id="b19a0-137">Gli indicatori di data e ora per questi due eventi sono quasi identici.</span><span class="sxs-lookup"><span data-stu-id="b19a0-137">The time stamps for these two events are nearly identical.</span></span>

- <span data-ttu-id="b19a0-138">**AddedToSecureLink:** Un utente è stato aggiunto a un collegamento di persone specifico.</span><span class="sxs-lookup"><span data-stu-id="b19a0-138">**AddedToSecureLink:** A user was added to a specific people link.</span></span> <span data-ttu-id="b19a0-139">Utilizzare il campo **TargetUserOrGroupName** in questo evento per identificare l'utente aggiunto al collegamento specifico corrispondente.</span><span class="sxs-lookup"><span data-stu-id="b19a0-139">Use the **TargetUserOrGroupName** field in this event to identify the user added to the corresponding specific people link.</span></span> <span data-ttu-id="b19a0-140">Questo utente di destinazione potrebbe essere una persona esterna all'organizzazione.</span><span class="sxs-lookup"><span data-stu-id="b19a0-140">This target user may be someone who is external to your organization.</span></span>

## <a name="sharing-auditing-work-flow"></a><span data-ttu-id="b19a0-141">Condivisione del flusso di lavoro di controllo</span><span class="sxs-lookup"><span data-stu-id="b19a0-141">Sharing auditing work flow</span></span>
  
<span data-ttu-id="b19a0-142">Quando un utente (l'utente che agisce) desidera condividere una risorsa con un altro utente (l'utente di destinazione), SharePoint (o OneDrive for business) prima verifica se l'indirizzo di posta elettronica dell'utente di destinazione è già associato a un account utente nella directory dell'organizzazione.</span><span class="sxs-lookup"><span data-stu-id="b19a0-142">When a user (the acting user) wants to share a resource with another user (the target user), SharePoint (or OneDrive for Business) first checks if the email address of the target user is already associated with a user account in the organization's directory.</span></span> <span data-ttu-id="b19a0-143">Se l'utente di destinazione si trova nella directory e dispone di un account utente Guest corrispondente, SharePoint esegue le operazioni seguenti:</span><span class="sxs-lookup"><span data-stu-id="b19a0-143">If the target user is in the directory (and has a corresponding guest user account), SharePoint does the following things:</span></span>
  
-  <span data-ttu-id="b19a0-144">Assegna immediatamente le autorizzazioni utente di destinazione per accedere alla risorsa aggiungendo l'utente di destinazione al gruppo di SharePoint appropriato e registra un evento **AddedToGroup** .</span><span class="sxs-lookup"><span data-stu-id="b19a0-144">Immediately assigns the target user permissions to access the resource by adding the target user to the appropriate SharePoint group, and logs an **AddedToGroup** event.</span></span> 
    
- <span data-ttu-id="b19a0-145">Invia una notifica di condivisione all'indirizzo di posta elettronica dell'utente di destinazione.</span><span class="sxs-lookup"><span data-stu-id="b19a0-145">Sends a sharing notification to the email address of the target user.</span></span>
    
- <span data-ttu-id="b19a0-146">Registra un evento **SharingSet** .</span><span class="sxs-lookup"><span data-stu-id="b19a0-146">Logs a **SharingSet** event.</span></span> <span data-ttu-id="b19a0-147">Questo evento ha un nome descrittivo di "file condiviso, cartella o sito" in **attività di condivisione e di richiesta di accesso** nella selezione attività dello strumento di ricerca del registro di controllo.</span><span class="sxs-lookup"><span data-stu-id="b19a0-147">This event has a friendly name of "Shared file, folder, or site" under **Sharing and access request activities** in the activities picker of the audit log search tool.</span></span> <span data-ttu-id="b19a0-148">Vedere la schermata nel [passaggio 1](#step-1-search-for-sharing-events-and-export-the-results-to-a-csv-file).</span><span class="sxs-lookup"><span data-stu-id="b19a0-148">See the screenshot in [Step 1](#step-1-search-for-sharing-events-and-export-the-results-to-a-csv-file).</span></span> 
    
<span data-ttu-id="b19a0-149">Se un account utente per l'utente di destinazione non è presente nella directory, SharePoint esegue le operazioni seguenti:</span><span class="sxs-lookup"><span data-stu-id="b19a0-149">If a user account for the target user isn't in the directory, SharePoint does the following:</span></span> 
    
   - <span data-ttu-id="b19a0-150">Registra uno degli eventi seguenti, in base al modo in cui la risorsa è condivisa:</span><span class="sxs-lookup"><span data-stu-id="b19a0-150">Logs one of the following events, based on how the resource is shared:</span></span>
   
      - <span data-ttu-id="b19a0-151">**AnonymousLinkCreated**</span><span class="sxs-lookup"><span data-stu-id="b19a0-151">**AnonymousLinkCreated**</span></span>
   
      - <span data-ttu-id="b19a0-152">**SecureLinkCreated**</span><span class="sxs-lookup"><span data-stu-id="b19a0-152">**SecureLinkCreated**</span></span>
   
      - <span data-ttu-id="b19a0-153">**AddedToSecureLink**</span><span class="sxs-lookup"><span data-stu-id="b19a0-153">**AddedToSecureLink**</span></span> 

      - <span data-ttu-id="b19a0-154">**SharingInvitationCreated** Questo evento viene registrato solo quando la risorsa condivisa è un sito.</span><span class="sxs-lookup"><span data-stu-id="b19a0-154">**SharingInvitationCreated** (this event is logged only when the shared resource is a site)</span></span>
    
   - <span data-ttu-id="b19a0-155">Quando l'utente di destinazione accetta l'invito di condivisione inviato a tali utenti (facendo clic sul collegamento nell'invito), SharePoint registra un evento **SharingInvitationAccepted** e assegna le autorizzazioni utente di destinazione per l'accesso alla risorsa.</span><span class="sxs-lookup"><span data-stu-id="b19a0-155">When the target user accepts the sharing invitation that's sent to them (by clicking the link in the invitation), SharePoint logs a **SharingInvitationAccepted** event and assigns the target user permissions to access the resource.</span></span> <span data-ttu-id="b19a0-156">Se all'utente di destinazione viene inviato un collegamento anonimo, l'evento **AnonymousLinkUsed** viene registrato dopo che l'utente di destinazione ha utilizzato il collegamento per accedere alla risorsa.</span><span class="sxs-lookup"><span data-stu-id="b19a0-156">If the target user is sent an anonymous link, the **AnonymousLinkUsed** event is logged after the target user uses the link to access the resource.</span></span> <span data-ttu-id="b19a0-157">Per i collegamenti sicuri, \*\*\*\* viene registrato un evento fileaccessed quando un utente esterno utilizza il collegamento per accedere alla risorsa.</span><span class="sxs-lookup"><span data-stu-id="b19a0-157">For secure links, a **FileAccessed** event is logged when an external user uses the link to access the resource.</span></span>

<span data-ttu-id="b19a0-158">Vengono inoltre registrate informazioni aggiuntive sull'utente di destinazione, ad esempio l'identità dell'utente a cui l'invito è associato e l'utente che accetta l'invito.</span><span class="sxs-lookup"><span data-stu-id="b19a0-158">Additional information about the target user is also logged, such as the identity of the user the invitation is to and the user who accepts the invitation.</span></span> <span data-ttu-id="b19a0-159">In alcuni casi, questi utenti (o indirizzi di posta elettronica) possono essere diversi.</span><span class="sxs-lookup"><span data-stu-id="b19a0-159">In some case, these users (or email addresses) can be different.</span></span> 

## <a name="how-to-identify-resources-shared-with-external-users"></a><span data-ttu-id="b19a0-160">Come identificare le risorse condivise con gli utenti esterni</span><span class="sxs-lookup"><span data-stu-id="b19a0-160">How to identify resources shared with external users</span></span>

<span data-ttu-id="b19a0-161">Un requisito comune per gli amministratori consiste nella creazione di un elenco di tutte le risorse condivise con utenti esterni all'organizzazione.</span><span class="sxs-lookup"><span data-stu-id="b19a0-161">A common requirement for administrators is creating a list of all resources that have been shared with users outside of the organization.</span></span> <span data-ttu-id="b19a0-162">Utilizzando la condivisione del controllo in Office 365, gli amministratori possono generare questo elenco.</span><span class="sxs-lookup"><span data-stu-id="b19a0-162">By using sharing auditing in Office 365, administrators can generate this list.</span></span> <span data-ttu-id="b19a0-163">Ecco come fare.</span><span class="sxs-lookup"><span data-stu-id="b19a0-163">Here's how.</span></span>
  
### <a name="step-1-search-for-sharing-events-and-export-the-results-to-a-csv-file"></a><span data-ttu-id="b19a0-164">Passaggio 1: cercare gli eventi di condivisione ed esportare i risultati in un file CSV</span><span class="sxs-lookup"><span data-stu-id="b19a0-164">Step 1: Search for sharing events and export the results to a CSV file</span></span>

<span data-ttu-id="b19a0-165">Il primo passaggio consiste nell'eseguire una ricerca nel registro di controllo di Office 365 per la condivisione degli eventi.</span><span class="sxs-lookup"><span data-stu-id="b19a0-165">The first step is to search the Office 365 audit log for sharing events.</span></span> <span data-ttu-id="b19a0-166">Per ulteriori informazioni (incluse le autorizzazioni necessarie) per la ricerca nel registro di controllo, vedere [Search the audit log in the Security & Compliance Center](search-the-audit-log-in-security-and-compliance.md).</span><span class="sxs-lookup"><span data-stu-id="b19a0-166">For more information (including the required permissions) about searching the audit log, see [Search the audit log in the Security & Compliance Center](search-the-audit-log-in-security-and-compliance.md).</span></span>
  
1. <span data-ttu-id="b19a0-167">Passare a [https://protection.office.com](https://protection.office.com).</span><span class="sxs-lookup"><span data-stu-id="b19a0-167">Go to [https://protection.office.com](https://protection.office.com).</span></span>
    
2. <span data-ttu-id="b19a0-168">Accedere a Office 365 usando l'account aziendale o dell'istituto di istruzione.</span><span class="sxs-lookup"><span data-stu-id="b19a0-168">Sign in to Office 365 using your work or school account.</span></span>
    
3. <span data-ttu-id="b19a0-169">Nel riquadro sinistro del Centro sicurezza & conformità fare clic su ricerca \*\*\*\*  > **log di controllo**di ricerca.</span><span class="sxs-lookup"><span data-stu-id="b19a0-169">In the left pane of the Security & Compliance Center, click **Search**  > **Audit log search**.</span></span>
    
    <span data-ttu-id="b19a0-170">Viene visualizzata la pagina di **ricerca del registro di controllo** .</span><span class="sxs-lookup"><span data-stu-id="b19a0-170">The **Audit log search** page is displayed.</span></span> 
    
4. <span data-ttu-id="b19a0-171">In **attività**fare clic su **condivisione e accesso alle attività richieste** per cercare gli eventi relativi alla condivisione.</span><span class="sxs-lookup"><span data-stu-id="b19a0-171">Under **Activities**, click **Sharing and access request activities** to search for sharing-related events.</span></span> 
    
    ![In attività selezionare condivisione e accesso alle attività richieste](media/46bb25b7-1eb2-4adf-903a-cc9ab58639f9.png)
  
5.  <span data-ttu-id="b19a0-173">Selezionare un intervallo di data e ora per individuare gli eventi di condivisione che si sono verificati entro quel periodo.</span><span class="sxs-lookup"><span data-stu-id="b19a0-173">Select a date and time range to find the sharing events that occurred within that period.</span></span> 
    
6. <span data-ttu-id="b19a0-174">Fare clic su **Cerca** per eseguire la ricerca.</span><span class="sxs-lookup"><span data-stu-id="b19a0-174">Click **Search** to run the search.</span></span> 
    
7. <span data-ttu-id="b19a0-175">Al termine dell'esecuzione della ricerca e i risultati vengono visualizzati, fare clic su **Esporta risultati** \> **scaricare tutti i risultati**.</span><span class="sxs-lookup"><span data-stu-id="b19a0-175">When the search is finished running and the results are displayed, click **Export results** \> **Download all results**.</span></span>
    
    <span data-ttu-id="b19a0-176">Dopo aver selezionato l'opzione di esportazione, nella parte inferiore della finestra viene visualizzato un messaggio in cui viene richiesto di aprire o salvare il file CSV.</span><span class="sxs-lookup"><span data-stu-id="b19a0-176">After you select the export option, a message at the bottom of the window prompts you to open or save the CSV file.</span></span>
    
8. <span data-ttu-id="b19a0-177">Fare clic su **Salva** \> con **nome** e salvare il file CSV in una cartella del computer locale.</span><span class="sxs-lookup"><span data-stu-id="b19a0-177">Click **Save** \> **Save as** and save the CSV file to a folder on your local computer.</span></span> 

### <a name="step-2-use-the-powerquery-editor-to-format-the-exported-audit-log"></a><span data-ttu-id="b19a0-178">Passaggio 2: utilizzare l'editor di PowerQuery per formattare il registro di controllo esportato</span><span class="sxs-lookup"><span data-stu-id="b19a0-178">Step 2: Use the PowerQuery Editor to format the exported audit log</span></span>

<span data-ttu-id="b19a0-179">Il passaggio successivo consiste nell'utilizzare la caratteristica di trasformazione JSON nell'editor di query di alimentazione in Excel per dividere ogni proprietà nella colonna **AuditData** (costituita da un oggetto JSON a più proprietà) nella relativa colonna.</span><span class="sxs-lookup"><span data-stu-id="b19a0-179">The next step is to use the JSON transform feature in the Power Query Editor in Excel to split each property in the **AuditData** column (which consists of a multi-property JSON object) into its own column.</span></span> <span data-ttu-id="b19a0-180">In questo modo è possibile filtrare le colonne per visualizzare i record relativi alla condivisione</span><span class="sxs-lookup"><span data-stu-id="b19a0-180">This lets you filter columns to view records related to sharing</span></span>

<span data-ttu-id="b19a0-181">Per istruzioni dettagliate, vedere "passaggio 2: formattare il log di controllo esportato utilizzando l'editor di query di alimentazione" in [esportare, configurare e visualizzare i record del registro di controllo](export-view-audit-log-records.md#step-2-format-the-exported-audit-log-using-the-power-query-editor).</span><span class="sxs-lookup"><span data-stu-id="b19a0-181">For step-by-step instructions, see "Step 2: Format the exported audit log using the Power Query Editor" in [Export, configure, and view audit log records](export-view-audit-log-records.md#step-2-format-the-exported-audit-log-using-the-power-query-editor).</span></span>

### <a name="step-3-filter-the-csv-file-for-resources-shared-with-external-users"></a><span data-ttu-id="b19a0-182">Passaggio 3: filtrare il file CSV per le risorse condivise con gli utenti esterni</span><span class="sxs-lookup"><span data-stu-id="b19a0-182">Step 3: Filter the CSV file for resources shared with external users</span></span>

<span data-ttu-id="b19a0-183">Il passaggio successivo consiste nel filtrare il CSV per i diversi eventi relativi alla condivisione descritti in precedenza nella sezione [eventi di condivisione di SharePoint](#sharepoint-sharing-events) .</span><span class="sxs-lookup"><span data-stu-id="b19a0-183">The next step is to filter the CSV for the different sharing-related events that were previously described in the [SharePoint sharing events](#sharepoint-sharing-events) section.</span></span> <span data-ttu-id="b19a0-184">In alternativa, è possibile filtrare la colonna **TargetUserOrGroupType** per visualizzare tutti i record in cui il valore di questa proprietà è **Guest**.</span><span class="sxs-lookup"><span data-stu-id="b19a0-184">Alternatively, you can filter the **TargetUserOrGroupType** column to display all records where the value of this property is **Guest**.</span></span> 

<span data-ttu-id="b19a0-185">Dopo aver seguito le istruzioni riportate nel passaggio precedente per preparare il file CSV utilizzando l'editor di PowerQuery, eseguire le operazioni seguenti:</span><span class="sxs-lookup"><span data-stu-id="b19a0-185">After you've followed the instructions in the previous step to prepare the CSV file by using the PowerQuery editor, do the following:</span></span>
    
1. <span data-ttu-id="b19a0-186">Aprire il file di Excel creato nel passaggio 2.</span><span class="sxs-lookup"><span data-stu-id="b19a0-186">Open the Excel file that you created in Step 2.</span></span> 

2. <span data-ttu-id="b19a0-187">Nella scheda **Home** fare clic su **Ordina & filtro**, quindi fare clic su **filtro**.</span><span class="sxs-lookup"><span data-stu-id="b19a0-187">On the **Home** tab, click **Sort & Filter**, and then click **Filter**.</span></span>
    
3. <span data-ttu-id="b19a0-188">Nell'elenco a discesa **ordina & filtro** nella colonna **operazioni** deselezionare tutte le selezioni, quindi selezionare uno o più degli eventi correlati alla condivisione seguenti e quindi fare clic su **OK**.</span><span class="sxs-lookup"><span data-stu-id="b19a0-188">In the **Sort & Filter** dropdown list on the **Operations** column, clear all selections, then select one or more the following sharing-related events and then click **Ok**.</span></span>
 
   - <span data-ttu-id="b19a0-189">**SharingInvitationCreated**</span><span class="sxs-lookup"><span data-stu-id="b19a0-189">**SharingInvitationCreated**</span></span>
   
   - <span data-ttu-id="b19a0-190">**AnonymousLinkCreated**</span><span class="sxs-lookup"><span data-stu-id="b19a0-190">**AnonymousLinkCreated**</span></span>
   
   - <span data-ttu-id="b19a0-191">**SecureLinkCreated**</span><span class="sxs-lookup"><span data-stu-id="b19a0-191">**SecureLinkCreated**</span></span>
   
   - <span data-ttu-id="b19a0-192">**AddedToSecureLink**</span><span class="sxs-lookup"><span data-stu-id="b19a0-192">**AddedToSecureLink**</span></span> 
    
    <span data-ttu-id="b19a0-193">Excel Visualizza le righe per gli eventi selezionati.</span><span class="sxs-lookup"><span data-stu-id="b19a0-193">Excel displays the rows for the events you selected.</span></span>
    
4. <span data-ttu-id="b19a0-194">Passare alla colonna denominata **TargetUserOrGroupType** e selezionarla.</span><span class="sxs-lookup"><span data-stu-id="b19a0-194">Go to the column named **TargetUserOrGroupType** and select it.</span></span> 
    
5. <span data-ttu-id="b19a0-195">Nell'elenco a discesa **ordina & filtro** , deselezionare tutte le selezioni, quindi selezionare **TargetUserOrGroupType: Guest**e fare clic su **OK**.</span><span class="sxs-lookup"><span data-stu-id="b19a0-195">In the **Sort & Filter** dropdown list, clear all selections, then select **TargetUserOrGroupType:Guest**, and click **Ok**.</span></span>
    
    <span data-ttu-id="b19a0-196">Ora Excel Visualizza le righe per gli eventi di condivisione e in cui l'utente di destinazione si trova all'esterno dell'organizzazione, perché gli utenti esterni sono identificati dal valore **TargetUserOrGroupType: Guest**.</span><span class="sxs-lookup"><span data-stu-id="b19a0-196">Now Excel displays the rows for sharing events AND where the target user is outside of your organization, because external users are identified by the value **TargetUserOrGroupType:Guest**.</span></span> 
  
> [!TIP]
> <span data-ttu-id="b19a0-197">Per i record di controllo visualizzati, la colonna **ObjectID** identifica la risorsa condivisa con l'utente di destinazione. ad esempio `ObjectId:https:\/\/contoso-my.sharepoint.com\/personal\/sarad_contoso_com\/Documents\/Southwater Proposal.docx`.</span><span class="sxs-lookup"><span data-stu-id="b19a0-197">For the audit records that are displayed, the **ObjectId** column identifies the resource that was shared with the target user; for example  `ObjectId:https:\/\/contoso-my.sharepoint.com\/personal\/sarad_contoso_com\/Documents\/Southwater Proposal.docx`.</span></span>
