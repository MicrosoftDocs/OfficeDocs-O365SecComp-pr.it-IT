---
title: Rilevare e correggere le regole di Outlook e gli attacchi per iniezioni di moduli personalizzati in Office 365
ms.author: chrfox
author: chrfox
manager: laurawi
ms.date: 04/23/2018
ms.audience: ITPro
ms.topic: article
ms.collection:
- o365_security_incident_response
- M365-security-compliance
ms.service: O365-seccomp
localization_priority: Normal
search.appverid:
- MET150
description: Informazioni su come riconoscere e correggere le regole di Outlook e gli attacchi per iniezioni di moduli personalizzati in Office 365
ms.openlocfilehash: 2189ff7abd640d9c87b97df35ec2b9cd44c74061
ms.sourcegitcommit: c7989a8ead235aaebb2503abbde598f2c26c0056
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 05/14/2019
ms.locfileid: "33979492"
---
# <a name="detect-and-remediate-outlook-rules-and-custom-forms-injections-attacks-in-office-365"></a><span data-ttu-id="8d21b-103">Rilevare e risolvere gli attacchi injection alle regole e ai moduli personalizzati di Outlook in Office 365</span><span class="sxs-lookup"><span data-stu-id="8d21b-103">Detect and Remediate Outlook Rules and Custom Forms Injections Attacks in Office 365</span></span>

<span data-ttu-id="8d21b-104">**Riepilogo** Informazioni su come riconoscere e correggere le regole di Outlook e gli attacchi per iniezioni di moduli personalizzati in Office 365.</span><span class="sxs-lookup"><span data-stu-id="8d21b-104">**Summary** Learn how to recognize and remediate the Outlook rules and custom Forms injections attacks in Office 365.</span></span>

## <a name="what-is-the-outlook-rules-and-custom-forms-injection-attack"></a><span data-ttu-id="8d21b-105">Che cos'è l'attacco delle regole di Outlook e dell'iniezione di moduli personalizzati?</span><span class="sxs-lookup"><span data-stu-id="8d21b-105">What is the Outlook Rules and Custom Forms injection attack?</span></span>
<span data-ttu-id="8d21b-106">Dopo che un utente malintenzionato ha violato un account nel tuo contratto di locazione ed è entrato, ci sarà una soluzione per cercare di stabilire un modo per rimanere o un modo per tornare indietro dopo che sono stati scoperti e rimossi.</span><span class="sxs-lookup"><span data-stu-id="8d21b-106">After an attacker has breached an account in your tenancy and gets in, they're are going to try and establish a way to stay in or a way to get back in after they are discovered and removed.</span></span> <span data-ttu-id="8d21b-107">Si tratta di una chiamata che istituisce un meccanismo di persistenza.</span><span class="sxs-lookup"><span data-stu-id="8d21b-107">This is called establishing a persistence mechanism.</span></span> <span data-ttu-id="8d21b-108">Due modi per eseguire questa operazione sono lo sfruttamento delle regole di Outlook o la possibilità di inserire moduli personalizzati in Outlook.</span><span class="sxs-lookup"><span data-stu-id="8d21b-108">Two ways that they can do this are by exploiting Outlook rules or by injecting custom forms into Outlook.</span></span>
<span data-ttu-id="8d21b-109">In entrambi i casi, la regola o la maschera viene sincronizzata dal servizio cloud verso il basso nel client desktop, quindi un formato completo e una nuova installazione del software client non eliminano il meccanismo di iniezione.</span><span class="sxs-lookup"><span data-stu-id="8d21b-109">In both cases, the rule or form is synced from the cloud service down to the desktop client, so a full format and re-install of the client software doesn't eliminate the injection mechanism.</span></span> <span data-ttu-id="8d21b-110">Ciò è dovuto al fatto che, quando il software client di Outlook si riconnette alla cassetta postale nel cloud, riscaricherà le regole e i moduli dal cloud.</span><span class="sxs-lookup"><span data-stu-id="8d21b-110">This is because when the Outlook client software reconnects to the mailbox in the cloud it will re-download the rules and forms from the cloud.</span></span> <span data-ttu-id="8d21b-111">Dopo che le regole e i moduli sono stati attivati, l'utente malintenzionato li utilizza per eseguire codice remoto o personalizzato, in genere per installare malware nel computer locale.</span><span class="sxs-lookup"><span data-stu-id="8d21b-111">Once the rules and forms are in place, the attacker uses them to execute remote or custom code, usually to install malware on the local machine.</span></span> <span data-ttu-id="8d21b-112">Il malware quindi ri-ruba le credenziali o esegue altre attività illecite.</span><span class="sxs-lookup"><span data-stu-id="8d21b-112">The malware then re-steals credentials or performs other illicit activity.</span></span> <span data-ttu-id="8d21b-113">La buona notizia è che se si mantiene i client con patch per la versione più recente, non si è vulnerabili alla minaccia come le impostazioni predefinite del client Outlook correnti bloccano entrambi i meccanismi.</span><span class="sxs-lookup"><span data-stu-id="8d21b-113">The good news here is that if you keep your clients patched to the latest version, you are not vulnerable to the threat as current Outlook client defaults block both mechanisms.</span></span> 

<span data-ttu-id="8d21b-114">Gli attacchi in genere seguono questi modelli:</span><span class="sxs-lookup"><span data-stu-id="8d21b-114">The attacks typically follow these patterns:</span></span>

<span data-ttu-id="8d21b-115">Utilizzo delle regole</span><span class="sxs-lookup"><span data-stu-id="8d21b-115">The Rules Exploit</span></span>
1. <span data-ttu-id="8d21b-116">Il nome utente e la password di uno dei tuoi utenti vengono rubati dall'utente malintenzionato.</span><span class="sxs-lookup"><span data-stu-id="8d21b-116">The attacker steals the username and password of one of your users.</span></span>
2. <span data-ttu-id="8d21b-117">L'utente malintenzionato accede quindi alla cassetta postale di Exchange per gli utenti.</span><span class="sxs-lookup"><span data-stu-id="8d21b-117">The attacker then signs in to that users Exchange mailbox.</span></span> <span data-ttu-id="8d21b-118">È possibile che la cassetta postale sia in Exchange Online o in Exchange locale.</span><span class="sxs-lookup"><span data-stu-id="8d21b-118">The mailbox can either be in Exchange online or in Exchange on-premises.</span></span>
3. <span data-ttu-id="8d21b-119">L'utente malintenzionato crea quindi una regola di inoltro nella cassetta postale che viene attivata quando la cassetta postale riceve un messaggio di posta elettronica che corrisponde ai criteri della regola.</span><span class="sxs-lookup"><span data-stu-id="8d21b-119">The attacker then creates a forwarding rule in the mailbox that is triggered when the mailbox receives an email that matches the criteria of the rule.</span></span> <span data-ttu-id="8d21b-120">I criteri della regola e il contenuto della posta elettronica dei trigger sono fatti su misura per l'altro.</span><span class="sxs-lookup"><span data-stu-id="8d21b-120">The criteria of rule and the contents of the trigger email are tailor-made for each other.</span></span>
4. <span data-ttu-id="8d21b-121">L'aggressore invia il messaggio di posta elettronica all'utente che usa la propria cassetta postale normalmente.</span><span class="sxs-lookup"><span data-stu-id="8d21b-121">The attacker sends the trigger email to the user who is using their mailbox normally.</span></span>
5. <span data-ttu-id="8d21b-122">Quando viene ricevuto il messaggio di posta elettronica, viene attivata la regola.</span><span class="sxs-lookup"><span data-stu-id="8d21b-122">When the email is received, the rule is triggered.</span></span> <span data-ttu-id="8d21b-123">L'azione della regola è in genere quella di avviare un'applicazione su un server remoto (WebDAV).</span><span class="sxs-lookup"><span data-stu-id="8d21b-123">The action of the rule is usually to launch an application on a remote (WebDAV) server.</span></span>
6. <span data-ttu-id="8d21b-124">L'applicazione in genere installa malware, ad esempio [PowerShell Empire](https://www.powershellempire.com/), localmente nel computer dell'utente.</span><span class="sxs-lookup"><span data-stu-id="8d21b-124">The application typically installs malware, such as [Powershell Empire](https://www.powershellempire.com/), locally on the user’s machine.</span></span>
7. <span data-ttu-id="8d21b-125">Il malware consente all'utente malintenzionato di riportare le credenziali dal computer locale e di eseguire altre attività dannose.</span><span class="sxs-lookup"><span data-stu-id="8d21b-125">The malware allows the attacker to re-steal the user’s username and password or other credentials from local machine and perform other malicious activities.</span></span>

<span data-ttu-id="8d21b-126">L'exploit dei moduli</span><span class="sxs-lookup"><span data-stu-id="8d21b-126">The Forms Exploit</span></span>
1. <span data-ttu-id="8d21b-127">Il nome utente e la password di uno dei tuoi utenti vengono rubati dall'utente malintenzionato.</span><span class="sxs-lookup"><span data-stu-id="8d21b-127">The attacker steals the username and password of one of your users.</span></span>
2. <span data-ttu-id="8d21b-128">L'utente malintenzionato accede quindi alla cassetta postale di Exchange per gli utenti.</span><span class="sxs-lookup"><span data-stu-id="8d21b-128">The attacker then sign in to that users Exchange mailbox.</span></span> <span data-ttu-id="8d21b-129">È possibile che la cassetta postale sia in Exchange Online o in Exchange locale.</span><span class="sxs-lookup"><span data-stu-id="8d21b-129">The mailbox can either be in Exchange online or in Exchange on-premises.</span></span>
3. <span data-ttu-id="8d21b-130">L'aggressore crea quindi un modello di modulo di posta elettronica personalizzato e lo inserisce nella cassetta postale dell'utente.</span><span class="sxs-lookup"><span data-stu-id="8d21b-130">The attacker then creates a custom mail form template and inserts it into the user’s mailbox.</span></span>  <span data-ttu-id="8d21b-131">Il modulo personalizzato viene attivato quando la cassetta postale riceve un messaggio di posta elettronica che richiede alla cassetta postale di caricare il modulo personalizzato.</span><span class="sxs-lookup"><span data-stu-id="8d21b-131">The custom form is triggered when the mailbox receives an email that requires the mailbox to load the custom form.</span></span> <span data-ttu-id="8d21b-132">Il modulo personalizzato e il formato del messaggio di posta elettronica sono fatti su misura per l'altro.</span><span class="sxs-lookup"><span data-stu-id="8d21b-132">The custom form and the format of email are tailor-made for each other.</span></span>
4. <span data-ttu-id="8d21b-133">L'utente malintenzionato invia il messaggio di posta elettronica al mittente, che utilizza normalmente la propria cassetta postale.</span><span class="sxs-lookup"><span data-stu-id="8d21b-133">The attacker sends the trigger email to the user, who is using their mailbox normally.</span></span>
5. <span data-ttu-id="8d21b-134">Quando viene ricevuto il messaggio di posta elettronica, il modulo viene caricato.</span><span class="sxs-lookup"><span data-stu-id="8d21b-134">When the email is received, the form is loaded.</span></span> <span data-ttu-id="8d21b-135">Il modulo avvia un'applicazione su un server remoto (WebDAV).</span><span class="sxs-lookup"><span data-stu-id="8d21b-135">The form launches an application on a remote (WebDAV) server.</span></span>
6. <span data-ttu-id="8d21b-136">L'applicazione in genere installa malware, ad esempio [PowerShell Empire](https://www.powershellempire.com/), localmente nel computer dell'utente.</span><span class="sxs-lookup"><span data-stu-id="8d21b-136">The application typically installs malware, such as [Powershell Empire](https://www.powershellempire.com/), locally on the user’s machine.</span></span>
7. <span data-ttu-id="8d21b-137">Il malware consente all'utente malintenzionato di riportare le credenziali dal computer locale e di eseguire altre attività dannose.</span><span class="sxs-lookup"><span data-stu-id="8d21b-137">The malware allows the attacker to re-steal the user’s username and password or other credentials from local machine and perform other malicious activities.</span></span>


## <a name="what-a-rules-and-custom-forms-injection-attack-might-look-like-office-365"></a><span data-ttu-id="8d21b-138">Che cosa può essere simile a Office 365?</span><span class="sxs-lookup"><span data-stu-id="8d21b-138">What a Rules and Custom Forms Injection attack might look like Office 365?</span></span>

<span data-ttu-id="8d21b-139">Questi meccanismi di persistenza sono improbabili da essere notati dagli utenti e, in alcuni casi, potrebbero anche essere invisibili.</span><span class="sxs-lookup"><span data-stu-id="8d21b-139">These persistence mechanisms are unlikely to be noticed by your users and may in some cases even be invisible to them.</span></span>  <span data-ttu-id="8d21b-140">In questo articolo viene descritto come cercare uno dei sette segni (indicatori di compromesso) elencati di seguito.</span><span class="sxs-lookup"><span data-stu-id="8d21b-140">This article tells you how to look for any of the seven signs (Indicators of Compromise) listed below.</span></span> <span data-ttu-id="8d21b-141">Se si trova uno di questi, è necessario eseguire i passaggi di correzione.</span><span class="sxs-lookup"><span data-stu-id="8d21b-141">If you find any of these, you need to take remediation steps.</span></span>

- <span data-ttu-id="8d21b-142">Indicatori del compromesso delle regole</span><span class="sxs-lookup"><span data-stu-id="8d21b-142">Indicators of the Rules compromise</span></span>
    - <span data-ttu-id="8d21b-143">L'azione regola consiste nell'avviare un'applicazione.</span><span class="sxs-lookup"><span data-stu-id="8d21b-143">Rule Action is to start an application.</span></span>
    - <span data-ttu-id="8d21b-144">La regola fa riferimento a un EXE, a un ZIP o a un URL.</span><span class="sxs-lookup"><span data-stu-id="8d21b-144">Rule References an EXE, ZIP, or URL.</span></span>
    - <span data-ttu-id="8d21b-145">Nel computer locale, cercare le nuove partenze del processo che provengono da Outlook PID.</span><span class="sxs-lookup"><span data-stu-id="8d21b-145">On the local machine, look for new process starts that originate from the Outlook PID.</span></span>
- <span data-ttu-id="8d21b-146">Indicatori del compromesso su moduli personalizzati</span><span class="sxs-lookup"><span data-stu-id="8d21b-146">Indicators of the Custom forms compromise</span></span> 
    - <span data-ttu-id="8d21b-147">Modulo personalizzato presente salvato come classe del messaggio.</span><span class="sxs-lookup"><span data-stu-id="8d21b-147">Custom form present saved as their own message class.</span></span>
    - <span data-ttu-id="8d21b-148">La classe Message contiene codice eseguibile.</span><span class="sxs-lookup"><span data-stu-id="8d21b-148">Message class contains executable code.</span></span>
    - <span data-ttu-id="8d21b-149">In genere archiviati nella raccolta moduli personali o nella cartella posta in arrivo.</span><span class="sxs-lookup"><span data-stu-id="8d21b-149">Usually stored in Personal Forms Library or Inbox folders.</span></span>
    - <span data-ttu-id="8d21b-150">Il modulo è denominato IPM. Nota. [nome personalizzato].</span><span class="sxs-lookup"><span data-stu-id="8d21b-150">Form is named IPM.Note.[custom name].</span></span>

## <a name="steps-for-finding-signs-of-this-attack-and-confirming-it"></a><span data-ttu-id="8d21b-151">Passaggi per individuare i segni di questo attacco e confermarlo</span><span class="sxs-lookup"><span data-stu-id="8d21b-151">Steps for finding signs of this attack and confirming it</span></span>
<span data-ttu-id="8d21b-152">È possibile utilizzare uno dei due metodi seguenti per confermare l'attacco.</span><span class="sxs-lookup"><span data-stu-id="8d21b-152">You can use either of these two methods to confirm the attack.</span></span>
- <span data-ttu-id="8d21b-153">Esaminare manualmente le regole e i moduli per ogni cassetta postale utilizzando il client di Outlook.</span><span class="sxs-lookup"><span data-stu-id="8d21b-153">Manually examine the rules and forms for each mailbox using the Outlook client.</span></span>  <span data-ttu-id="8d21b-154">Questo metodo è accurato, ma è possibile controllare solo l'utente della cassetta postale in un momento che può richiedere molto tempo se si dispone di molti utenti da controllare.</span><span class="sxs-lookup"><span data-stu-id="8d21b-154">This method is thorough, but you can only check mailbox user at a time which can be very time consuming if you have many users to check.</span></span>  <span data-ttu-id="8d21b-155">Può anche provocare una violazione del computer in cui si esegue il controllo.</span><span class="sxs-lookup"><span data-stu-id="8d21b-155">It can also result in a breach of the computer that you are running the check from.</span></span>
- <span data-ttu-id="8d21b-156">Utilizzare lo script PowerShell [Get-AllTenantRulesAndForms. ps1](https://github.com/OfficeDev/O365-InvestigationTooling/blob/master/Get-AllTenantRulesAndForms.ps1) per scaricare automaticamente tutte le regole di inoltro della posta e i moduli personalizzati per tutti gli utenti nel proprio contratto di locazione.</span><span class="sxs-lookup"><span data-stu-id="8d21b-156">Use the [Get-AllTenantRulesAndForms.ps1](https://github.com/OfficeDev/O365-InvestigationTooling/blob/master/Get-AllTenantRulesAndForms.ps1) PowerShell script to automatically dump all the mail forwarding rules and custom forms for all the users in your tenancy.</span></span> <span data-ttu-id="8d21b-157">Questo è il metodo più rapido e sicuro con il minor numero di overhead.</span><span class="sxs-lookup"><span data-stu-id="8d21b-157">This is the fastest and safest method with the least amount of overhead.</span></span>


### <a name="confirm-the-rules-attack-using-the-outlook-client"></a><span data-ttu-id="8d21b-158">Confermare l'attacco delle regole tramite il client di Outlook</span><span class="sxs-lookup"><span data-stu-id="8d21b-158">Confirm the Rules Attack Using the Outlook client</span></span>
1. <span data-ttu-id="8d21b-159">Aprire il client Outlook degli utenti come utente.</span><span class="sxs-lookup"><span data-stu-id="8d21b-159">Open the users Outlook client as the user.</span></span>  <span data-ttu-id="8d21b-160">È possibile che l'utente abbia bisogno di assistenza per esaminare le regole sulla propria cassetta postale.</span><span class="sxs-lookup"><span data-stu-id="8d21b-160">The user may need your help in examining the rules on their mailbox.</span></span>
2. <span data-ttu-id="8d21b-161">Fare riferimento a [gestire i messaggi di posta elettronica utilizzando le regole](https://support.office.com/article/manage-email-messages-by-using-rules-c24f5dea-9465-4df4-ad17-a50704d66c59#ID0EAABAAA=2010) dell'articolo per le procedure su come aprire l'interfaccia delle regole nelle versioni 2007, 2010 o 2013 di Outlook.</span><span class="sxs-lookup"><span data-stu-id="8d21b-161">Refer to [Manage email messages by using rules](https://support.office.com/article/manage-email-messages-by-using-rules-c24f5dea-9465-4df4-ad17-a50704d66c59#ID0EAABAAA=2010) article for the procedures on how to open the rules interface in either the 2007, 2010 or 2013 versions of Outlook.</span></span>
3. <span data-ttu-id="8d21b-162">Cercare le regole che l'utente non ha creato o qualsiasi regola imprevista o regole con nomi sospetti.</span><span class="sxs-lookup"><span data-stu-id="8d21b-162">Look for rules that the user did not create, or any unexpected rules or rules with suspicious names.</span></span>
4. <span data-ttu-id="8d21b-163">Esaminare la descrizione della regola per le azioni delle regole che iniziano e applicano o fanno riferimento a un oggetto. EXE,. File ZIP o per l'avvio di un URL.</span><span class="sxs-lookup"><span data-stu-id="8d21b-163">Look in the rule description for rule actions that start and application or refer to an .EXE, .ZIP file or to launching a URL.</span></span>
5. <span data-ttu-id="8d21b-164">Cercare eventuali nuovi processi che iniziano a utilizzare l'ID del processo di Outlook.</span><span class="sxs-lookup"><span data-stu-id="8d21b-164">Look for any new processes that start using the Outlook process ID.</span></span>  <span data-ttu-id="8d21b-165">Fare riferimento a [Find the process ID](https://docs.microsoft.com/windows-hardware/drivers/debugger/finding-the-process-id).</span><span class="sxs-lookup"><span data-stu-id="8d21b-165">Refer to [Find the Process ID](https://docs.microsoft.com/windows-hardware/drivers/debugger/finding-the-process-id).</span></span>

### <a name="steps-to-confirm-the-forms-attack-using-the-outlook-client"></a><span data-ttu-id="8d21b-166">Procedura per confermare l'attacco dei moduli tramite il client di Outlook</span><span class="sxs-lookup"><span data-stu-id="8d21b-166">Steps to confirm the Forms attack using the Outlook client</span></span>
1. <span data-ttu-id="8d21b-167">Aprire il client Outlook utente come utente.</span><span class="sxs-lookup"><span data-stu-id="8d21b-167">Open the user Outlook client as the user.</span></span>
2. <span data-ttu-id="8d21b-168">Attenersi alla procedura descritta in, [Mostra la scheda sviluppo](https://support.office.com/article/show-the-developer-tab-e1192344-5e56-4d45-931b-e5fd9bea2d45) per la versione degli utenti di Outlook.</span><span class="sxs-lookup"><span data-stu-id="8d21b-168">Follow the steps in, [Show the Developer tab](https://support.office.com/article/show-the-developer-tab-e1192344-5e56-4d45-931b-e5fd9bea2d45) for the users version of Outlook.</span></span>
3. <span data-ttu-id="8d21b-169">Aprire la scheda ora visibile per gli sviluppatori in Outlook e fare clic su **Progetta modulo**.</span><span class="sxs-lookup"><span data-stu-id="8d21b-169">Open the now visible developer tab in Outlook and click **design a form**.</span></span>
4. <span data-ttu-id="8d21b-170">Selezionare la **cartella posta in arrivo** dall'elenco **Cerca in** .</span><span class="sxs-lookup"><span data-stu-id="8d21b-170">Select the **Inbox** from the **Look In** list.</span></span> <span data-ttu-id="8d21b-171">Cercare eventuali moduli personalizzati.</span><span class="sxs-lookup"><span data-stu-id="8d21b-171">Look for any custom forms.</span></span>  <span data-ttu-id="8d21b-172">I moduli personalizzati sono abbastanza rari che, se si dispone di tutti i moduli personalizzati, è opportuno un aspetto più approfondito.</span><span class="sxs-lookup"><span data-stu-id="8d21b-172">Custom forms are rare enough that if you have any custom forms at all, it is worth a deeper look.</span></span>
5. <span data-ttu-id="8d21b-173">Esaminare i moduli personalizzati, in particolare quelli contrassegnati come nascosti.</span><span class="sxs-lookup"><span data-stu-id="8d21b-173">Investigate any custom forms, especially those marked as hidden.</span></span>
6. <span data-ttu-id="8d21b-174">Aprire tutti i moduli personalizzati e nel gruppo **modulo** fare clic su **Visualizza codice** per vedere cosa viene eseguito quando la maschera viene caricata.</span><span class="sxs-lookup"><span data-stu-id="8d21b-174">Open any custom forms and in the **Form** group click **View Code** to see what runs when the form is loaded.</span></span>

### <a name="steps-to-confirm-the-rules-and-forms-attack-using-powershell"></a><span data-ttu-id="8d21b-175">Passaggi per confermare le regole e i moduli di attacco tramite PowerShell</span><span class="sxs-lookup"><span data-stu-id="8d21b-175">Steps to confirm the Rules and Forms attack using PowerShell</span></span>
<span data-ttu-id="8d21b-176">Il modo più semplice per verificare una regola o un attacco di moduli personalizzati consiste nell'eseguire lo script di PowerShell [Get-AllTenantRulesAndForms. ps1](https://github.com/OfficeDev/O365-InvestigationTooling/blob/master/Get-AllTenantRulesAndForms.ps1) .</span><span class="sxs-lookup"><span data-stu-id="8d21b-176">The simplest way to verify a rules or custom forms attack is to run the [Get-AllTenantRulesAndForms.ps1](https://github.com/OfficeDev/O365-InvestigationTooling/blob/master/Get-AllTenantRulesAndForms.ps1) PowerShell script.</span></span>  <span data-ttu-id="8d21b-177">Questo script si connette a tutte le cassette postali del tenant e Scarica tutte le regole e i moduli in due file. csv.</span><span class="sxs-lookup"><span data-stu-id="8d21b-177">This script connects to every mailbox in your tenant and dumps all the rules and forms into two .csv files.</span></span>

#### <a name="pre-requisites"></a><span data-ttu-id="8d21b-178">Requisiti preliminari</span><span class="sxs-lookup"><span data-stu-id="8d21b-178">Pre-requisites</span></span>
<span data-ttu-id="8d21b-179">Sarà necessario disporre di diritti di amministratore globale per eseguire lo script perché lo script si connette a tutte le cassette postali del contratto di locazione per leggere le regole e i moduli.</span><span class="sxs-lookup"><span data-stu-id="8d21b-179">You will need to have a global administrator rights to run the script because the script connects to every mailbox in the tenancy to read the rules and forms.</span></span>

1. <span data-ttu-id="8d21b-180">Accedere al computer in cui verrà eseguito lo script con i diritti di amministratore locale.</span><span class="sxs-lookup"><span data-stu-id="8d21b-180">Sign in to the machine that you will run the script from with local administrator rights.</span></span>
2. <span data-ttu-id="8d21b-181">Scaricare o copiare lo script Get-AllTenantRulesAndForms. ps1 da GitHub in una cartella dalla quale verrà eseguito.</span><span class="sxs-lookup"><span data-stu-id="8d21b-181">Download or copy the Get-AllTenantRulesAndForms.ps1 script from GitHub to a folder from which you will run it.</span></span>  <span data-ttu-id="8d21b-182">Lo script creerà due file con timbro data in questa cartella, MailboxFormsExport-yyyy-mm-dd. csv e MailboxRulesExport-yyyy-mm-dd. csv.</span><span class="sxs-lookup"><span data-stu-id="8d21b-182">The script will create two date stamped files to this folder, MailboxFormsExport-yyyy-mm-dd.csv, and MailboxRulesExport-yyyy-mm-dd.csv.</span></span>
3. <span data-ttu-id="8d21b-183">Aprire un'istanza di PowerShell come amministratore e aprire la cartella in cui è stato salvato lo script.</span><span class="sxs-lookup"><span data-stu-id="8d21b-183">Open a PowerShell instance as an administrator and open the folder you saved the script to.</span></span>
4. <span data-ttu-id="8d21b-184">Eseguire la riga di comando di PowerShell `.\Get-AllTenantRulesAndForms.ps1`come segue .\Get-AllTenantRulesAndForms.ps1</span><span class="sxs-lookup"><span data-stu-id="8d21b-184">Run this PowerShell command line as follows `.\Get-AllTenantRulesAndForms.ps1`.\Get-AllTenantRulesAndForms.ps1</span></span>

#### <a name="interpreting-the-output"></a><span data-ttu-id="8d21b-185">Interpretare l'output</span><span class="sxs-lookup"><span data-stu-id="8d21b-185">Interpreting the output</span></span>

<span data-ttu-id="8d21b-186">MailboxRulesExport-*yyyy-mm-gg*. csv – esaminare le regole (una per riga) per le condizioni di azione che includono applicazioni o eseguibili.</span><span class="sxs-lookup"><span data-stu-id="8d21b-186">MailboxRulesExport-*yyyy-mm-dd*.csv – examine the rules (one per row) for action conditions that include applications or executables.</span></span>
- <span data-ttu-id="8d21b-187">ActionType (colonna A) – se viene visualizzato il valore "ID_ACTION_CUSTOM", è probabile che la regola sia dannosa.</span><span class="sxs-lookup"><span data-stu-id="8d21b-187">ActionType (column A) – if you see the value “ID_ACTION_CUSTOM”, the rule is likely malicious.</span></span>
- <span data-ttu-id="8d21b-188">IsPotentiallyMalicious (colonna D) – se questo valore è "TRUE", la regola è probabile che sia dannoso.</span><span class="sxs-lookup"><span data-stu-id="8d21b-188">IsPotentiallyMalicious (column D) – if this value is “TRUE”, the rule is likely malicious.</span></span>
- <span data-ttu-id="8d21b-189">ActionCommand (colonna G): se viene elencata un'applicazione o un file con estensione exe, zip o una voce che fa riferimento a un URL che non dovrebbe essere presente, la regola è probabilmente dannosa.</span><span class="sxs-lookup"><span data-stu-id="8d21b-189">ActionCommand (column G) – if this lists an application or any file with a .exe, .zip extension or an entry that refers to a URL, that is not supposed to be there, the rule is likely malicious.</span></span>

<span data-ttu-id="8d21b-190">MailboxFormsExport-*yyyy-mm-gg*. csv – in generale, l'utilizzo di moduli personalizzati è molto raro.</span><span class="sxs-lookup"><span data-stu-id="8d21b-190">MailboxFormsExport-*yyyy-mm-dd*.csv – in general, the use of custom forms is very rare.</span></span>  <span data-ttu-id="8d21b-191">Se si trova qualsiasi in questa cartella di lavoro, è possibile aprire la cassetta postale dell'utente ed esaminare il modulo stesso.</span><span class="sxs-lookup"><span data-stu-id="8d21b-191">If you find any in this workbook, you open that user’s mailbox and examine the form itself.</span></span>  <span data-ttu-id="8d21b-192">Se l'organizzazione non lo ha messo intenzionalmente, è probabile che sia dannoso.</span><span class="sxs-lookup"><span data-stu-id="8d21b-192">If your organization did not put it there intentionally, it is likely malicious.</span></span>



## <a name="how-to-stop-and-remediate-the-outlook-rules-and-forms-attack"></a><span data-ttu-id="8d21b-193">Come arrestare e correggere le regole di Outlook e l'attacco dei moduli</span><span class="sxs-lookup"><span data-stu-id="8d21b-193">How to stop and remediate the Outlook Rules and Forms attack</span></span>
<span data-ttu-id="8d21b-194">Se si riscontrano prove di uno di questi attacchi, la correzione è semplice, è sufficiente eliminare la regola o la maschera dalla cassetta postale.</span><span class="sxs-lookup"><span data-stu-id="8d21b-194">If you find any evidence of either of these attacks, remediation is simple, just delete the rule or form from the mailbox.</span></span> <span data-ttu-id="8d21b-195">È possibile eseguire questa operazione con il client di Outlook o tramite Remote PowerShell per rimuovere le regole.</span><span class="sxs-lookup"><span data-stu-id="8d21b-195">You can do this with the Outlook client or using remote PowerShell to remove rules.</span></span>

### <a name="using-outlook"></a><span data-ttu-id="8d21b-196">Utilizzo di Outlook</span><span class="sxs-lookup"><span data-stu-id="8d21b-196">Using Outlook</span></span>
1. <span data-ttu-id="8d21b-197">Identificare tutti i dispositivi che l'utente ha utilizzato con Outlook.</span><span class="sxs-lookup"><span data-stu-id="8d21b-197">Identify all the devices that the user has used with Outlook.</span></span>  <span data-ttu-id="8d21b-198">Tutti devono essere puliti da possibili malware.</span><span class="sxs-lookup"><span data-stu-id="8d21b-198">They will all need to be cleaned of potential malware.</span></span>  <span data-ttu-id="8d21b-199">Non consentire all'utente di accedere e utilizzare la posta elettronica fino a quando tutti i dispositivi vengono puliti.</span><span class="sxs-lookup"><span data-stu-id="8d21b-199">Do not allow the user to sign on and use email until all the devices are cleaned.</span></span>
2. <span data-ttu-id="8d21b-200">Seguire la procedura descritta in [eliminare una regola](https://support.office.com/article/Delete-a-rule-2F0E7139-F696-4422-8498-44846DB9067F) per ogni dispositivo.</span><span class="sxs-lookup"><span data-stu-id="8d21b-200">Follow the steps in [Delete a rule](https://support.office.com/article/Delete-a-rule-2F0E7139-F696-4422-8498-44846DB9067F) for each device.</span></span>
3. <span data-ttu-id="8d21b-201">Se non si è sicuri della presenza di altri malware, è possibile formattare e reinstallare tutto il software nel dispositivo.</span><span class="sxs-lookup"><span data-stu-id="8d21b-201">If you are unsure about the presence of other malware, you can format and re-install all the software on the device.</span></span>  <span data-ttu-id="8d21b-202">Per i dispositivi mobili è possibile seguire i passaggi dei costruttori per reimpostare il dispositivo nell'immagine Factory.</span><span class="sxs-lookup"><span data-stu-id="8d21b-202">For mobile devices you can follow the manufacturers steps to reset the device to the factory image.</span></span>
4. <span data-ttu-id="8d21b-203">Installare le versioni più aggiornate di Outlook.</span><span class="sxs-lookup"><span data-stu-id="8d21b-203">Install the most up-to-date versions of Outlook.</span></span>  <span data-ttu-id="8d21b-204">Tenere presente che la versione corrente di Outlook blocca entrambi i tipi di questo attacco per impostazione predefinita.</span><span class="sxs-lookup"><span data-stu-id="8d21b-204">Remember that the current version of Outlook blocks both types of this attack by default.</span></span>
5. <span data-ttu-id="8d21b-205">Dopo che tutte le copie offline della cassetta postale sono state rimosse, reimpostare la password dell'utente (utilizzare un valore di alta qualità) e seguire i passaggi descritti nell'installazione di autenticazione a più [fattori per gli utenti di Office 365 se l'](https://support.office.com/article/Set-up-multi-factor-authentication-for-Office-365-users-8f0454b2-f51a-4d9c-bcde-2c48e41621c6) AMF non è già stata abilitata.</span><span class="sxs-lookup"><span data-stu-id="8d21b-205">Once all offline copies of the mailbox have been removed, reset the user's password (use a high-quality one) and follow the steps in [Setup multi-factor authentication for Office 365 users](https://support.office.com/article/Set-up-multi-factor-authentication-for-Office-365-users-8f0454b2-f51a-4d9c-bcde-2c48e41621c6) if MFA has not already been enabled.</span></span> <span data-ttu-id="8d21b-206">In questo modo, le credenziali dell'utente non vengono esposte tramite altri strumenti (ad esempio, il riutilizzo di phishing o password).</span><span class="sxs-lookup"><span data-stu-id="8d21b-206">This ensures that the user's credentials are not exposed via other means (such as phishing or password re-use).</span></span>

### <a name="using-powershell"></a><span data-ttu-id="8d21b-207">Utilizzo di PowerShell</span><span class="sxs-lookup"><span data-stu-id="8d21b-207">Using PowerShell</span></span>
<span data-ttu-id="8d21b-208">Sono disponibili due cmdlet di PowerShell remoti che è possibile utilizzare per rimuovere o disabilitare le regole pericolose.</span><span class="sxs-lookup"><span data-stu-id="8d21b-208">There are two remote PowerShell cmdlets you can use to remove or disable dangerous rules.</span></span> <span data-ttu-id="8d21b-209">Basta seguire la procedura.</span><span class="sxs-lookup"><span data-stu-id="8d21b-209">Just follow the steps.</span></span>
 
<span data-ttu-id="8d21b-210">Passaggi per le cassette postali che si trovano in un server Exchange</span><span class="sxs-lookup"><span data-stu-id="8d21b-210">Steps for mailboxes that are on an Exchange server</span></span>

1. <span data-ttu-id="8d21b-211">Connettersi al server di Exchange tramite Remote PowerShell.</span><span class="sxs-lookup"><span data-stu-id="8d21b-211">Connect to the Exchange server using remote PowerShell.</span></span> <span data-ttu-id="8d21b-212">Seguire la procedura descritta in [Connect to Exchange servers using Remote PowerShell](https://docs.microsoft.com/powershell/exchange/exchange-server/connect-to-exchange-servers-using-remote-powershell?view=exchange-ps).</span><span class="sxs-lookup"><span data-stu-id="8d21b-212">Follow the steps in [Connect to Exchange servers using remote PowerShell](https://docs.microsoft.com/powershell/exchange/exchange-server/connect-to-exchange-servers-using-remote-powershell?view=exchange-ps).</span></span>
2. <span data-ttu-id="8d21b-213">Se si desidera rimuovere completamente una singola regola, più regole o tutte le regole di una cassetta postale, utilizzare il [cmdlet Remove-Inbox Rule ](https://docs.microsoft.com/powershell/module/exchange/mailboxes/Remove-InboxRule?view=exchange-ps)-utilizzarla per rimuovere completamente una, più o tutte le regole dalla cassetta postale.</span><span class="sxs-lookup"><span data-stu-id="8d21b-213">If you want to completely remove a single rule, multiple rules, or all rules from a mailbox use the [Remove-Inbox Rule cmdlet ](https://docs.microsoft.com/powershell/module/exchange/mailboxes/Remove-InboxRule?view=exchange-ps)- use this to completely remove one, multiple, or all rules from the mailbox.</span></span>
3. <span data-ttu-id="8d21b-214">Se si desidera mantenere la regola e il relativo contenuto per ulteriori indagini, utilizzare il [cmdlet Disable-InboxRule](https://technet.microsoft.com/en-us/library/dd298120(v=exchg.160).aspx).</span><span class="sxs-lookup"><span data-stu-id="8d21b-214">If you want to retain the rule and its contents for further investigation use the [Disable-InboxRule cmdlet](https://technet.microsoft.com/en-us/library/dd298120(v=exchg.160).aspx).</span></span> 

<span data-ttu-id="8d21b-215">Passaggi per le cassette postali in Exchange Online</span><span class="sxs-lookup"><span data-stu-id="8d21b-215">Steps for mailboxes in Exchange Online</span></span>
1. <span data-ttu-id="8d21b-216">Seguire la procedura descritta in [Connect to Exchange Online using PowerShell](https://docs.microsoft.com/powershell/exchange/exchange-online/connect-to-exchange-online-powershell/connect-to-exchange-online-powershell?view=exchange-ps).</span><span class="sxs-lookup"><span data-stu-id="8d21b-216">Follow the steps in [Connect to Exchange Online using PowerShell](https://docs.microsoft.com/powershell/exchange/exchange-online/connect-to-exchange-online-powershell/connect-to-exchange-online-powershell?view=exchange-ps).</span></span>
2.  <span data-ttu-id="8d21b-217">Se si desidera rimuovere completamente una singola regola, più regole o tutte le regole di una cassetta postale, utilizzare il [cmdlet Remove-Inbox Rule](https://docs.microsoft.com/powershell/module/exchange/mailboxes/Remove-InboxRule?view=exchange-ps).</span><span class="sxs-lookup"><span data-stu-id="8d21b-217">If you want to completely remove a single rule, multiple rules, or all rules from a mailbox use the [Remove-Inbox Rule cmdlet](https://docs.microsoft.com/powershell/module/exchange/mailboxes/Remove-InboxRule?view=exchange-ps).</span></span>
3.  <span data-ttu-id="8d21b-218">Se si desidera mantenere la regola e il relativo contenuto per ulteriori indagini, utilizzare il [cmdlet Disable-InboxRule](https://technet.microsoft.com/en-us/library/dd298120(v=exchg.160).aspx).</span><span class="sxs-lookup"><span data-stu-id="8d21b-218">If you want to retain the rule and its contents for further investigation use the [Disable-InboxRule cmdlet](https://technet.microsoft.com/en-us/library/dd298120(v=exchg.160).aspx).</span></span> 

## <a name="how-to-minimize-future-attacks"></a><span data-ttu-id="8d21b-219">Come ridurre al minimo gli attacchi futuri</span><span class="sxs-lookup"><span data-stu-id="8d21b-219">How to minimize future attacks</span></span>

### <a name="first-protect-your-accounts"></a><span data-ttu-id="8d21b-220">Primo: Proteggi gli account</span><span class="sxs-lookup"><span data-stu-id="8d21b-220">First: protect your accounts</span></span>

<span data-ttu-id="8d21b-221">Le regole e gli exploit dei moduli vengono utilizzati solo da un utente malintenzionato dopo che hanno rubato o violato uno degli account degli utenti.</span><span class="sxs-lookup"><span data-stu-id="8d21b-221">The Rules and Forms exploits are only used by an attacker after they have stolen or breached one of your user’s accounts.</span></span> <span data-ttu-id="8d21b-222">Pertanto, il primo passaggio per impedire l'utilizzo di tali exploit nei confronti dell'organizzazione consiste nel proteggere in modo aggressivo gli account utente.</span><span class="sxs-lookup"><span data-stu-id="8d21b-222">So, your first step to preventing the use of these exploits against your organization is to aggressively protect your user accounts.</span></span>  <span data-ttu-id="8d21b-223">Alcuni dei modi più comuni in cui gli account vengono violati sono gli attacchi di phishing o di spruzzatura delle [password](http://www.dabcc.com/microsoft-defending-against-password-spray-attacks/) .</span><span class="sxs-lookup"><span data-stu-id="8d21b-223">Some of the most common ways that accounts are breached are through phishing or [password spraying](http://www.dabcc.com/microsoft-defending-against-password-spray-attacks/) attacks.</span></span>



<span data-ttu-id="8d21b-224">Il modo migliore per proteggere gli account utente e in particolare gli account di amministratore consiste nel [configurare l'autenticazione a più fattori per gli utenti di Office 365](https://support.office.com/article/set-up-multi-factor-authentication-for-office-365-users-8f0454b2-f51a-4d9c-bcde-2c48e41621c6).</span><span class="sxs-lookup"><span data-stu-id="8d21b-224">The best way to protect your user accounts, and especially your administrator accounts, is to [set up multi-factor authentication for Office 365 users](https://support.office.com/article/set-up-multi-factor-authentication-for-office-365-users-8f0454b2-f51a-4d9c-bcde-2c48e41621c6).</span></span>  <span data-ttu-id="8d21b-225">È inoltre necessario:</span><span class="sxs-lookup"><span data-stu-id="8d21b-225">You should also:</span></span>
<ol>
    <li><span data-ttu-id="8d21b-226">Monitorare la modalità <a href="https://docs.microsoft.com/azure/active-directory/active-directory-view-access-usage-reports">di accesso e utilizzo</a>degli account utente.</span><span class="sxs-lookup"><span data-stu-id="8d21b-226">Monitor how your user accounts are <a href="https://docs.microsoft.com/azure/active-directory/active-directory-view-access-usage-reports">accessed and used</a>.</span></span> <span data-ttu-id="8d21b-227">Non è possibile impedire la violazione iniziale, ma è possibile ridurre la durata e l'impatto della violazione rilevando prima.</span><span class="sxs-lookup"><span data-stu-id="8d21b-227">You may not prevent the initial breach, but you will shorten the duration and the impact of the breach by detecting it sooner.</span></span> <span data-ttu-id="8d21b-228">È possibile utilizzare questi: <a href="https://docs.microsoft.com/cloud-app-security/what-is-cloud-app-security">criteri di protezione delle app cloud di Office 365</a> per monitorare gli account e allertare attività inusuali.</span><span class="sxs-lookup"><span data-stu-id="8d21b-228">You can use these: <a href="https://docs.microsoft.com/cloud-app-security/what-is-cloud-app-security"> Office 365 Cloud App Security policies</a> to monitor you accounts and alert on unusual activity.</span></span> 
        <ol type="a">
            <li><span data-ttu-id="8d21b-229"><b>Tentativi di accesso non riusciti multipli</b> Questo criterio profila l'ambiente e attiva gli avvisi quando gli utenti eseguono più attività di accesso non riuscite in una singola sessione rispetto alla linea di base acquisita, il che potrebbe indicare una tentativo di violazione.</span><span class="sxs-lookup"><span data-stu-id="8d21b-229"><b>Multiple failed login attempts</b> This policy profiles your environment and triggers alerts when users perform multiple failed login activities in a single session with respect to the learned baseline, which could indicate an attempted breach.</span></span></li>
            <li><span data-ttu-id="8d21b-230"><b>Viaggi impossibili</b> - Questo criterio profila l'ambiente e attiva gli avvisi quando vengono rilevate attività dallo stesso utente in posizioni diverse entro un periodo di tempo inferiore a quello previsto tra le due posizioni.</span><span class="sxs-lookup"><span data-stu-id="8d21b-230"><b>Impossible travel</b> - This policy profiles your environment and triggers alerts when activities are detected from the same user in different locations within a time period that is shorter than the expected travel time between the two locations.</span></span> <span data-ttu-id="8d21b-231">Questo potrebbe indicare che un utente diverso utilizza le stesse credenziali.</span><span class="sxs-lookup"><span data-stu-id="8d21b-231">This could indicate that a different user is using the same credentials.</span></span> <span data-ttu-id="8d21b-232">Il rilevamento di questo comportamento anomalo richiede un periodo di apprendimento iniziale di sette giorni durante il quale viene illustrato il modello di attività di un nuovo utente.</span><span class="sxs-lookup"><span data-stu-id="8d21b-232">Detecting this anomalous behavior necessitates an initial learning period of seven days during which it learns a new user’s activity pattern.</span></span></li>
            <li><span data-ttu-id="8d21b-233"><b>Attività rappresentata insolita (per utente)</b> - Questo criterio profila l'ambiente e attiva gli avvisi quando gli utenti eseguono più attività rappresentate in una singola sessione rispetto alla linea di base appresa, il che potrebbe indicare una tentativo di violazione.</span><span class="sxs-lookup"><span data-stu-id="8d21b-233"><b>Unusual impersonated activity (by user)</b> - This policy profiles your environment and triggers alerts when users perform multiple impersonated activities in a single session with respect to the baseline learned, which could indicate an attempted breach.</span></span></li>
        </ol>
    </li>
    <li><span data-ttu-id="8d21b-234">Sfruttare uno strumento come <a href="https://securescore.office.com/">Office 365 Secure Score</a> per gestire le configurazioni e i comportamenti di sicurezza degli account.</span><span class="sxs-lookup"><span data-stu-id="8d21b-234">Leverage a tool like the <a href="https://securescore.office.com/">Office 365 Secure Score</a> to manage account security configurations and behaviors.</span></span> 
    </li>
</ol> 

### <a name="second-keep-your-outlook-clients-current"></a><span data-ttu-id="8d21b-235">Secondo: mantenere aggiornati i client Outlook</span><span class="sxs-lookup"><span data-stu-id="8d21b-235">Second: Keep your Outlook clients current</span></span>
<span data-ttu-id="8d21b-236">Le versioni completamente aggiornate e con patch di Outlook 2013 e 2016 disabilitano per impostazione predefinita l'azione regola/maschera "Avvia applicazione".</span><span class="sxs-lookup"><span data-stu-id="8d21b-236">Fully-updated and patched versions of Outlook 2013, and 2016 disable the “Start Application” rule/form action by default.</span></span>  <span data-ttu-id="8d21b-237">In questo modo, anche se un utente malintenzionato viola l'account, la regola e le azioni del modulo verranno bloccate.</span><span class="sxs-lookup"><span data-stu-id="8d21b-237">This will ensure that, even if an attacker breaches the account, the rule and form actions will be blocked.</span></span>  <span data-ttu-id="8d21b-238">È possibile installare gli aggiornamenti più recenti e le patch di sicurezza attenendosi alla procedura descritta in [Install Office Updates](https://support.office.com/article/Install-Office-updates-2ab296f3-7f03-43a2-8e50-46de917611c5).</span><span class="sxs-lookup"><span data-stu-id="8d21b-238">You can install the latest updates and security patches by following the steps in [Install Office updates](https://support.office.com/article/Install-Office-updates-2ab296f3-7f03-43a2-8e50-46de917611c5).</span></span>

<span data-ttu-id="8d21b-239">Ecco le versioni delle patch per i client Outlook 2013 e 2016:</span><span class="sxs-lookup"><span data-stu-id="8d21b-239">Here are the patch versions for your Outlook 2013 and 2016 clients:</span></span>
- <span data-ttu-id="8d21b-240">Outlook 2013:15.0.4937.1000 o versione successiva</span><span class="sxs-lookup"><span data-stu-id="8d21b-240">Outlook 2013: 15.0.4937.1000 or greater</span></span>
- <span data-ttu-id="8d21b-241">Outlook 2016:16.0.4534.1001 o versione successiva</span><span class="sxs-lookup"><span data-stu-id="8d21b-241">Outlook 2016: 16.0.4534.1001 or greater</span></span>

<span data-ttu-id="8d21b-242">Per ulteriori informazioni sulle singole patch di sicurezza, vedere:</span><span class="sxs-lookup"><span data-stu-id="8d21b-242">For more information on the individual security patches, see:</span></span>

- [<span data-ttu-id="8d21b-243">Patch di sicurezza di Outlook 2013</span><span class="sxs-lookup"><span data-stu-id="8d21b-243">Outlook 2013 Security Patch</span></span>](https://support.microsoft.com/en-us/help/3191938) 
- [<span data-ttu-id="8d21b-244">Patch di sicurezza di Outlook 2016</span><span class="sxs-lookup"><span data-stu-id="8d21b-244">Outlook 2016 Security Patch</span></span>](https://support.microsoft.com/en-us/help/3191883)

### <a name="third-monitor-your-outlook-clients"></a><span data-ttu-id="8d21b-245">Terzo: monitorare i client Outlook</span><span class="sxs-lookup"><span data-stu-id="8d21b-245">Third: Monitor your Outlook clients</span></span>
<span data-ttu-id="8d21b-246">Si noti che, anche con le patch e gli aggiornamenti installati, è possibile che un utente malintenzionato modifichi la configurazione del computer locale per riattivare il comportamento di avvio dell'applicazione.</span><span class="sxs-lookup"><span data-stu-id="8d21b-246">Note that even with the patches and updates installed, it is possible for an attacker to change the local machine configuration to re-enable the “Start Application” behavior.</span></span> <span data-ttu-id="8d21b-247">È possibile utilizzare la [Gestione avanzata dei criteri di gruppo](https://docs.microsoft.com/microsoft-desktop-optimization-pack/agpm/) per monitorare e applicare i criteri del computer locale nei client.</span><span class="sxs-lookup"><span data-stu-id="8d21b-247">You can use [Advanced Group Policy Management](https://docs.microsoft.com/microsoft-desktop-optimization-pack/agpm/) to monitor and enforce local machine policies on your clients.</span></span>  
<span data-ttu-id="8d21b-248">È possibile verificare se l'impostazione "Avvia applicazione" è stata riattivata tramite una sostituzione nel registro di sistema utilizzando le informazioni [visualizzate in come visualizzare il registro System di Windows utilizzando le versioni a 64 bit](https://support.microsoft.com/en-us/help/305097/how-to-view-the-system-registry-by-using-64-bit-versions-of-windows).</span><span class="sxs-lookup"><span data-stu-id="8d21b-248">You can to see if “Start Application” has been re-enabled through an override in the registry by using the information in [How to view the system registry by using 64-bit versions of Windows](https://support.microsoft.com/en-us/help/305097/how-to-view-the-system-registry-by-using-64-bit-versions-of-windows).</span></span>  <span data-ttu-id="8d21b-249">Controllare queste sottochiavi:</span><span class="sxs-lookup"><span data-stu-id="8d21b-249">Check these subkeys:</span></span> 

- <span data-ttu-id="8d21b-250">Outlook 2016: HKEY_CURRENT_USER\Software\Microsoft\Office\16.0\Outlook\Security\\</span><span class="sxs-lookup"><span data-stu-id="8d21b-250">Outlook 2016: HKEY_CURRENT_USER\Software\Microsoft\Office\16.0\Outlook\Security\\</span></span>
- <span data-ttu-id="8d21b-251">Outlook 2013: HKEY_CURRENT_USER\Software\Microsoft\Office\15.0\Outlook\Security\\</span><span class="sxs-lookup"><span data-stu-id="8d21b-251">Outlook 2013: HKEY_CURRENT_USER\Software\Microsoft\Office\15.0\Outlook\Security\\</span></span>

<span data-ttu-id="8d21b-252">Cercare la chiave EnableUnsafeClientMailRules.</span><span class="sxs-lookup"><span data-stu-id="8d21b-252">Look for the key EnableUnsafeClientMailRules.</span></span> <span data-ttu-id="8d21b-253">Se è presente ed è impostato su 1, la patch di sicurezza di Outlook è stata ignorata e il computer è vulnerabile all'attacco maschera/regole.</span><span class="sxs-lookup"><span data-stu-id="8d21b-253">If it is there and is set to 1, the Outlook security patch has been overridden and the computer is vulnerable to the Form/Rules attack.</span></span> <span data-ttu-id="8d21b-254">Se il valore è 0, l'azione "Avvia applicazione" è disattivata.</span><span class="sxs-lookup"><span data-stu-id="8d21b-254">If the value is 0, the “Start Application” action is disabled.</span></span>  <span data-ttu-id="8d21b-255">Se è installata la versione aggiornata e con patch di Outlook e questa chiave del registro di sistema non è presente, non è vulnerabile a questi attacchi.</span><span class="sxs-lookup"><span data-stu-id="8d21b-255">If the updated and patched version of Outlook is installed and this registry key is not present, then a system is not vulnerable to these attacks.</span></span>

<span data-ttu-id="8d21b-256">I clienti con installazioni di Exchange locali dovrebbero considerare di bloccare le versioni precedenti di Outlook che non dispongono di patch disponibili.</span><span class="sxs-lookup"><span data-stu-id="8d21b-256">Customers with on-premises Exchange installations should consider blocking older versions of Outlook that do not have patches available.</span></span> <span data-ttu-id="8d21b-257">Informazioni dettagliate su questo processo sono disponibili nell'articolo [configure Outlook client blocking](https://technet.microsoft.com/en-us/library/dd335207(v=exchg.150).aspx).</span><span class="sxs-lookup"><span data-stu-id="8d21b-257">Details on this process can be found in the article [Configure Outlook client blocking](https://technet.microsoft.com/en-us/library/dd335207(v=exchg.150).aspx).</span></span>

## <a name="secure-office-365-like-a-cybersecurity-pro"></a><span data-ttu-id="8d21b-258">Proteggere Office 365 come un professionista della sicurezza informatica</span><span class="sxs-lookup"><span data-stu-id="8d21b-258">Secure Office 365 like a cybersecurity pro</span></span>
<span data-ttu-id="8d21b-259">L'abbonamento a Office 365 include un potente set di funzionalità di protezione che consente di proteggere i propri dati e quelli degli altri utenti.</span><span class="sxs-lookup"><span data-stu-id="8d21b-259">Your Office 365 subscription comes with a powerful set of security capabilities that you can use to protect your data and your users.</span></span>  <span data-ttu-id="8d21b-260">Usare il [Roadmap di protezione di Office 365: principali priorità per i primi 30 giorni, 90 giorni e oltre](https://support.office.com/article/Office-365-security-roadmap-Top-priorities-for-the-first-30-days-90-days-and-beyond-28c86a1c-e4dd-4aad-a2a6-c768a21cb352) per implementare le procedure consigliate da Microsoft per proteggere il tenant di Office 365.</span><span class="sxs-lookup"><span data-stu-id="8d21b-260">Use the [Office 365 security roadmap: Top priorities for the first 30 days, 90 days, and beyond](https://support.office.com/article/Office-365-security-roadmap-Top-priorities-for-the-first-30-days-90-days-and-beyond-28c86a1c-e4dd-4aad-a2a6-c768a21cb352) to implement Microsoft recommended best practices for securing your Office 365 tenant.</span></span>
- <span data-ttu-id="8d21b-261">Attività da eseguire i primi 30 giorni.</span><span class="sxs-lookup"><span data-stu-id="8d21b-261">Tasks to accomplish in the first 30 days.</span></span>  <span data-ttu-id="8d21b-262">Queste hanno effetto immediato e sono a basso impatto per gli utenti.</span><span class="sxs-lookup"><span data-stu-id="8d21b-262">These have immediate affect and are low-impact to your users.</span></span>
- <span data-ttu-id="8d21b-263">Attività da completare in 90 giorni.</span><span class="sxs-lookup"><span data-stu-id="8d21b-263">Tasks to accomplish in 90 days.</span></span> <span data-ttu-id="8d21b-264">Queste attività richiedono una quantità di tempo leggermente superiore per la pianificazione e l'implementazione, ma aumentano notevolmente il livello di sicurezza.</span><span class="sxs-lookup"><span data-stu-id="8d21b-264">These take a bit more time to plan and implement but greatly improve your security posture.</span></span>
- <span data-ttu-id="8d21b-265">Dopo 90 giorni.</span><span class="sxs-lookup"><span data-stu-id="8d21b-265">Beyond 90 days.</span></span> <span data-ttu-id="8d21b-266">Questi miglioramenti si instaurano nei primi 90 giorni di lavoro effettuato.</span><span class="sxs-lookup"><span data-stu-id="8d21b-266">These enhancements build in your first 90 days work.</span></span>

## <a name="see-also"></a><span data-ttu-id="8d21b-267">Vedere anche:</span><span class="sxs-lookup"><span data-stu-id="8d21b-267">See also:</span></span>
- <span data-ttu-id="8d21b-268">Le [regole di Outlook dannose](https://silentbreaksecurity.com/malicious-outlook-rules/) da SilentBreak post sulla sicurezza su Rules Vector fornisce una panoramica dettagliata del modo in cui le regole di Outlook.</span><span class="sxs-lookup"><span data-stu-id="8d21b-268">[Malicious Outlook Rules](https://silentbreaksecurity.com/malicious-outlook-rules/) by SilentBreak Security Post about Rules Vector provides a detailed review of how the Outlook Rules.</span></span> 
- <span data-ttu-id="8d21b-269">[MAPI su http e Mailrule Pwnage](https://sensepost.com/blog/2016/mapi-over-http-and-mailrule-pwnage/) sul Blog Sensepost su Mailrule Pwnage discute uno strumento chiamato righello che consente di sfruttare le cassette postali tramite le regole di Outlook.</span><span class="sxs-lookup"><span data-stu-id="8d21b-269">[MAPI over HTTP and Mailrule Pwnage ](https://sensepost.com/blog/2016/mapi-over-http-and-mailrule-pwnage/) on the Sensepost blog about Mailrule Pwnage discusses a tool called Ruler that lets you exploit mailboxes through Outlook rules.</span></span>
- <span data-ttu-id="8d21b-270">[Moduli di Outlook e Shell](https://sensepost.com/blog/2017/outlook-forms-and-shells/) sul Blog di Sensepost sul vettore di minacce di moduli.</span><span class="sxs-lookup"><span data-stu-id="8d21b-270">[Outlook forms and shells](https://sensepost.com/blog/2017/outlook-forms-and-shells/) on the Sensepost blog about Forms Threat Vector.</span></span> 
- [<span data-ttu-id="8d21b-271">Codebase del righello</span><span class="sxs-lookup"><span data-stu-id="8d21b-271">Ruler Codebase</span></span>](https://github.com/sensepost/ruler)
- [<span data-ttu-id="8d21b-272">Indicatori del righello di compromesso</span><span class="sxs-lookup"><span data-stu-id="8d21b-272">Ruler Indicators of Compromise</span></span>](https://github.com/sensepost/notruler/blob/master/iocs.md)